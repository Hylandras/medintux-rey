<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:Arial">
<p>$start_titleAfficher la copie du fichier PDF sur mon ordinateur à l'aide d'un logiciel externe$end_title
{{REM= firstly we find what PDF reader we will use}}
{{:: INCLUDE( $Glossaire/INCLUDE/attachments/display_pdf.{{OS}}.html )}}

{{REM= getting the filename}}
{{:: {{VAR= validAction}} SET_VAR(attachmentQuery,)}}
{{:: {{VAR= validAction}} SQL_SELECT(Attachments , count&#40;File_Name&#41;|File_Name ,WHERE Doc_PK='{{:: SQL_GET_RUB_HEAD_PK()}}',1,::,)&gt;attachmentQuery}}
{{:: {{VAR= validAction}} TEST(S,{{VAR=attachmentQuery}},!=,,,FLAG_FALSE)&gt;validAction}}
{{:: {{VAR= popupText}}(S,{{VAR=validAction}},=,FLAG_FALSE,ERREUR !!! Il n'y a pas de document référencé,)&gt;popupText}}
{{:: {{VAR= validAction}} VAR_SPLIT(attachmentQueryPar_,{{VAR= attachmentQuery}},::)}}
{{:: {{VAR= validAction}} TEST(N,{{VAR= attachmentQueryPar_0}},=,1,FALSE,)&gt;dontDoListe}}
{{:: {{VAR= dontDoListe}} SQL_SELECT(Attachments , Doc_Name|File_Name ,WHERE Doc_PK='{{:: SQL_GET_RUB_HEAD_PK()}}',200,::,|)&gt;attachmentQuery}}
{{:: {{VAR= dontDoListe}} DO_LISTE({{VAR= attachmentQuery}},Liste des documents associés,|,listResult,1,S)&gt;attachmentChosen}}
{{:: {{VAR= dontDoListe}} TEST(S,{{VAR= listResult}},=,Accepted,,FLAG_FALSE)&gt;validAction}}
{{:: {{VAR= dontDoListe}} {{VAR= popupText}}(S,{{VAR= validAction}},=,FLAG_FALSE,ERREUR !!! Aucun document choisi,)&gt;popupText}}
{{:: {{VAR= dontDoListe}} {{VAR= validAction}} VAR_SPLIT(attachmentQueryPar_,{{VAR=attachmentChosen}},::)}}

{{REM= we display the file}}
{{:: {{VAR= validAction}} EXE_PROCESS(noWaitEnd,{{VAR=pdfReader}},$ToAbsPath{{VAR=PatientFiles}}/{{VAR=attachmentQueryPar_1}})}}

{{REM= If validAction was filled we display a message to help troubleshooting}}
{{:: TEST(S,{{VAR=validAction}},=,FLAG_FALSE,MESSAGE_POPUP,)&gt;doPopup}}
{{:: {{VAR=doPopup}}({{VAR=popupText}},,{{VAR=popupFading}})}}
</p>
</body></html>
