<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:Arial">
<p>$start_title<span style="color:#aa0000">N'oubliez pas de valider l'envoi du mail à Evernote !</span><br /><br />Prenez garde à ne pas créer de doublon !$end_title
{{REM= To ensure that Memos and Reminders work you need to have a dummy user with "remind" as Login}}
{{REM= this macro is designed primarily for Evernote but can be easily modified for any reminder system with an "add by mail" option}}
{{REM= We send a query to grab the email of the reminder system we use. Obviously we need to add this email as remind user email...}}
{{:: SQL_SELECT ( Personnes , EMail , WHERE Login='remind',20,%, ,%0)>reminderAppEmail}}
{{REM= we extract title and dates to perform test to prevent execution if not filled}}
{{:: Extract(Documents,Sujet,EOL)&gt;titreMemo}}
{{:: Extract(Documents,Date butoir,EOL)&gt;memoDueDate}}
{{:: Extract(Documents,Date de rappel,EOL)&gt;memoReminder}}
{{REM= we test with validAction prefix method if extracts returned two values}}
{{:: SET_VAR(validAction, )}}
{{:: TEST(S,{{VAR=titreMemo}},=,&nbsp;,FLAG_FALSE,)&gt;validAction}}
{{:: {{VAR=validAction}}TEST(S,{{VAR=memoDueDate}},=,&nbsp;,FLAG_FALSE,)&gt;validAction}}
{{:: {{VAR=validAction}}TEST(S,{{VAR=memoReminder}},=,&nbsp;,FLAG_FALSE,)&gt;validAction}}
{{:: TEST(S,{{VAR=validAction}},=,FLAG_FALSE,MESSAGE_POPUP,)&gt;doPopup}}
{{:: {{VAR=doPopup}}(ERREUR !!! Vérifiez votre sujet ainsi que vos dates butoir et de rappel avant de lancer cette macro,,{{VAR=popupFading}})}}
{{REM= Don't forget to adapt the subject to your reminder system requirements}}
{{REM= We HHHMM to grab the current time when we use the macro so the reminders won't be all displayed at the same time and will be easier to check}}
{{:: SQL_WRITE (agenda, ,Date_Time,{{VAR=memoReminder}} {{HHHMM}}:00,Duree,15,Nom,{{NOM PATIENT}},Prenom,{{PRENOM PATIENT}},Tel,{{NUM. TEL1 PATIENT}},RDV_PrisPar,{{USER LOGIN MEDECIN}},RDV_PrisAvec,remind,Note,{{:: CS({{VAR=titreMemo}})}},Type,Rappel,GUID,{{GET_DOSS_GUID}},status,Absent,Adresse,{{ADRESSE PATIENT}},PrimKey,) }}
{{::# {{VAR=validAction}}Extract(Documents,==============================,$ToEnd,Enregistrer les rappels pour ce mémo,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#00ff00"><b>Rappel créé dans le calendrier de la secrétaire automatisée</b></span>)}}
{{:: {{VAR=validAction}}exe_process (NoWaitEnd ,../../APropos/bin/APropos,MailOnly,{{VAR=reminderAppEmail}}?subject={{:: CS({{VAR=titreMemo}})}} !{{:: RB({{:: CS({{VAR=memoDueDate}})}} ,-,/)}} @RAPPELS#{{NOM PATIENT}} {{PRENOM PATIENT}}&amp;body={{:: Extract(Documents,Sujet,==============================)}})}}
{{::# {{VAR=validAction}}Extract(Documents,==============================,$ToEnd,Enregistrer les rappels pour ce mémo,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#00ff00"><b>Rappel créé dans Evernote</b></span>)}}
</p>
</body></html>
