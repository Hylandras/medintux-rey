<html><head><meta name="qrichtext" content="1" /></head><body style="font-size:10pt;font-family:Sans Serif">
<p align="center"><img src=MedinTuxLogoHttp-300-200.png ><br /><br /><span style="font-size:12pt;font-weight:600">Logiciel Open Source libre de gestion du dossier médical <br /></span><a href="DrTuxVueGenerale.html">Vue générale de DrTux</a></p>
<p><span style="text-decoration:underline">Auteur et administrateur principal du projet</span> : </p>
<ul type="disc"><li><span style="font-weight:600">Roland SEVIN </span><a href="mailto:roland-sevin@medintux.org">roland-sevin@medintux.org</a> </li></ul>
<p><span style="text-decoration:underline">Contributeurs actuels</span> : </p>
<ul type="disc"><li><span style="font-weight:600">Gérard Delafond</span> <a href="mailto:gerard@delafond.org">gerard@delafond.org</a> </li>
<li><span style="font-weight:600">Christian ZABALETA</span> <a href="mailto:christian.zabaleta@orange.fr">christian.zabaleta@orange.fr</a> </li>
<li><span style="font-weight:600">Marc Vigreux</span> <a href="mailto:marc.vigreux@aixact.com">marc.vigreux@aixact.com</a> </li>
<li><span style="font-weight:600">Sébastien SIVERA </span><a href="mailto:sebastien@clinique-marignane.com">sebastien@clinique-marignane.com</a> </li>
<li><span style="font-weight:600">Damien HENRY </span><a href="mailto:dhenry@albatros-info.fr">dhenry@albatros-info.fr</a></li></ul>
<p> <hr><a name="Sommaire du DrTux"></a><span style="font-size:14pt;font-weight:600;text-decoration:underline">Sommaire du DrTux</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div><span style="font-size:9pt">1 </span><a href="DrTux.html#1 Apports de DrTux au sein d'un service d'urgences"><span style="font-size:9pt">Apports de DrTux au sein d'un service d'urgences</span></a></div>
<div><span style="font-size:9pt">2 </span><a href="DrTux.html#2 DESCRIPTION DES RUBRIQUES PRINCIPALES"><span style="font-size:9pt">DESCRIPTION DES RUBRIQUES PRINCIPALES</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">2.1 </span><a href="DrTux.html#2.1  Module de saisie de l'identité du patient"><span style="font-size:9pt">Module de saisie de l'identité du patient</span></a><span style="font-size:9pt"><br />2.2 </span><a href="DrTux.html#2.2  Module de recherche patients"><span style="font-size:9pt">Module de recherche patients</span></a><span style="font-size:9pt"><br />2.3 </span><a href="DrTux.html#2.3 Module de saisie des dossiers"><span style="font-size:9pt">Module de saisie des dossiers</span></a><span style="font-size:9pt"><br />2.4 </span><a href="DrTux.html#2.4 Module des prescriptions"><span style="font-size:9pt">Module des prescriptions</span></a><span style="font-size:9pt"><br />2.5 </span><a href="DrTux.html#2.5 Module du terrain"><span style="font-size:9pt">Module du terrain</span></a><span style="font-size:9pt"><br />2.6 </span><a href="DrTux.html#2.6 Module du Glossaire"><span style="font-size:9pt">Module du Glossaire</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">2.6.1 </span><a href="DrTux.html#2.6.1   Changer l'emplacement du répertoire du Glossaire"><span style="font-size:9pt">Changer l'emplacement du répertoire du Glossaire</span></a><span style="font-size:9pt"><br />2.6.2 </span><a href="DrTux.html#2.6.2   Répertoires importants du Glossaire"><span style="font-size:9pt">Répertoires importants du Glossaire</span></a><span style="font-size:9pt"><br />2.6.3 </span><a href="DrTux.html#2.6.3   Sélectionner et importer un document du Glossaire"><span style="font-size:9pt">Sélectionner et importer un document du Glossaire</span></a><span style="font-size:9pt"><br />2.6.4 </span><a href="DrTux.html#2.6.4    Le menu contextuel du Glossaire"><span style="font-size:9pt">Le menu contextuel du Glossaire</span></a></div></ul>
<div><span style="font-size:9pt">2.7 </span><a href="DrTux.html#2.7_Principe_des_modèles_et_maquettes_de_document"><span style="font-size:9pt">Principe des modèles et maquettes de documents</span></a></div></ul>
<div><span style="font-size:9pt">3 </span><a href="DrTux.html#3   DESCRIPTION DES ASSISTANTS"><span style="font-size:9pt">DESCRIPTION DES ASSISTANTS</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">3.1 </span><a href="AssistPrescription.html"><span style="font-size:9pt">ASSISTANT D'AIDE À LA PRESCRIPTION</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">3.1.1 </span><a href="AssistPrescription.html#3.1.1 GENERALITES"><span style="font-size:9pt">GÉNÉRALITÉS</span></a><span style="font-size:9pt"><br />3.1.2 </span><a href="AssistPrescription.html#3.1.2  RECHERCHE D'UN PRODUIT"><span style="font-size:9pt">RECHERCHE D'UN PRODUIT</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">3.1.2.1 </span><a href="AssistPrescription.html#3.1.2.1   Recherche d'un produit par son nom commercial"><span style="font-size:9pt">Recherche d'un produit par son nom commercial</span></a><span style="font-size:9pt"><br />3.1.2.2 </span><a href="AssistPrescription.html#3.1.2.2   Recherche d'un produit par sa substance"><span style="font-size:9pt">Recherche d'un produit par sa substance</span></a><span style="font-size:9pt"><br />3.1.2.3 </span><a href="AssistPrescription.html#3.1.2.3   Recherche d'un produit par une indication"><span style="font-size:9pt">Recherche d'un produit par une indication</span></a></div></ul>
<div><span style="font-size:9pt">3.1.3 </span><a href="AssistPrescription.html#3.1.3  PRESCRIPTIONS et INFORMATIONS d'un PRODUIT"><span style="font-size:9pt">PRESCRIPTIONS et INFORMATIONS d'un PRODUIT</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">3.1.3.1 </span><a href="AssistPrescription.html#3.1.3.1    Monographie du produit"><span style="font-size:9pt">Monographie du produit</span></a></div>
<div><span style="font-size:9pt">3.1.3.2 </span><a href="AssistPrescription.html#3.1.3.2    Posologies et sélection d'un produit pour l'ordonnance"><span style="font-size:9pt">Posologies et sélection d'un produit pour l'ordonnance</span></a><span style="font-size:9pt"><br />3.1.3.3 </span><a href="AssistPrescription.html#3.1.3.3    Etablissement d'une ordonnance et prescription structurée"><span style="font-size:9pt">Etablissement d'une ordonnance et prescription structurée</span></a></div>
<ul type="disc"><ul type="disc"><div><span style="font-size:9pt">3.1.3.3.1 </span><a href="AssistPrescription.html#3.1.3.3.1    L'ordonnance"><span style="font-size:9pt">L'ordonnance</span></a><span style="font-size:9pt"><br />3.1.3.3.2 </span><a href="AssistPrescription.html#3.1.3.3.2    Ajustement de la posologie structurée"><span style="font-size:9pt">Ajustement de la posologie</span></a></div></ul></ul></ul></ul></ul></ul>
<p><span style="font-size:9pt">3.1.4 </span><a href="AssistPrescription.html#3.1.4   Modifier les posologies d'un produit"><span style="font-size:9pt">MODIFIER LES POSOLOGIES D'UN PRODUIT</span></a></p>
<p><span style="font-size:9pt">3.2 </span><a href="DrTux.html#3.2 ASSISTANT DE CODAGE CIM 10"><span style="font-size:9pt">ASSISTANT DE CODAGE CIM 10</span></a></p>
<ul type="disc"><div><span style="font-size:9pt">3.2.1 </span><a href="DrTux.html#3.2.1   Sélectionner un code Cim10 à l'aide de la liste Simplifiée Urgences"><span style="font-size:9pt">Sélectionner un code Cim10 à l'aide de la liste Simplifiée Urgences</span></a><span style="font-size:9pt"><br />3.2.2 </span><a href="DrTux.html#3.2.2  Sélectionner un code Cim10 à l'aide de la liste Hiérarchisée"><span style="font-size:9pt">Sélectionner un code Cim10 à l'aide de la liste Hiérarchisée</span></a><span style="font-size:9pt"><br />3.2.3 </span><a href="DrTux.html#3.2.3  Sélectionner un code Cim10 à l'aide de la liste Globale"><span style="font-size:9pt">Sélectionner un code Cim10 à l'aide de la liste Globale</span></a><span style="font-size:9pt"><br />3.2.4 </span><a href="DrTux.html#3.2.4  Sélectionner un code Cim10 à l'aide de la liste HTML"><span style="font-size:9pt">Sélectionner un code Cim10 à l'aide de la liste HTML</span></a></div></ul>
<p><span style="font-size:9pt">3.3 </span><a href="ccamview/index.html"><span style="font-size:9pt">ASSISTANT DE CODAGE CCAM</span></a></p>
<ul type="disc"><div><span style="font-size:9pt">3.3.1 </span><a href="ccamview/index.html#3.3.1_ccamview_,_outil_de_recherche_des_codes_CCAM"><span style="font-size:9pt">ccamview : outil de recherche des codes CCAM</span></a><span style="font-size:9pt"><br />3.3.1.1 </span><a href="ccamview/index.html#3.3.1.1_Démarrer_CCAMView"><span style="font-size:9pt">Démarrer CCAMView</span></a><span style="font-size:9pt">    <br />3.3.1.1.1 </span><a href="ccamview/index.html#3.3.1.1.1__Définition_des_modes_de_démarrage"><span style="font-size:9pt">Définition des modes de démarrage</span></a><span style="font-size:9pt"><br />3.3.1.1.2 </span><a href="ccamview/index.html#3.3.1.1.2_On_distingue_deux_types_d'utilisateurs"><span style="font-size:9pt">On distingue deux types d'utilisateurs</span></a><span style="font-size:9pt"><br />3.3.1.1.3 </span><a href="ccamview/index.html#3.3.1.1.3_Création_et_gestion_des_identités"><span style="font-size:9pt">Création et gestion des identités</span></a><span style="font-size:9pt"><br />3.3.1.2 </span><a href="ccamview/index.html#3.3.1.2___Présentation_de_l'interface_utilisateur"><span style="font-size:9pt">Présentation de l'interface utilisateur</span></a><span style="font-size:9pt"><br />3.3.2 </span><a href="ccamview/index.html#3.3.2____Rechercher_un_code_dans_la_CCAM"><span style="font-size:9pt">Rechercher un code dans la CCAM</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.3 </span><a href="ccamview/index.html#3.3.3____Le_Thésaurus"><span style="font-size:9pt">Le Thésaurus</span></a><span style="font-size:9pt"><br />3.3.</span><span style="font-family:Liberation Sans;font-size:9pt">3.1 </span><a href="ccamview/index.html#3.3.3.1__Trier_les_actes_du_thesaurus_et_Filtrer_par_catégorie"><span style="font-size:9pt">Trier les actes du thesaurus et Filtrer par catégorie</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.3.2 </span><a href="ccamview/index.html#3.3.3.2__Ajout_d'un_acte_au_thesaurus"><span style="font-size:9pt">Ajout d'un acte au thesaurus</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.3.3 </span><a href="ccamview/index.html#3.3.3.3_Modification_du_libellé_usuel_et_catégorie_d'un_acte_du_thesaurus"><span style="font-size:9pt">Modification du libelle usuel et catégorie d'un acte du thesaurus</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.3.4</span><span style="font-family:Trebuchet Ms;font-size:9pt"> </span><a href="ccamview/index.html#3.3.3.4__Suppression_d'un_acte_du_thesaurus"><span style="font-size:9pt">Suppression d'un acte du thesaurus</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.3.5</span><span style="font-family:Trebuchet Ms;font-size:9pt"> </span><a href="ccamview/index.html#3.3.3.5__Impression_du_thesaurus"><span style="font-size:9pt">Impression du thesaurus</span></a><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.4 </span><a href="ccamview/index.html#3.3.4____Le_Résumé_des_actes_Patient"><span style="font-size:9pt">Le Résumé des actes Patient</span></a><span style="font-size:9pt"><br />3.3.5 </span><a href="ccamview/index.html#3.3.5____L'impression_du_résumé_CCAM"><span style="font-size:9pt">L'impression du résumé</span></a><span style="font-size:9pt"><br />3.3.5.</span><span style="font-family:Trebuchet Ms;font-size:9pt">1 </span><a href="ccamview/index.html#3.3.5.1_Généralités"><span style="font-size:9pt">Généralités</span></a><span style="font-family:Urw Bookman l [Urw];font-size:9pt"><br /></span><span style="font-size:9pt">3.3.5.</span><span style="font-family:Trebuchet Ms;font-size:9pt">2 </span><a href="ccamview/index.html#3.3.5.2_Paramétrage_des_marges_et_résolution_d'impression"><span style="font-size:9pt">Paramétrage des marges et résolution d'impression</span></a><span style="font-family:Urw Bookman l [Urw];font-size:9pt"><br /></span><span style="font-size:9pt">3.3.5.</span><span style="font-family:Trebuchet Ms;font-size:9pt">3 </span><a href="ccamview/index.html#3.3.5.3_Personnalisation_des_en-têtes_et_pieds_de_page"><span style="font-size:9pt">Personnalisation des entêtes et pieds de page</span></a><span style="font-family:Trebuchet Ms;font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">3.3.5.</span><span style="font-family:Trebuchet Ms;font-size:9pt">4 </span><a href="ccamview/index.html#3.3.5.4_Personnalisation_du_corps_du_document_(liste_des_actes)"><span style="font-size:9pt">Personnalisation du corps du document</span></a><span style="font-size:9pt"><br />3.3.6 </span><a href="ccamview/CCAM_ViewAbout.html"><span style="font-size:9pt">A propos de CCAM View </span></a></div></ul>
<p><span style="font-size:9pt">3.4 </span><a href="DrTux.html#3.4 ASSISTANT DE GESTION DES MENUS CONTEXTUELS"><span style="font-size:9pt">ASSISTANT DE GESTION DES MENUS CONTEXTUELS</span></a></p>
<ul type="disc"><div><span style="font-size:9pt">3.4.1 </span><a href="DrTux.html#3.4.1  Le principe des menus contextuels ( ou listes d'insertion) dans DrTux"><span style="font-size:9pt">Le principe des menus contextuels</span></a><span style="font-size:9pt"><br />3.4.2 </span><a href="DrTux.html#3.4.2   Créer un nouveau menu contextuel (ou listes d'insertion)"><span style="font-size:9pt">Créer un nouveau menu contextuel</span></a><span style="font-size:9pt"><br />3.4.3 </span><a href="DrTux.html#3.4.3   Modifier les menus contextuels avec l'assistant"><span style="font-size:9pt">Modifier les menus contextuels</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">3.4.3.1 </span><a href="DrTux.html#3.4.3.1   Ajouter une option"><span style="font-size:9pt">Ajouter une option</span></a><span style="font-size:9pt"><br />3.4.3.2 </span><a href="DrTux.html#3.4.3.2 Effacer un menu contextuel ( ou liste d'insertion)"><span style="font-size:9pt">Effacer un menu contextuel</span></a><span style="font-size:9pt"><br />3.4.3.3 </span><a href="DrTux.html#3.4.3.3 Les autres options du menu du gestionnaire de liste déroulante"><span style="font-size:9pt">Les autres options du menu</span></a><span style="font-size:9pt"><br />3.4.3.4 </span><a href="DrTux.html#3.4.3.4   Transformer un item simple de la liste en item texte"><span style="font-size:9pt">Transformer un item de la liste en Item texte</span></a><span style="font-size:9pt"> <br />3.4.3.5 </span><a href="DrTux.html#3.4.3.5  Trucs et astuces du texte d'une option"><span style="font-size:9pt">Trucs et astuces du texte d'une option</span></a><span style="font-size:9pt"><br />3.4.3.6 </span><a href="DrTux.html#3.4.3.6  Installer une liste d'options permanente dans le menu déroulant"><span style="font-size:9pt">Installer une liste d'options permanente dans le menu déroulant</span></a><span style="font-size:9pt"><br />3.4.3.7 </span><a href="DrTux.html#3.4.3.7   Installer un plugin dans une option du menu déroulant"><span style="font-size:9pt">Installer un plugin dans une option du menu déroulant</span></a><span style="font-size:9pt"><br /><a name="3.4.3.7   Installer un plugin dans une option du menu déroulant"></a>3.4.3.8  </span><a href="DrTux.html#3.4.3.8___La_Gestion_des_librairies_de_macro"><span style="font-size:9pt">La Gestion des librairies de macro</span></a><span style="font-size:9pt"><br />3.4.3.9  </span><a href="./Les Menus deroulants/Les menus deroulants.html"><span style="font-size:9pt">Un tutoriel vaut mieux qu'un long discours</span></a><span style="font-size:9pt">.</span></div></ul></ul>
<p><span style="font-size:9pt">4 </span><a href="DrTux.html#4 Description des fonctions en relation avec le langage de scrip"><span style="font-size:9pt">Description des fonctions en relation avec le langage de script</span></a></p>
<ul type="disc"><div><span style="font-size:9pt">4.1 </span><a href="DrTux.html#4.1 Exemple avancé d'utilisation du scanner et des menus de MedinTux"><span style="font-size:9pt">Exemple avancé d'utilisation du scanner et des menus de MedinTux</span></a><span style="font-size:9pt"><br />4.2 </span><a href="DrTux.html#4.2 Exemple avancé de menu de retouche d'images avec The Gimp et MedinTux"><span style="font-size:9pt">Exemple avancé d'un menu de retouche d'images avec The Gimp et MedinTux</span></a><span style="font-size:9pt"><br />4.3 </span><a href="DrTux.html#4.3 Exemple avancé de menu d'OCR (reconnaissance de caractères) avec Xsane Tesseract et MedinTux"><span style="font-size:9pt">Exemple avancé de menu d'OCR (reconnaissance de caractères) avec Xsane Tesseract et MedinTux</span></a><span style="font-size:9pt"><br />4.4 </span><a href="DrTux.html#4.4 Les menus utilisateurs"><span style="font-size:9pt">Les menus utilisateurs</span></a><span style="font-size:9pt"><br />4.5 </span><a href="DrTux.html#4.5 Le Langage de Script de MedinTux"><span style="font-size:9pt">Le Langage de Script de MedinTuxI Apports de DrTux au sein d'un service d'urgences</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">4.5.1 </span><a href="DrTux.html#4.5.1 - Définition"><span style="font-size:9pt">Définition</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">4.5.1.1</span><span style="font-family:Luxi Mono;font-size:9pt"> </span><a href="DrTux.html#4.5.1.1  Affectation directe du résultat d'une macro dans une variable"><span style="font-size:9pt">Affectation directe du résultat d'une macro dans une variable</span></a><span style="font-size:9pt"><br />4.5.1.2 </span><a href="DrTux.html#4.5.1.2  Passage de valeurs aux fonctions par référence à une variable"><span style="font-size:9pt">Passage de valeurs aux fonctions par référence à une variable</span></a></div></ul>
<div><span style="font-size:9pt">4.5.2</span><span style="font-size:9pt;font-weight:600"> </span><a href="DrTux.html#4.5.2 Où se situent et se cachent les Scripts MedinTux ? dans"><span style="font-size:9pt">Où se situent et se cachent et sont éxecutés les Scripts MedinTux</span></a></div>
<div><span style="font-size:9pt">4.5.3 </span><a href="DrTux.html#4.5.3 Inventaire des instructions"><span style="font-size:9pt">Inventaire des instructions</span></a></div></ul></ul>
<p><span style="font-size:9pt">5  </span><a href="DrTux.html#5_Un_système_de_classement_intelligent_,_LA_VIGIE_,"><span style="font-size:9pt">Un puissant système de classement intelligent : LA VIGIE</span></a></p>
<ul type="disc"><div><span style="font-size:9pt">5.1 </span><a href="DrTux.html#5.1_Une_règle_très_simple_pour_beaucoup_de_puissance_,"><span style="font-size:9pt">Une règle très simple pour beaucoup de puissance :</span></a></div>
<ul type="disc"><div><span style="font-size:9pt">5.2.1 </span><a href="DrTux.html#5.2.1_Placement_et_dispositon_de_la_vigie_,"><span style="font-size:9pt">Placement et disposit</span></a><span style="font-size:9pt">i</span><a href="DrTux.html#5.2.1_Placement_et_dispositon_de_la_vigie_,"><span style="font-size:9pt">on de la vigie</span></a><span style="font-size:9pt"><br />5.2.2 </span><a href="DrTux.html#5.2.2_La_vigie_se_divise_en_deux_parties"><span style="font-size:9pt">La vigie se divise en deux parties</span></a><span style="font-size:9pt"><br />5.3 </span><a href="DrTux.html#5.3_La_Vigie_par_l'exemple_,_réalisation_d'un_classeur_de_Vaccinations"><span style="font-size:9pt">La Vigie par l'exemple : réalisation d'un classeur de Vaccinations</span></a><span style="font-size:9pt"><br />5.3.1 - </span><a href="DrTux.html#5.3.1_-_Élaboration_et_édition_du_document_insérant_automatiquement_le_classeur_Vaccinations"><span style="font-size:9pt">Élaboration et édition du document insérant automatiquement le classeur Vaccinations</span></a></div></ul></ul>
<p><span style="font-size:9pt">6  </span><a href="DrTux.html#6__Définir_et_créer_des_rubriques_supplémentaires"><span style="font-size:9pt">Définir et créer des rubriques supplémentaires</span></a><span style="font-size:9pt"><br />7 </span><a href="./AccesRapide/DrTuxAccesRapide.html"><span style="font-size:9pt">Le module résumé dossier</span></a><span style="font-size:9pt"><br />8 </span><a href="./FormPDF/index.html"><span style="font-size:9pt">Gestion des formulaires PDF</span></a><span style="font-size:9pt"><br />9 </span><a href="./Graphique/Graph.html"><span style="font-size:9pt">Les courbes de croissance</span></a></p>
<p><span style="font-size:9pt"><br /></span><hr><a name="1 Apports de DrTux au sein d'un service d'urgences"></a><span style="font-weight:600;text-decoration:underline">1 Apports de DrTux au sein d'un service d'urgences :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p><span style="text-decoration:underline">Rigueur des prises en charge avec </span>:</p>
<ul type="disc"><li>la protocolisation des Observations types ; </li>
<li>le contrôle temps réel de la validité du dossier ; </li>
<li>Codage CIM 10, CCAM, GEMSA, CCMU temps réel.</li></ul>
<p><span style="text-decoration:underline">Réduction considérable des tâches de secrétariat par </span>:</p>
<ul type="disc"><li>Recherche et classement des dossiers ; </li>
<li>Lisibilité typographique parfaite par rapport à une écriture manuelle ; </li>
<li>L'automatisation des documents types (certificats etc.) ; </li>
<li>Élaboration automatique des statistiques avec production automatisée des fichiers RPU.</li></ul>
<p><span style="text-decoration:underline">Réduction du temps de prise en charge médicale par </span>:</p>
<ul type="disc"><li>Historique des passages aux urgences ; </li>
<li>Protocolisation des prises en charge ; </li>
<li>L'outil d'aide à la prescription demi-automatisée ; </li>
<li>Élaboration des prescriptions et documents types (information au patient etc.).</li></ul>
<p><br /><br /><hr><a name="2 DESCRIPTION DES RUBRIQUES PRINCIPALES"></a><span style="font-weight:600;text-decoration:underline">2 DESCRIPTION DES RUBRIQUES PRINCIPALES</span>: (d'autres spécialisées sont à venir)</p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<ul type="disc"><div><span style="font-size:12pt">2.1 </span>Module de saisie de l'identité du patient<span style="font-size:12pt"><br />2.2 </span>Module de recherche patients<span style="font-size:12pt"><br />2.3 </span>Module de saisie des dossiers<span style="font-size:12pt"><br />2.4 </span>Module des prescriptions<span style="font-size:12pt"><br />2.5 </span>Module du terrain<span style="font-size:12pt"><br />2.6 </span>Module du Glossaire</div></ul>
<p><br />DrTux est divisé en plusieurs rubriques ou modules fonctionnels (nous emploieront soit un terme, soit l'autre),<br />réunis au sein d'un cadre principal ( <a href="DrTuxVueGenerale.html">Vue générale de DrTux</a> ) <br />Voici les descriptions et vues de chacune d'elles.</p>
<p><hr><br /><a name="2.1  Module de saisie de l'identité du patient"></a><span style="font-size:12pt;font-weight:600;text-decoration:underline">2.1 Module de saisie de l'identité du patient:</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p><br /><img src=DrTuxIdentite.png ><br /><br />sans particularité, avec les classiques :</p>
<ul type="disc"><li>calcul automatique de la clef du numéro de sécurité sociale ; </li>
<li>contrôle de la validité et cohérence de la saisie : exemple un patient assuré de sexe masculin ne peut avoir <br />un numéro de sécurité sociale commençant par 2, de même pour l'année de naissance etc. </li>
<li>Liste des intervenants sur ce patient: médecin traitant, médecins spécialistes,  paramédical etc. </li>
<li>Une zone texte libre où il est possible de saisir une courte note d'ordre général sur ce patient ; </li>
<li>Ville automatiquement inscrite après saisie du code postal, liste de tous les codes postaux Français<br />et menu de choix lors des ambiguïtés (plusieurs noms de villes pour un même code postal ou<br />plusieurs codes postaux pour la même ville).</li></ul>
<p><br /><hr><a name="2.2  Module de recherche patients"></a><span style="font-size:12pt;font-weight:600;text-decoration:underline">2.2  Module de recherche patients :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p><br /><span style="text-decoration:underline"><img src=DrTuxChoixPatient.png ></span><br /><br />Pas de grande particularité non plus, <span style="font-weight:600">il faut saisir le nom et prénom séparés<br />par un point virgule</span> et la liste s'affinera au fur et mesure de la saisie jusqu'à<br />votre convenance.<br /><br /><span style="text-decoration:underline">Pour séparer les homonymies</span> il suffit de cliquer sur un des éléments de la<br />liste et de regarder dans le module d'identité si c'est bien le patient <br />recherché.<br /><br /><span style="text-decoration:underline">Si la case à cocher autre</span> est cochée, alors le patient sélectionné s'ouvrira<br />dans une autre instance de DrTux. (il est possible d'avoir ainsi plusieurs<br />dossiers ouverts)<br /><br /><span style="text-decoration:underline">Le Symbole pour  </span><span style="font-weight:600;text-decoration:underline">cent %</span><span style="text-decoration:underline"> </span> placé avant ou après le nom ou prénom permet de faire une recherche sur tout ce qui contient l'expression.</p>
<p>                          Exemple :  <span style="font-weight:600">%MART;%JE </span>cherchera toutes les personnes dont le nom contient : <span style="font-weight:600">MART</span>  et dont le prénom contient : <span style="font-weight:600">JE</span><br /><br /><span style="text-decoration:underline">Le bouton Nouveau</span> permet de créer un nouveau dossier et fait apparaître<br />le module de saisie de l'identité pour le compléter et l'enregistrer</p>
<p><br /><hr><a name="2.3 Module de saisie des dossiers"></a> <span style="font-size:12pt;font-weight:600;text-decoration:underline">2.3 Module de saisie des dossiers:</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Tout d'abord, une vue générale d'une observation établie à partir d'un protocole type.<br /><br /><img src=DrTuxObservation.png ><br /><br /> Ce module observation n'est rien d'autre qu'un éditeur de texte avec des aides à la saisie<br />permettant d'ajouter du texte formaté à partir :</p>
<ul type="disc"><li><span style="text-decoration:underline">Soit d'assistants,</span> avec boîte de dialogue, tels que la saisie des codes CCAM, CIM 10, Actes Classants RPU,<br />accessibles dans les menus et la barre d'outils, et par le menu déroulant contextuel s'il y est indiqué d'accéder<br />à un assistant, il est aussi possible d'indiquer un programme externe, comme assistant. </li>
<li><span style="text-decoration:underline">Soit à l'aide du  Glossaire</span> par l'importation directe de blocs de texte provenant des différents protocoles, accessibles<br />avec ce fabuleux outil qu'est le glossaire. </li>
<li><span style="text-decoration:underline">Soit à l'aide d'un système de menus déroulants</span> contextuels en cascades accessibles avec le bouton<br />droit de la souris ou la touche F2. Le type menu contextuel dépend d'un mot clef de couleur<span style="color:#0000ff"> bleue</span> situé<br />dans les 5 lignes précédant le curseur texte.<br />Il est, bien sûr, possible de créer, modifier, ces menus contextuels au sein des protocoles types, par l'intermédiaire<br />d'un assistant de la barre d'outils. </li></ul>
<p>La puissance de ces trois outils d'aide à la saisie permet d'accélérer considérablement la saisie,<br />et surtout d'homogénéiser les termes et formes des documents afin d'en améliorer la cohérence.<br /><br />Une liste déroulante <img src=point02.png > permet d'accéder à tout l'historique des observations de ce patient<br />avec mise à jour temps réel et automatique des contenus des observation lors du parcours<br />de cette liste déroulante.<br /><br />Il est possible d'effacer une observation, de l'enregistrer, et de l'imprimer, de l'exporter<br />sous le format html.</p>
<p><hr><a name="2.4 Module des prescriptions"></a>  <span style="font-size:12pt;font-weight:600;text-decoration:underline">2.4 Module des prescriptions :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Le mot prescription est pris au sens large du terme. Sont considérés comme prescriptions <br />tous les documents suivants remis au patient, c'est-à-dire : certificats, bons de passage, <br />prescriptions pharmaceutiques, informations au patient, examens complémentaires.<br /><br /><span style="text-decoration:underline">Il existe deux formes de prescription :</span></p>
<ul type="disc"><div><img src=bulletcyan01.png > Les prescriptions textuelles types (avec leur masques et champs de fusion ou d'importations de données), <br />qui  vont, une fois importées dans le dossier du patient, se comporter comme un banal document texte. <br />Elles peuvent aussi comporter comme les Observations, des zones de menu contextuel. <br />Elles sont présentes et à rechercher dans le chapitre prescriptions du Glossaire <br />(DrTux positionne automatiquement le Glossaire dessus lorsque le module prescriptions est actif)<br /><br /><img src=bulletcyan01.png > Les prescriptions médicamenteuses structurées qui sont établies à partir de l'assistant <br />d'aide à la prescription médicamenteuse, et qui peuvent à tout moment êtres modifiées <br />par cet assistant. Ces prescriptions sont signalées par un petit Logo : <img src=VidalLitle.png > emprunté à la base<br />thérapeutique Vidal, dont les données sont à la base de l'assistant d'aide à la prescription.</div></ul>
<p><br /><br /><hr><img src=gnome-warning.png > <span style="font-size:12pt;font-weight:600;text-decoration:underline">ATTENTION S.V.P</span><br /><span style="text-decoration:underline">La </span><span style="font-weight:600;text-decoration:underline">CRÉATION</span><span style="text-decoration:underline"> d'une nouvelle ordonnance structurée</span>, se fait en cliquant sur le<br /> logo Vidal   <img src=VidalLitle.png >   situé au niveau <span style="font-weight:600">de la barre d'outils GENERALE </span>de DrTuX.<br /><br /><span style="text-decoration:underline">La </span><span style="font-weight:600;text-decoration:underline">MODIFICATION</span><span style="text-decoration:underline"> d'une ordonnance structurée</span>, déjà existante se fait en cliquant <br />sur le logo Vidal   <img src=VidalLitle.png >   situé au niveau <span style="font-weight:600">de la barre d'outils DU MODULE DE PRESCRIPTION </span>de DrTuX.<br /><br /><br /><hr><br />Un petit aperçu de ce module avec une ordonnance  structurée par l'outil d'aide à la saisie.<br /><br /><img src=DrTuxPrescription.png ></p>
<p><hr><a name="2.5 Module du terrain"></a> <span style="font-size:12pt;font-weight:600;text-decoration:underline">2.5 Module du terrain :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p>Le terrain rassemble toutes les données et variables fixes ou peu changeantes, <br />caractérisant le dernier état de santé du patient.<br /><br /><img src=DrTuxTerrain.png ><br /><br />Le terrain est divisé en trois parties :<br /><br /><img src=bulletcyan01.png > <span style="font-weight:600">-A-</span> <span style="text-decoration:underline">Liste des Antécédents et allergies</span> du patient, à saisir soit à l'aide :</p>
<ul type="disc"><li>de l'assistant de saisie des allergies, fondé sur la base thérapeutique Vidal </li>
<li>de l'assistant de saisie CIM 10</li></ul>
<p><img src=bulletcyan01.png > <span style="font-weight:600">-B-</span> <span style="text-decoration:underline">Traitement en cours </span>: du patient, à saisir à l'aide </p>
<ul type="disc"><li>de l'assistant d'aide à la prescription structurée Vidal qui s'ouvre en double cliquant<br />sur la liste, ou en cliquant sur l'icône : <img src=DrTuxTerrainPlus.png > </li></ul>
<p><img src=bulletcyan01.png > <span style="font-weight:600">-C-</span> <span style="text-decoration:underline">Liste des variables de surveillance du patient</span></p>
<ul type="disc"><li>Cette zone comporte la possibilité de définir, pour un patient donné, des variables <br />dont la saisie à intervalles datés permet d'obtenir un profil sur un état précis.<br />La tension artérielle, le poids, le pouls sont des exemples de variables.<br />La présentation et la saisie se font sous forme d'un tableau daté, à plusieurs colonnes,<br />chacune d'elles étant la valeur d'une variable à un instant donné.<br />La définition d'un tableau de variable se fait très facilement à l'aide d'un<br />éditeur de texte, et est à placer dans le chapitre Terrain du Glossaire.<br />Les différents modèle de tableau de variable sont présentés et à rechercher dans le chapitre <br />Terrain du Glossaire (DrTux positionne automatiquement le Glossaire dessus lorsque le module Terrain est actif) </li>
<li>Exemple de Modèle de tableau de variable :<br /><br />[VAR Constantes de Base] </li>
<div>   Modèle = Date, Pouls, 31536000, 130, 40, pps, Tachycardie, Bradycardie</div>
<div>   Modèle = Date, SAO², 31536000, 0, 92, %, , Hypoxie</div>
<div>   Modèle = Date, T°, 31536000, 40.5, 35, °, Hypothermie, Hyperthermie</div>
<div>[VAR Poids]</div>
<div>   Modèle = Date, Poids, 31536000, 100, 50, Kg(s), Obésité, Amaigrissement<br /><br /><span style="font-weight:600;color:#550000">=&gt;</span> Nous voyons que chaque tableau est introduit par la mention : [VAR  <br />suivie d'un espace puis du nom du tableau : Constantes de Base]   <br /><br /><span style="font-weight:600;color:#550000">=&gt;</span>  Nous voyons que chaque colonne du tableau représentant une variable (prenons par exemple la première) est<br /><br />° introduite par la mention :   Modèle =s<br />° suivie de la mention obligatoire  Date ,  indiquant que la date de la variable doit être saisie, puis<br />° suit séparé par une virgule,  Pouls, indiquant le nom de la variable à afficher en titre de colonne, puis<br />° suit séparé par une virgule,  31536000, valeur indiquant en secondes la période entre deux acquisitions  puis<br />° suit séparé par une virgule,  130, valeur maximale avant alerte, puis<br />° suit séparé par une virgule,  40, valeur minimale avant alerte,  puis<br />° suit séparé par une virgule,  pps, unité de mesure de la variable,  puis<br />° suit séparé par une virgule,  Tachycardie, Libellé texte de l'alerte maximum,  puis<br />° suit séparé par une virgule,  Bradycardie, Libellé texte de l'alerte minimum.<br /><br />Dans cet exemple  la valeur très grande 31536000 permet de bloquer l'automatisme d'acquisition qui est réservé <br />pour des usages futurs.</div></ul>
<p><hr> <a name="2.6 Module du Glossaire"></a><span style="font-size:12pt;font-weight:600;text-decoration:underline">2.6 Module du Glossaire:</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Le Glossaire ....   ou sac à malice de DrTux, est une sorte de stockage hiérarchisé<br />dans lequel il vous faudra placer tous les modèles, protocoles, prescriptions, informations <br />et documents types que vous aurez élaborés.<br />Le <span style="font-weight:600">Glossaire</span> est un répertoire disque situé dans le répertoire de DrTux  exemple :   drtux/Glossaire<br /><br /><a name="2.6.1   Changer l'emplacement du répertoire du Glossaire"></a><span style="font-weight:600">2.6.1 </span> <span style="text-decoration:underline">Changer l'emplacement du répertoire du Glossaire </span>:</p>
<ul type="disc"><div>Il tout de même possible en modifiant l'entrée suivante du fichier :  <span style="font-weight:600">DrTux.ini<br /></span>    [Glossaire]<br />         PathGlossaire = //pathQueVousVoulez<br />de changer l'emplacement du Glossaire en précisant le nouvel emplacement après la mention : PathGlossaire =<br />Cela peut se faire aussi en cliquant sur le bouton : <img src=DrTuxGlossaireChange.png > qui vous propose à l'aide du<br />sélecteur de fichiers, de relocaliser et choisir un répertoire différent où se trouve un<br />autre glossaire.</div></ul>
<p><br /><a name="2.6.2   Répertoires importants du Glossaire"></a><span style="font-weight:600">2.6.2 </span> <span style="text-decoration:underline">Répertoires importants du Glossaire </span>:<br /><br />DrTux se réfère à plusieurs répertoires critiques, dont il ne convient pas<br />de modifier la hiérarchie par rapport au répertoire de base du Glossaire.</p>
<p>Ces répertoires sont les suivants :</p>
<ul type="disc"><div>Glossaire/Observation               contient tous les modèles et protocoles types des observations<br />Glossaire/Terrain         contient tous les modèles types des variables de terrain<br />Glossaire/Champs d'insertions       contient tous les éléments constitutifs des menus contextuels<br />Glossaire/Prescription     contient toutes les prescriptions types<br />Glossaire/Documents     contient toutes les modèle d'insertion types des documents</div></ul>
<p>l'intérieur de chacun de ces répertoires, il vous est possible et même<br />conseillé d'organiser la hiérarchie que vous souhaitez pour classer<br />vos documents types protocoles etc. exemple :</p>
<ul type="disc"><div>Glossaire/Prescription/Certificats types<br />Glossaire/Prescription/Ordonnances types<br />Glossaire/Prescription/Info Au Patient</div></ul>
<p><a name="2.6.3   Sélectionner et importer un document du Glossaire"></a><span style="font-weight:600">2.6.3 </span> <span style="text-decoration:underline">Sélectionner et importer un document du Glossaire</span>:<br /><br />Lors de l'activation des différentes rubriques de DrTux, le Glossaire se positionne<br />sur le répertoire racine de la rubrique concernée, présentant ainsi tous les documents et la <br />hiérarchie de documents relatifs à la rubrique. L'exemple ci-dessous montre le glossaire positionné<br />sur le répertoire des prescriptions.<br /><br /><img src=DrTuxGlossaire.png ><br /><br /><span style="text-decoration:underline">Simple clic pour: afficher/copier/coller </span>:<br /><br />Le simple clic sur un document provoquera son affichage <br />dans la fenêtre de visualisation en dessous.<br />Il est alors possible de sélectionner simplement un bloc <br />de texte et le copier/coller dans le document déjà présent.<br /><br /><span style="text-decoration:underline">Double clic pour : création et importer directement</span> dans un nouveau document<br />de la rubrique:</p>
<ul type="disc"><div>° Nouvelle observation ajoutée au patient<br />° Nouvelle prescription ajoutée au patient<br />° Nouvelle variable de terrain ajoutée au terrain</div></ul>
<p><a name="2.6.4    Le menu contextuel du Glossaire"></a><span style="font-weight:600">2.6.4 </span><span style="text-decoration:underline">Le menu contextuel du Glossaire:</span><br />Ce menu est accessible en cliquant avec le bouton droit<br />de la souris, celle-ci au-dessus d'un des documents <br />du glossaire. <br />Les options de ce menu sont les suivantes :<br /><br /><img src=DrTuxGlossaireContextMenu.png ></p>
<ul type="disc"><div>° Créer un  nouveau document</div>
<ul type="disc"><div>Crée un nouveau document (observation ou prescription) à<br />partir de celui sélectionné dans le glossaire.</div></ul>
<div>     <br />° Ajouter ce document au curseur  </div>
<ul type="disc"><div>Insère le document sélectionné dans le Glossaire à l'emplacement<br />du curseur texte.  </div></ul>
<div><br />° Remplacer tout par ce document </div>
<ul type="disc"><div>Remplace tout le contenu d'une prescription ou<br />observation par le document sélectionné dans le Glossaire.</div></ul>
<div> <br />° Modifier et éditer ce document</div>
<ul type="disc"><div>Ouvre QLightPad (un éditeur de texte  .html)   afin de<br />pouvoir modifier le document sélectionné dans le Glossaire.<br />un deuxième document présentant la liste des champs<br />de fusion (pouvant importer les données de la base de données) possibles<br />est aussi ouvert simultanément afin que vous puissiez, par copier coller,<br />les placer dans votre document.</div></ul>
<div><br />° Renommer ce document</div>
<ul type="disc"><div>Changer le nom du document sélectionné dans le Glossaire.</div></ul>
<div><br />° Détruire ce document</div>
<ul type="disc"><div>Détruire le document sélectionné dans le Glossaire.</div></ul></ul>
<p><hr>  <a name="2.7_Principe_des_modèles_et_maquettes_de_document"></a><span style="font-size:12pt;font-weight:600;text-decoration:underline">2.7 <a name="Principe_des_modèles_et_maquettes_de_document"></a>Principe des modèles et maquettes de document :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p><img src=bulletcyan01.png ><span style="font-weight:600"> <a name="Principe"></a></span><span style="text-decoration:underline">Principe des modèles de documents</span> : <br /><br />Les Observations et Prescriptions de MedinTux ne sont<br />rien d'autre que des textes HTML, intégrant un mécanisme puissant<br />de menus déroulants hiérarchiques dynamiques, permettant de faire des saisies <br />formatées. <br /><br />Cette particularité innovante et puissante de MedinTux mérite vraiment<br />que l'on se penche dessus. Le petit (vraiment petit!!) effort d'apprentissage<br />nécessaire pour en comprendre les mécanismes vous permettra de bâtir toute<br />une collection de modèles de documents types protocolisés et parfaitement adaptés <br />à votre pratique. Le temps gagné, la précision de vos observations, la sécurité de<br />votre pratique seront exceptionnelles.<br /><br />Vous pouvez imaginer un document type général, comme celui<br />livré avec MedinTux : <span style="font-weight:600">OBSERVATION_STANDARD.html</span><br />puis toute une collection de modèles et documents types, adaptés à chaque <br />situation courante que votre exercice rencontrera. Chacun de ses documents<br />et modèles peut avoir sa propre mécanique de menus déroulants avec les items<br />et propositions précisément adaptées à la situation en question.<br /><br /><br /><span style="font-weight:600;text-decoration:underline"><hr></span></p>
<p><img src=bulletcyan01.png ><span style="font-weight:600"> <a name="Où"></a></span><span style="text-decoration:underline">Où se trouvent les modèles de documents</span> : <br /><br />À gauche du dossier patient, se trouve le <span style="font-style:italic;font-weight:600;text-decoration:underline;color:#550000">Glossaire</span> de MedinTux.<br />Celui-ci présente une liste de documents types et modèles organisés et rangés dans<br />une arborescence de répertoires, qu'il vous est libre d'imaginer<br />selon vos besoins. <br /><br />Le <span style="font-style:italic;font-weight:600;text-decoration:underline;color:#550000">Glossaire</span> se positionne automatiquement sur un répertoire<br />principal de base, selon la fenêtre activée :<br /><br /> Ci-dessous, voici le <span style="font-style:italic;font-weight:600;text-decoration:underline;color:#550000">Glossaire</span><span style="font-weight:600"> </span><span style="font-style:italic">positionné sur le <br />  répertoire des </span><span style="font-style:italic;font-weight:600">Observations</span><span style="font-style:italic"> lorsque</span> la fenêtre<br /> <span style="font-weight:600">Observation</span> est activée.<br /><img src=Glossaire_Gene.png >         <br />  <br /><br />Ci-dessous voici le <span style="font-style:italic;font-weight:600;text-decoration:underline;color:#550000">Glossaire</span><span style="font-style:italic"> positionné sur le <br />  répertoire des </span><span style="font-weight:600">Prescriptions</span> <span style="font-style:italic">lorsque</span> la fenêtre<br /> <span style="font-weight:600">Prescriptions</span> est activée.<br /> <img src=Glossaire_Presc.png ><br /><br /><br /><span style="font-weight:600;text-decoration:underline"><hr></span></p>
<p><img src=bulletcyan01.png ><span style="font-weight:600"> <a name="Modifier"></a></span><span style="text-decoration:underline">Modifier et éditer les modèles de documents</span> : <br /><br />Ces documents ne sont rien d'autre que de simples textes HTML.<br />qu'il vous est possible de modifier, à l'aide du petit éditeur de texte<br />dédié à cet usage : <span style="font-weight:600">QLightPad</span><br /><br />Pour éditer et modifier un document du <span style="font-style:italic;font-weight:600;text-decoration:underline;color:#550000">Glossaire</span><span style="font-style:italic"> </span>, positionnez la souris au-dessus<br />de son libellé, sélectionnez-le avec un clic de souris, et cliquez sur l'icône <br />suivante :  <img src=Icone_Outils.png > Cela lancera le programme <span style="font-weight:600">QLightPad</span> avec le document<br />sélectionné . <br /><br />vous pouvez aussi cliquer dessus à l'aide du bouton droit de la souris,<br />cela fera apparaître le menu déroulant suivant :<br /><br /><img src=Glossaire_Deroulant_Editer.png ><br /><br />Où il vous faudra cliquer sur l'option : <span style="font-weight:600">Modifier et éditer ce modèle </span></p>
<p><hr><a name="3   DESCRIPTION DES ASSISTANTS"></a><span style="font-size:12pt"> </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">3  DESCRIPTION DES ASSISTANTS </span><span style="font-size:12pt">:</span></p>
<p><hr><a name="3.1 Assistant d'aide à la prescription"></a><span style="font-size:12pt;font-weight:600">3.1 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Assistant d'aide à la prescription :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Les possibilités fonctionnelles de cet assistant étant riches et nombreuses,<br />il fait l'objet d'un chapitre à part : ASSISTANT D'AIDE A LA PRESCRIPTION</p>
<p><hr><a name="3.2 ASSISTANT DE CODAGE CIM 10"></a> <span style="font-size:12pt;font-weight:600">3.2 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">ASSISTANT DE CODAGE CIM 10:</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p>L'assistant d'aide au codage CIM10 se présente sous forme d'un dialogue<br />divisé en deux parties :</p>
<ul type="disc"><div><img src=bulletcyan01.png > une partie à droite, destinée à recevoir l'ensemble des codes sélectionnés pour ce dossier.<br />L'appui sur le bouton OK, valide les items présents dans liste de droite, et les<br />ajoute à l'observation en cours. <br />Pour retirer un item de cette liste, sélectionnez-le et appuyez sur le bouton  <img src=DrTuxCim10ChoixRem.png ><br /><br /><img src=bulletcyan01.png > une partie à gauche, destinée à la recherche des libellés des codes. Celle-ci peut<br />se faire de trois manières différentes :</div></ul>
<p><br /><br /><img src=DrTuxCim10General.png ></p>
<p><span style="font-weight:600;text-decoration:underline">noter </span>:</p>
<ul type="disc"><div><span style="font-weight:600">Après validation du choix des codes CIM10, le premier code de cette liste sera<br />placé comme intitulé du nom de l'observation en cours.</span></div></ul>
<p><hr> <a name="3.2.1   Sélectionner un code Cim10 à l'aide de la liste Simplifiée Urgences"></a><span style="font-weight:600">3.2.1 </span><span style="text-decoration:underline">Sélectionner un code Cim10 à l'aide de la liste Simplifiée Urgences</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<ul type="disc"><div>Cette liste simplifiée spéciale urgences est celle établie et recommandée<br />pour l'établissement des fichiers RPU, telle qu'elle a été définie par les<br />organismes de tutelle.<br /><br /><img src=DrTuxCim10SimplUrg.png ><br /><br />Lors de la saisie de mots clefs dans les zones de recherche un <img src=point01.png > et deux <img src=point02.png > <br />l'affichage des intitulés <img src=point03.png > s'affine au fur et à mesure de leur présence <br />dans la liste.<br />Dès que vous êtes satisfait, cliquez sur l'un des intitulés et<br />cliquez sur le bouton  <img src=DrTuxCim10ChoixAdd.png > afin de l'ajouter dans la liste de <br />sélection (partie droite de l'assistant)</div></ul>
<p><br /><hr><a name="3.2.2  Sélectionner un code Cim10 à l'aide de la liste Hiérarchisée"></a><span style="font-weight:600">3.2.2 </span><span style="text-decoration:underline">Sélectionner un code Cim10 à l'aide de la liste Hiérarchisée</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Cette liste contient tout le Cim10 et expose la hiérarchie de<br />ses chapitres sous forme hiérarchisée.<br /><br /><img src=DrTuxCim10Hierarch.png ><br /><br />Pour afficher les items d'un chapitre , cliquez dessus.<br />Lorsque le clic ne dévoile plus de sous-chapitres, c'est<br />que vous êtes au niveau le plus bas.<br />Sélectionnez alors l'item qui vous convient et cliquez sur<br />le bouton <img src=DrTuxCim10ChoixAdd.png > afin de l'ajouter à la liste de sélection à<br />droite.</div></ul>
<p><br /><br /><hr><a name="3.2.3  Sélectionner un code Cim10 à l'aide de la liste Globale"></a><span style="font-weight:600">3.2.3 </span><span style="text-decoration:underline">Sélectionner un code Cim10 à l'aide de la liste Globale</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Dans ce mode, tous les items de la liste CIM10 sont<br />présents.<br /><br /><img src=DrTuxCim10Tous.png > <br /><br />Saisissez un mot clef, la liste s'affinera et affichera tous<br />les items contenant ce mot clef.<br />Sélectionnez alors l'item qui vous convient et cliquez sur<br />le bouton <img src=DrTuxCim10ChoixAdd.png > afin de l'ajouter à la liste de sélection à<br />droite.</div></ul>
<p><br /><hr><a name="3.2.4  Sélectionner un code Cim10 à l'aide de la liste HTML"></a><span style="font-weight:600">3.2.4 </span><span style="text-decoration:underline">Sélectionner un code Cim10 à l'aide de la liste HTML</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Ce mode simplifié pour les urgences présente une liste à gauche <br />avec les chapitres généraux. Lors d'un clic sur l'un des chapitres,<br /><br /> <img src=DrTuxCim10Html.png ><br /><br />son contenu s'affichera dans la liste du milieu, le choix d'un code<br />CIM10 se fait alors simplement en cliquant sur l'un des items<br />de la liste du milieu.</div></ul>
<p><br /><br /><hr><a name="3.3 Assistant de codage CCAM"></a><span style="font-size:12pt;font-weight:600">3.3 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Assistant de codage CCAM :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Les possibilités fonctionnelles de cet assistant étant riches et nombreuses,<br />il fait l'objet d'un chapitre à part : <a href="CCAM_ViewDoc.html#ASSISTANT DE CODAGE CCAM">ASSISTANT DE CODAGE CCAM</a></p>
<p><hr> <a name="3.4 ASSISTANT DE GESTION DES MENUS CONTEXTUELS"></a><span style="font-size:12pt;font-weight:600">3.4 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">ASSISTANT DE GESTION DES MENUS CONTEXTUELS :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<ul type="disc"><div>La puissance des menus contextuels mérite vraiment d'en maîtriser le<br />fonctionnement. Le concept des menus contextuels est un des éléments clefs <br />dans le mode de saisie du texte dans DrTux et en font un outils d'aide<br />à la saisie extrêmement puissant et souple sans équivalent dans le monde<br />du logiciel médical. De telles possibilités ne peuvent pas êtres mises en<br />oeuvre sans un assistant d'aide à la gestion que nous allons voir ci-après.</div></ul>
<p><hr><a name="3.4.1  Le principe des menus contextuels ( ou listes d'insertion) dans DrTux"></a><span style="font-weight:600">3.4.1 </span> <span style="text-decoration:underline">Le principe des menus contextuels (ou listes d'insertion) dans DrTux</span>: </p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Comme vous pouvez le voir sur la figure ci-après, un clic souris ou un appui de la touche F2 <br />à droite le la zone texte bleue : <span style="font-weight:600">«</span><span style="font-weight:600;color:#0000ff"> plaie </span><span style="font-weight:600">»</span><span style="color:#0000ff"> </span> a fait apparaître un menu surgissant avec les<br />propositions textuelles suivantes</div>
<ul type="disc"><div>avec lambeau cutané<br />avec lésion tendineuse<br />avec perte de substance<br />avec dermabrasion<br />risque tétanigène<br />souillée par</div></ul>
<div>qui sont en rapport avec le mot  <span style="font-weight:600">«</span><span style="color:#0000ff"> </span><span style="font-weight:600;color:#0000ff">plaie </span><span style="font-weight:600">»</span>.<span style="color:#0000ff"><br /><br /></span><img src=DrTuxMenuContextAction.png ><br /><br />Le choix  de l'une des propositions se fait en cliquant sur l'une d'elles, ce qui<br />aura pour effet de l'ajouter à l'emplacement du curseur texte.<br /><br />Cette insertion de texte peut très bien être aussi une autre<br />zone de menu déroulant (cas des propositions dont l'icône<br />a la forme d'un dossier : <img src=folder_Icon.png > ) qui s'affichera alors en bleu<br />comme par exemple la proposition <span style="font-weight:600">«</span><span style="font-weight:600;color:#0000ff"> avec dermabrasion </span><span style="font-weight:600">»,</span><br />qui permet aussi un menu contextuel, et ainsi de suite.<br /><br />Il est donc possible de créer des documents types possédant déjà une<br />véritable architecture de menus contextuels dont la mise en oeuvre permet<br />de saisir très rapidement le dossier. C'est de cette façon qu'il est possible<br />de protocoliser la saisie avec des propositions homogènes et cohérentes.<br /><br />Nous verrons qu'il est aussi possible d'appeler avec un menu contextuel,<br />les dialogues et assistants de DrTux, ainsi que des programmes externes.</div></ul>
<p><hr><a name="3.4.2   Créer un nouveau menu contextuel (ou listes d'insertion)"></a><span style="font-weight:600">3.4.2 </span> <span style="text-decoration:underline">Créer un nouveau menu contextuel (ou listes d'insertion) :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<ul type="disc"><div>Pour comprendre, rien de mieux qu'un petit exemple :<br />Dans un des éditeurs de DrTux (Observation par exemple), saisissez le texte suivant<br />(sans les guillemets bien sûr !!) :   </div>
<div style="margin-top:1px"><span style="font-weight:600">« </span><span style="font-style:italic">Essai de création d'un menu contextuel</span> <span style="font-weight:600">»<br /></span><br />puis sélectionnez-le à la souris ou au clavier : <img src=DrTuxMenuContextTxtSel.png ><br /><br />puis cliquez sur l'icône :  <img src=CreateList_Item.png > dans la barre d'outils  <img src=DrTuxMenuToolDivers.png >  de DrTux.<br /><br />Désélectionnez le texte en <span style="font-weight:600">cliquant à sa droite.</span> Le texte devrait être <br />alors en bleu comme ceci : <span style="color:#0000ff">Essai de création d'un menu contextuel.</span><br /><br />Puis, cliquez avec le bouton droit de la souris, avec toujours le curseur texte et la souris<br /><span style="font-weight:600">positionnés à droite du texte</span>, le menu suivant devrait apparaître :<br /><br /><img src=DrTuxMenuContextModListe.png ><br /><br />Sélectionnez l'option: <span style="font-weight:600">«</span> <span style="font-weight:600">Modifier cette liste</span> <span style="font-weight:600">»</span><br />qui devrait faire apparaître l'assistant de gestion des<br />menus contextuels, que nous allons voir dans le paragraphe<br />suivant.</div></ul>
<p> <hr><a name="3.4.3   Modifier les menus contextuels avec l'assistant"></a><span style="font-weight:600">3.4.3 </span> <span style="text-decoration:underline">Modifier les menus contextuels avec l'assistant </span>:</p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Si vous avez suivi l'exemple précédent vous devriez avoir<br />la boîte de dialogue suivante (réduite pour des raisons de mise en page)<br />positionnée sur la liste que vous venez de créer :<br /><br /><img src=DrTuxAssitMenuContextLitle.png ><br /><br />Comme vous venez de créer cette liste, elle ne contient rien. Aussi, si vous cliquez dessus il<br />ne se passera rien.<br /><br />Cette boîte de dialogue est aussi accessible à l'aide de l'entrée de menu ci-dessous.<br /><br /><img src=DrTuxAssitMenuMenuAcces.png ><br /><br /><hr><a name="3.4.3.1   Ajouter une option"></a><span style="font-weight:600">3.4.3.1 </span> <span style="text-decoration:underline">Ajouter une option</span></div>
<div align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></div>
<div>positionnez la souris au-dessus de : <span style="font-weight:600">« Essai de création d'un menu contextuel</span> <span style="font-weight:600">»</span><br /><br /><img src=DrTuxAssitMenuContextSelListe.png ><br /><br />et cliquez avec le bouton droit. Vous devriez voir apparaître le menu suivant :<br /><br /><img src=DrTuxAssitMenuContextAddNew.png ><br /><br />listant les options suivantes :</div>
<ul type="disc"><div>° Créer et Ajouter un Nouvel élément à une liste<br />° Créer et Ajouter une référence à une autre liste<br />° Choisir une liste déjà existante, comme référence<br />° Créer une Nouvelle liste déroulante<br />° Renommer cet élément ou liste<br />° Effacer cet élément ou liste<br />° Vérifier si cette liste est référencée par d'autres<br />° Placer ce menu '.....' comme menu fixe d'une rubrique.</div></ul>
<div style="margin-bottom:12px"> <br />Cliquez sur l'option : <span style="font-weight:600">«</span> <span style="font-weight:600">Créer et Ajouter un  Nouvel élément à une liste</span> <span style="font-weight:600">»</span><br />le dialogue suivant vous invite alors à saisir le texte d'une nouvelle option de<br />votre menu contextuel.<br /><br /><img src=DrTuxAssitMenuContextNewElem.png ><br /><br />Saisissez par exemple : <span style="font-weight:600">«</span> Option numéro 1 <span style="font-weight:600">»,</span><br />puis répétez pour ajouter d'autres options à votre menu la procédure <br />précédente décrite en :  <span style="font-weight:600">«</span> -a- <span style="text-decoration:underline">Ajouter une option</span> <span style="font-weight:600">»</span><br />exemple :   <span style="font-weight:600">«</span> Option numéro 2 <span style="font-weight:600">»</span> , <span style="font-weight:600">«</span> Option numéro 3 <span style="font-weight:600">»<br /></span><br />La liste devrait alors se présenter comme suit, avec les nouvelles options saisies :<br /><br /><img src=DrTuxAssitMenuContextNewElem1.png ><br /><br />Fermez à présent l'assistant de gestion des menus contextuels<br />en cliquant sur la case de fermeture de la fenêtre,<br />puis positionnez  dans le texte, la souris <span style="font-weight:600">à droite</span> du texte de <br />couleur bleue : <span style="color:#0000ff"> Essai de création d'un menu contextuel, </span><br />et cliquez sur le bouton droit de la souris ou appuyez sur la<br />touche F2 le menu suivant devrait apparaître :<br /><br /><img src=DrTuxAssitMenuContextPopFinal.png ><br /><br />Bravo !!! vous avez créé un nouveau menu contextuel.<br /><br /><br /><hr> <a name="3.4.3.2 Effacer un menu contextuel ( ou liste d'insertion)"></a><span style="font-weight:600">3.4.3.2</span> <span style="text-decoration:underline">Effacer un menu contextuel (ou liste d'insertion)</span></div>
<div align="center" style="margin-bottom:12px"><img src=zix-arrow-right.png >Retour au menu principal</div>
<div style="margin-bottom:12px">Sélectionnez la liste à effacer, cliquez avec le bouton droit de la souris<br />pour afficher le menu, et cliquez sur l'option : <span style="font-weight:600">«</span> <span style="font-weight:600">Effacer cet élément ou liste »</span></div>
<div style="margin-bottom:12px"><hr><a name="3.4.3.3 Les autres options du menu du gestionnaire de liste déroulante"></a><span style="font-weight:600">3.4.3.3</span> Les autres options du menu du gestionnaire de liste déroulante</div>
<div align="center" style="margin-bottom:13px"><img src=zix-arrow-right.png >Retour au menu principal</div>
<div style="margin-bottom:12px">Le menu du gestionnaire de liste déroulante s'obtient en cliquant avec le<br />bouton droit de la souris, celle-ci placée au-dessus d'un élément de la liste<br />d'insertion.<br /><br /><img src=DrTuxAssitMenuContextSubMenuListe.png ><br /><br />listant les options suivantes :</div>
<ul type="disc"><div style="margin-top:12px">° <span style="font-weight:600">Créer et Ajouter un  Nouvel élément à une liste</span></div>
<ul type="disc"><div>Ajoute un nouvel item à la liste déroulante</div></ul>
<div><br />° <span style="font-weight:600">Créer et Ajouter une référence à une autre liste</span></div>
<ul type="disc"><div>Ajoute une nouvelle référence à une autre liste :<br />si cette référence indique une liste non existante,<br />une nouvelle liste vide sera créée. <br />Les références aux autres listes ont pour symbole<br />un petit dossier : <img src=folder_Icon.png ></div></ul>
<div><br />° <span style="font-weight:600">Choisir une liste déjà existante, comme référence</span></div>
<ul type="disc"><div>Permet d'ajouter une référence à une autre liste, <br />en la choisissant dans une liste de liste (heu !!! un dessin S.V.P.)<br /><br /><img src=DrTuxAssitMenuContextChoixRef.png ><br /><br />Les références aux autres listes ont pour symbole<br />un petit dossier : <img src=folder_Icon.png ></div></ul>
<div><br />° <span style="font-weight:600">Créer une Nouvelle liste déroulante</span></div>
<ul type="disc"><div>Comme son nom l'indique, cette option crée <br />simplement une nouvelle liste déroulante sans<br />ajouter de référence à une autre liste</div></ul>
<div><br />° <span style="font-weight:600">Renommer cet élément ou liste</span></div>
<ul type="disc"><div>permet de renommer un élément de la liste</div></ul>
<div>.<br />° <span style="font-weight:600">Effacer cet élément ou liste</span></div>
<ul type="disc"><div>Efface un élément de la liste</div></ul>
<div><br />° <span style="font-weight:600">Vérifier si cette liste est référencée par d'autres</span></div>
<ul type="disc"><div>Option très utile pour vérifier avant de renommer<br />ou effacer une liste, si celle-ci n'est pas déjà référencée<br />par une autre liste, auquel cas la référence deviendrait<br />fausse.</div></ul>
<div>° <span style="font-weight:600">Placer ce menu 'Menu Document' comme menu fixe d'une rubrique</span></div>
<ul type="disc"><div>Chaque rubrique peut avoir un menu déroulant ne dépendant pas du<br />contexte textuel de l'éditeur de texte. Cette option permet d'attribuer la<br />liste déroulante au-dessus de laquelle la souris se trouve, comme menu<br />déroulant fixe d'une rubrique à choisir dans la liste d'options présentée par<br />le sous menu :<br /><span style="font-style:italic">Placer ce menu 'nom de la rubrique' comme menu fixe d'une rubrique</span>.<br /><br /><img src=DrTuxAssitMenuContextSubMenuListe.png ></div></ul></ul>
<div><hr> <a name="3.4.3.4   Transformer un item simple de la liste en item texte"></a><span style="font-weight:600">3.4.3.4 </span> <span style="text-decoration:underline">Transformer un item simple de la liste en item texte :</span></div>
<div align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></div>
<div>Parfois vous souhaiterez qu'une option soit plus qu'une simple<br />ligne de texte, par exemple un bloc de texte complet.<br />Pour cela vous disposez  à la droite de la boîte listant les listes d'insertion, <img src=point02.png ><br />d'une petit éditeur de texte très simple, <img src=point04.png > <br />Sélectionnez un élément d'une liste, cliquez sur l'éditeur de texte, et vous<br />remarquerez que, dès que vous commencez à saisir des caractères <br />le symbole  <img src=SaveDiskIcon.png >  <img src=point03.png >s'affiche vous signalant une modification du contenu<br />textuel de l'option. <br />Cliquez ensuite sur ce symbole pour enregistrer les modifications.<br /><br /><img src=DrTuxAssitMenuContextRefToText.png ><br /><br />Toute option de liste, qui représente un texte est signalée par le symbole : <img src=filetxt_Icon.png ></div>
<div><br /><br /><hr> <a name="3.4.3.5  Trucs et astuces du texte d'une option"></a><span style="font-weight:600">3.4.3.5 </span> <span style="text-decoration:underline">Trucs et astuces du texte d'une option :</span></div>
<div align="center" style="margin-bottom:14px"><img src=zix-arrow-right.png >Retour au menu principal</div>
<ul type="disc"><div>° <span style="font-weight:600">Les modificateurs</span> <span style="font-size:9pt;font-weight:600;color:#aa0000">$start_title</span> <span style="font-weight:600">et</span> <span style="font-size:9pt;font-weight:600;color:#aa0000">$end_title</span> <span style="font-weight:600">pour afficher le titre d'une option en masquant le reste de l'option</span> :</div>
<ul type="disc"><div>Cette possibilité est utile par exemple pour les menus comportant des macros très longues qu'il n'est<br />pas utile de montrer. Pour cela vous placez au début du texte de l'option les <span style="text-decoration:underline">modificateurs</span> : <span style="font-size:9pt;font-weight:600;color:#aa0000">$start_title</span> et <span style="font-size:9pt;font-weight:600;color:#aa0000">$end_title</span> <br />encadrant le titre de l'option, puis à la suite le reste du texte devant être masqué.<br /><span style="font-style:italic;text-decoration:underline">Exemple</span> :<br /><span style="font-family:Courier New;font-size:9pt;font-weight:600;color:#aa0000">$start_title</span><span style="font-family:Courier New;font-size:9pt;font-weight:600">Numérisation et OCR avec Xsane et tesseract</span><span style="font-family:Courier New;font-size:9pt;font-weight:600;color:#aa0000">$end_title</span><span style="font-family:Courier New;font-size:9pt;font-weight:600"> très très longue macro à masquer........</span></div></ul>
<div>° <span style="font-weight:600">Le modificateur</span> <span style="font-weight:600;color:#aa0000">#</span> <span style="font-weight:600">indique que seul ce qui le suit doit être inséré</span> :</div>
<ul type="disc"><div>Ce modificateur permet de n'insérer que la dernière option d'un menu cascadé, sans les items précédents liés à la hiérarchie du menu.</div></ul>
<div><br />° <span style="font-weight:600">Le modificateur</span> <span style="font-weight:600;color:#aa0000">$NoInsert</span> <span style="font-weight:600">pour empêcher l'insertion de texte lors de l'exécution d'une option de menu</span> :</div>
<ul type="disc"><div>Ce <span style="text-decoration:underline">modificateur</span> :<span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$NoInsert</span><span style="font-size:9pt"> </span>fait en sorte qu'aucun texte ne sera inséré lors du choix de cette option.<br />Cela est utile par exemple pour des options ne devant pas insérér de texte mais juste exxécuter une macro.<br /><span style="font-style:italic;text-decoration:underline">Exemple</span> :<br /><span style="font-family:Courier;font-weight:600">$start_title Appel Google avec une sélection de texte $end_title </span><span style="font-family:Courier;font-weight:600;color:#aa0000">$noInsert</span><span style="font-family:Courier;font-weight:600">{{\<br />{{:: VAR_SET(selection,{{GET_SELECTION}})}}\<br />{{:: exe_process ( , C:/Program Files/Mozilla Firefox/firefox, http://www.google.fr/search?q={{VAR=selection}}&amp;ie=utf-8&amp;oe=utf-8&amp;aq=t&amp;rls=org.mozilla:fr:official&amp;client=firefox-a )}}}}</span></div></ul>
<div><br />° <span style="font-weight:600">Insérer une image dans le texte d'une option</span> :</div>
<ul type="disc"><div style="margin-top:12px">Cliquez sur l'icône en forme de fleur : <img src=DrTuxAssitMenuContextAddImage.png > et, à l'aide du sélecteur de fichiers, choisissez l'image<br />à insérer. Celle-ci se placera à l'emplacement du curseur texte. Il est à noter que l'image sera<br />recopiée dans le répertoire suivant : <span style="font-family:Courier;font-weight:600">ImagesFolder</span>, situé lui-même dans le même <br />répertoire de votre <span style="font-weight:600">Glossaire</span>.</div></ul>
<div style="margin-top:12px">° <span style="font-weight:600">Placer une référence à une autre liste, dans le texte</span> :</div>
<ul type="disc"><div style="margin-top:12px">Cliquez sur l'icône d'insertion de liste <img src=CreateList_Item.png > <img src=point05.png >, ce qui fera apparaître le menu déroulant suivant :<br /><br /><img src=DrTuxMenuContextInsertRef.png ><br /><br /><span style="text-decoration:underline">La première option</span> : <span style="font-weight:600">« Insérer au curseur une référence à une liste déroulante existante »</span><br />vous présentera la liste de toutes les listes d'insertion comme ci-dessous :<br /><br /><img src=DrTuxAssitMenuContextChoixRef.png ><br /><br />il suffit alors de cliquer sur celle dont on veut que la référence<br />soit indiquée dans le texte.<br /><br /><span style="text-decoration:underline">La deuxième option :</span>  <span style="font-weight:600">« Insérer au curseur une nouvelle liste déroulante à créer</span> <span style="font-weight:600">»</span><br />vous proposera, à partir du texte sélectionné auparavant, <br /><span style="font-weight:600"><br /></span><img src=DrTuxAssitMenuContextRefTocreate.png ><br /><br />de saisir le libellé ou intitulé d'une nouvelle liste à créer.</div></ul>
<div style="margin-top:12px">° <span style="font-weight:600">Appel d'un assistant de DrTux et insertions de formules préétablies</span>:</div>
<ul type="disc"><div style="margin-top:12px"><span style="text-decoration:underline">les formules préétablies sont</span> :<br /> <br /><span style="font-family:Courier New">{{DefinirATCD_Cisp}}     Pour insérer la liste des antécédents avec l'assistant de gestion CISP<br />{{DefinirATCD_Cim10}}    Pour insérer la liste des antécédents avec l'assistant de gestion CIM10<br />{{DefinirATCD_Allergie}} Pour insérer la liste des antécédents avec l'assistant de gestion de allergies<br />{{DefinirATCD_Favoris}}  Pour insérer la liste des antécédents avec l'assistant de gestion des Favoris<br />{{PlacerPathologies}}    Pour insérer la liste des antécédents<br />{{TraitementCourant}}    Pour insérer la liste des prescriptions du traitement courant<br />{{TraitementHabituel}}   Pour insérer la liste des prescriptions du traitement habituel<br />{{InsérerOrdo}}          Pour insérer la liste des prescriptions de l'ordonnance structurée en cours d'affichage<br />{{HeureCourante}}        Pour insérer l'heure courante<br />{{DateCourante}}         Pour insérer la date courante<br />{{DT=expression}}        Pour insérer la date et l'heure courantes.  où <br />                         </span><span style="font-family:Courier New;font-style:italic;font-weight:600">expression</span><span style="font-family:Courier New">   est une chaîne de caractères<br />                         avec la syntaxe suivante : (<a name="format_des_dates"></a>format des dates).</span><br /><br /><a name="Format_des_dates"></a>Format des dates :</div>
<div> <table border=0 cellpadding=4 cellspacing=2 >
<tr><td bgcolor=#a2c511 valign=top>
<p>Expression </p></td><td bgcolor=#a2c511 valign=top>
<p>Résultat </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>d </p></td><td bgcolor=#f0f0f0 valign=top>
<p>le jour sans placer les zéros (1-31) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>dd </p></td><td bgcolor=#8ceadf valign=top>
<p>le jour en plaçant les zéros (01-31) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>ddd </p></td><td bgcolor=#f0f0f0 valign=top>
<p>le jour en mode abrégé (e.g. 'Lun'..'Sam') </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>dddd </p></td><td bgcolor=#8ceadf valign=top>
<p>le jour en mode long (e.g. 'Lundi'..'Mardi'). </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>M </p></td><td bgcolor=#f0f0f0 valign=top>
<p>le mois sans placer les zéros (1-12) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>MM </p></td><td bgcolor=#8ceadf valign=top>
<p>le mois en plaçant les zéros (01-12) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>MMM </p></td><td bgcolor=#f0f0f0 valign=top>
<p>le mois en mode abrégé (e.g. 'Jan'..'Déc'). </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>MMMM </p></td><td bgcolor=#8ceadf valign=top>
<p>le mois en mode long (e.g. 'Janvier'..'Décembre'). </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>yy </p></td><td bgcolor=#f0f0f0 valign=top>
<p>l'année avec deux chiffres (00-99) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>yyyy </p></td><td bgcolor=#8ceadf valign=top>
<p>l'année avec quatre chiffres (1752-8000) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>h </p></td><td bgcolor=#f0f0f0 valign=top>
<p>l'heure sans tenir compte des zéros (0..23 ou 1..12 si AM/PM affiché) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>hh </p></td><td bgcolor=#8ceadf valign=top>
<p>l'heure en tenant compte des zéros (00..23 ou 01..12 si AM/PM affiché) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>m </p></td><td bgcolor=#f0f0f0 valign=top>
<p>Les minutes sans tenir compte des zéros (0..59) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>mm </p></td><td bgcolor=#8ceadf valign=top>
<p>Les minutes en tenant compte des zéros (00..59) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>s </p></td><td bgcolor=#f0f0f0 valign=top>
<p>Les secondes sans tenir compte des zéros (0..59) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>ss </p></td><td bgcolor=#8ceadf valign=top>
<p>Les secondes en tenant compte des zéros (00..59) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>z </p></td><td bgcolor=#f0f0f0 valign=top>
<p>Les milli-secondes sans tenir compte des zéros (0..999) </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>zzz </p></td><td bgcolor=#8ceadf valign=top>
<p>Les milli-secondes en tenant compte des zéros (000..999) </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>AP </p></td><td bgcolor=#f0f0f0 valign=top>
<p>utilise l'affichage AM/PM. AP devra être remplacé soit par &quot;AM&quot; soit par &quot;PM&quot;</p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>ap </p></td><td bgcolor=#8ceadf valign=top>
<p>utilise l'affichage am/pm. AP devra être remplacé soit par &quot;am&quot; soit par &quot;pm&quot;</p></td></tr>
</table>
</div>
<div>Tous les autres caractères sont ignorés.<br />Si vous voulez afficher le caractère h , placez le symbole |</div>
<div> Exemples d'expressions possibles<br /> (suppose que la Date est le 20 Juillet 1969):<br /><br /><br /><table border=0 cellpadding=4 cellspacing=2 >
<tr><td bgcolor=#a2c511 valign=top>
<p>Format </p></td><td bgcolor=#a2c511 valign=top>
<p>Résultat </p></td></tr>
<tr><td bgcolor=#f0f0f0 valign=top>
<p>dd.MM.yyyy </p></td><td bgcolor=#f0f0f0 colspan=1 rowspan=1 valign=top>
<p>20.07.1969 </p></td></tr>
<tr><td bgcolor=#8ceadf valign=top>
<p>ddd MMMM d yy </p></td><td bgcolor=#8ceadf colspan=1 rowspan=1 valign=top>
<p>Sam Juillet 20 69 </p></td></tr>
</table>
</div></ul></ul>
<div style="margin-top:12px"><hr><a name="3.4.3.6  Installer une liste d'options permanente dans le menu déroulant"></a><span style="font-weight:600">3.4.3.6 </span> <span style="text-decoration:underline">Installer une liste d'options permanente dans le menu déroulant :</span></div></ul>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<ul type="disc"><div><span style="font-weight:600">3.4.3.6.1 </span><span style="text-decoration:underline">Accés par le gestionnaire de menus</span> :</div>
<div>Chaque rubrique peut avoir un menu déroulant ne dépendant pas du<br />contexte textuel de l'éditeur de texte. L'option : <br /><span style="font-style:italic;font-weight:600">Placer ce menu...comme menu fixe d'une rubrique</span> <br />permet d'attribuer la liste déroulante au-dessus de laquelle la souris se <br />trouve, comme menu déroulant fixe d'une rubrique à choisir dans la <br />liste d'options présentée par le sous menu.<br /><br /><img src=DrTuxAssitMenuContextSubMenuListe.png ><br /><br /><span style="font-weight:600">3.4.3.6.2 </span><span style="text-decoration:underline">Accés en éditant les fichiers Manager.ini et drtux.ini<br /></span>Dans les fichiers :<br /><br /><span style="font-style:italic;color:#aa0000">MedinTux/drtux/bin/</span><span style="font-style:italic;font-weight:600;color:#aa0000">DrTux.ini</span>                        et <br /><span style="font-style:italic;color:#aa0000">MedinTux/Manager/bin/</span><span style="font-style:italic;font-weight:600;color:#aa0000">Manager.ini</span> <br /><br />vous  trouverez l'entrée ou section suivante : <span style="font-weight:600;color:#005500">[MenuContextuel]</span><br />suivie de diverses mentions ou options.<br /><br /><span style="text-decoration:underline">La règle des menus permanents ou fixes</span> est la suivante : pour toute rubrique '<span style="font-weight:600">RubriqueXXX</span>' il peut exister dans la section <span style="font-weight:600;color:#005500">[MenuContextuel]</span> <br />une entrée du nom de la rubrique, suivi du signe égal, lui-même suivi de la liste permanente correspondant à<br />cette rubrique. Une entrée spéciale <span style="font-weight:600;color:#005500">ListImages </span>concerne le menus dédiés aux images.<br /><br /><span style="font-weight:600;color:#005500">[MenuContextuel]</span></div>
<ul type="disc"><div style="margin-top:12px"><span style="font-weight:600;color:#005500">Observation  = Date SU<br />Prescription  = pendant<br />Documents = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">Identification = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">ListImages = Gestion des images</span></div></ul>
<div style="margin-top:13px">la mention : <span style="font-weight:600;color:#005500">Observation</span><span style="color:#005500"> </span><span style="font-weight:600;color:#005500">=</span>  est suivie de la liste d'options à installer comme options permanentes du menu<br />de la rubrique : <span style="font-weight:600">Observation</span>. Dans l'exemple ci-dessus, les <span style="font-weight:600;text-decoration:underline;color:#aa0000">options de la liste</span>    <span style="font-weight:600;color:#005500">Date SU</span><span style="color:#005500">  </span> seront rajoutées<br />au menu contextuel.<br /><br />la mention : <span style="font-weight:600;color:#005500">Prescription</span><span style="color:#005500"> </span><span style="font-weight:600;color:#005500">=</span>  est suivie de la liste d'options à installer comme options permanentes du menu<br />de la rubrique : <span style="font-weight:600">Prescription</span>. Dans l'exemple ci-dessus, les <span style="font-weight:600;text-decoration:underline;color:#aa0000">options de la liste</span>   <span style="font-weight:600;color:#005500">pendant</span><span style="color:#005500">  </span> seront rajoutées<br />au menu contextuel. <br /><br />la mention : <span style="font-weight:600;color:#005500">Documents</span><span style="color:#005500"> </span><span style="font-weight:600;color:#005500">=</span>  est suivie de la liste d'options à installer comme options permanentes du menu<br />de la rubrique : <span style="font-weight:600">Documents</span>. Dans l'exemple ci-dessus, les <span style="font-weight:600;text-decoration:underline;color:#aa0000">options de la liste</span>   <span style="font-weight:600;color:#005500">Gestion des documents</span><span style="color:#005500">  </span> seront rajoutées<br />au menu contextuel. <br /><br />la mention : <span style="font-weight:600;color:#005500">ListImages =</span><span style="font-weight:600"> </span> est suivie de la liste d'options à installer comme options lors d'un clic droit sur une image,<br />quelle que soit la rubrique. Dans l'exemple ci-dessus, les <span style="font-weight:600;text-decoration:underline;color:#aa0000">options de la liste</span>   <span style="font-weight:600;color:#005500">Gestion des Images </span><span style="color:#005500"> </span> seront rajoutées<br />au menu contextuel. <br /><br /><span style="font-weight:600">3.4.3.6.3 </span><span style="font-weight:600;text-decoration:underline">EXEMPLES</span> :<br /><span style="text-decoration:underline">Option de liste déroulante appelant le numérisateur d'images<br /></span>à placer par exemple dans toutes les listes permanentes.</div>
<ul type="disc"><div><span style="font-weight:600">° Numériser une image.html</span> dont le contenu est<br /><span style="font-size:9pt;font-weight:600">{{:: exe_process (WaitEnd , /usr/bin/kooka) }}</span></div></ul>
<div><span style="text-decoration:underline">Liste déroulante lors d'un clic droit sur une image</span> telle que appelée par la mention : <span style="font-weight:600;color:#005500">ListImages</span><span style="color:#005500"> </span><span style="font-weight:600;color:#005500">= Gestion des images</span><br />Cette liste contient deux options qui permettent d'enregistrer la dernière image visualisée sous le curseur texte et de l'envoyer sur un visualisateur ou éditeur d'images : </div>
<ul type="disc"><div style="margin-top:12px"><span style="font-weight:600">° Editer l'image avec kuickshow.html</span> (visualisateur) dont le contenu est<br /><span style="font-size:9pt;font-weight:600">{{SAVE LAST IMAGE NAME = ../../tmp/ }}\<br />{{:: exe_process (noWaitEnd , /usr/bin/kuickshow ,$ToAbsPath ../../tmp/{{GET LAST IMAGE NAME}}) }}</span><br /><span style="font-weight:600">° Editer l'image avec The Gimp.html</span> (éditeur) dont le contenu est<br /><span style="font-size:9pt;font-weight:600">{{SAVE LAST IMAGE NAME =../../tmp/}}\<br />{{:: exe_process (noWaitEnd , /usr/bin/gimp ,$ToAbsPath ../../tmp/{{GET LAST IMAGE NAME}}) }}</span></div></ul>
<div style="margin-top:12px"><span style="text-decoration:underline">Notez l'instruction d'attente de</span> <span style="font-weight:600">::exe_process</span><span style="font-size:9pt;font-weight:600"> </span></div>
<div>si <span style="font-weight:600">noWaitEnd</span> qui signifie '<span style="font-style:italic">ne pas attendre la fin du plugin</span>' et revient tout de suite dans MedinTux.<br />si <span style="font-weight:600">WaitEnd</span> qui signifie '<span style="font-style:italic"> attendre la fin du plugin</span>' avant de revenir dans MedinTux.<br /><br /><span style="text-decoration:underline">Notez l'instruction de formatage du path de</span> <span style="font-weight:600">::exe_process</span> </div>
<div><span style="font-weight:600">$ToAbsPath</span> considère l'argument qui suit comme un chemin de fichier relatif et le transforme en chemin absolu.</div></ul>
<p><span style="font-style:italic;font-size:9pt">Le gestionnaire de listes déroulantes positionné sur la liste déroulante 'Gestion des images</span>'<br /><img src=GestListeGestionImage-00.png ><br /><br /><hr></p>
<ul type="disc"><div><a name="3.4.3.7   Installer un plugin dans une option du menu déroulant"></a><span style="font-weight:600">3.4.3.7 </span> <span style="text-decoration:underline">Installer un plugin dans une option du menu déroulant :</span></div></ul>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<ul type="disc"><div>Un plugin est un programme pouvant être appelé à partir du menu contextuel des rubriques,<br /><span style="font-weight:600">Observation</span> et <span style="font-weight:600">Prescription</span> de MedinTux. <br />Ce programme reçoit en entrée les éléments du contexte actuel de MedinTux et, en retour, il <br />fournit un texte s'insérant à l'emplacement du curseur texte. Par exemple, on peut imaginer<br />un plugin présentant une image anatomique, sur laquelle un clic souris permettrait de retourner<br />un texte affecté à une zone de l'image.<br /><br />Il faut donc trois conditions :</div>
<ul type="disc"><div>1) <span style="text-decoration:underline">Que le plugin existe et réponde aux conditions d'appel fixées par MedinTux</span><br />Le plugin reçoit sur sa ligne d'arguments plusieurs paramètres décrits ci-après:</div>
<ul type="disc"><div><span style="font-weight:600">argv[0];</span>    // chemin et nom du plugin lui-même<br /><span style="font-weight:600">argv[1];</span>    // chemin d'un éventuel fichier ini ou &quot;****&quot; si absent<br /><span style="font-weight:600">argv[2];</span>    // chemin et nom du programme appelant (parent)<br /><span style="font-weight:600">argv[3];</span>    // chemin et nom du fichier où le résultat doit être retourné<br /><span style="font-weight:600">argv[4];</span>    // GUID identificateur unique du dossier en cours<br /><span style="font-weight:600">argv[5];</span>    // clef primaire de l'observation en cours<br /><span style="font-weight:600">argv[6];</span>    // clef primaire du terrain en cours<br /><span style="font-weight:600">argv[7];</span>    // clef primaire de la prescription en cours<br /><span style="font-weight:600">argv[8];</span>    // réservé pour un usage futur<br /><span style="font-weight:600">argv[9];</span>    // réservé pour un usage futur<br /><span style="font-weight:600">argv[10];</span>   // réservé pour un usage futur<br /><span style="font-weight:600">argv[11];</span>   // réservé pour un usage futur<br /><span style="font-weight:600">argv[12];</span>   // nb (Nombre des paramètres suivants)<br /><span style="font-weight:600">argv[13 + 0];</span>        // 1er paramètre   (12 + 1)    <br />.<br />.<br /><span style="font-weight:600">argv[13 + nb -1 ];</span>   // nème paramètre  (12 + nb)   </div></ul>
<div><br />2) <span style="text-decoration:underline">Que le plugin retourne un texte récupérable par MedinTux</span>.</div>
<ul type="disc"><div>Le plugin doit écrire son résultat dans le fichier indiqué par :<br /><span style="font-weight:600">argv[3];</span>    // chemin et nom du fichier où le résultat doit être retourné</div></ul>
<div><br />3) <span style="text-decoration:underline">Qu'il existe dans le système de menu déroulant un appel au plugin</span>.<br />pour cela placer une option de menu de type item texte avec un texte<br />dont la syntaxe particulière permet l'appel du plugin.<br /><br />l'exemple ci-dessous permet de comprendre la syntaxe à employer pour<br />actionner le plugin. Cet exemple ci permet d'appeler le programme  de lecture<br />des informations de la carte Sesam-Vitale (pour des raisons didactiques<br />certaines portions de l'exemple ont été mises en couleur et gras) : <br /><br /><br /><hr><a name="3.4.3.8___La_Gestion_des_librairies_de_macro"></a><span style="font-weight:600">3.4.3.8 </span> <span style="text-decoration:underline">La Gestion des librairies de macro. :<br /></span><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a><br /><br />Il est désormais possible de se constituer des bibliothèques de macro, et modèles. avec tout ce qu'il faut pour qu'elles fonctionnent. Puis à l'aide du gestionnaire de liste <span style="font-weight:600">en un clic</span> tous les éléments concernant par exemple un test, un score, un modèle avec tous les menus correspondants à ce modèle, seront intégrés à votre menu.<br /><br />Pour accéder au gestionnaire de liste activez l'option de menu comme indiqué ci-dessous.<br /><br /><img src=DrTuxAssitMenuMenuAcces.png ><br />Cela ouvre le dialogue de gestion des listes déroulantes,<br /><br /><img src=DrTuxAssitMenuContextGene.png ><br /><br />dans lequel nous voyons un bouton <img src=DrTuxAssitMenuContextLibButton.png >qui lorsqu'il est cliqué affiche une liste de choix,<br /><br /><img src=DrTuxAssitMenuContextLibListe.png ><br /><br />qui présente les composants disponibles, et vous permet de choisir un composant à installer en double cliquant dessus.<br />Cette bibliothèque de macro. est par défaut positionnée dans le répertoire :<span style="font-weight:600"> Programmes/Librairie de menus</span>.Il est possible de modifier cet emplacement à l'aide du bouton : <img src=Macro-Bibliotheque-LocalisationButton.png >.<br /><span style="font-weight:600">3.4.3.9</span> <a href="./Les Menus deroulants/Les menus deroulants.html">Un tutoriel vaut mieux qu'un long discours</a>. pour comprendre l'organisation d'un composant de bibliothèque et vous permettre d'en fabriquer.</div></ul></ul>
<p><hr><span style="font-weight:600"><br /><a name="4 Description des fonctions en relation avec le langage de scrip"></a></span><span style="font-size:12pt;font-weight:600;text-decoration:underline">4 Description des fonctions en relation avec le langage de script</span><span style="font-size:12pt;font-weight:600"><br /><br /></span>4.1 Exemple avancé d'utilisation du scanner et des menus de MedinTux<br />4.2 Exemple avancé de menu de retouche d'images avec The Gimp et MedinTux<span style="font-weight:600"><br /></span>4.3 Exemple avancé de menu d'OCR (reconnaissance de caractères) avec Xsane Tesseract et MedinTux<br />4.4 Les menus utilisateurs<br />4.5 Le Langage de Script de MedinTux</p>
<p><span style="font-size:12pt"><br /></span><span style="font-weight:600"><br /></span><hr><a name="4.1 Exemple avancé d'utilisation du scanner et des menus de MedinTux"></a><span style="font-size:12pt;font-weight:600">4.1 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Exemple avancé d'utilisation du scanner et des menus de MedinTux :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Nous allons voir dans cet exemple les différentes étapes permettant la mise en oeuvre de <span style="font-weight:600">Xsane </span><br />(programme de scaner sous Linux) directement à partir de MedinTux avec insertion directe de l'image où se trouve le curseur<br />de la souris.<br /><br /><a name="4.1.1  Préalables"></a><span style="font-weight:600">4.1.1 </span><span style="font-weight:600;text-decoration:underline">Préalables</span> :<br /><br />° Il faut, bien sûr, que <span style="font-weight:600">Xsane</span> soit installé.<br />° Il faut aussi que les fichiers <span style="font-weight:600">drtux.ini</span> et <span style="font-weight:600">Manager.ini</span> comportent dans la section :<span style="font-weight:600;color:#005500">[MenuContextuel]</span><br />l'entrée suivante : <span style="font-weight:600;color:#005500">Documents = Gestion des documents</span> désignant la liste déroulante<br /><span style="font-weight:600;color:#005500">Gestion des documents</span> comme liste permanente du menu contextuel de la rubrique '<span style="font-weight:600">Documents</span>'<br /><span style="text-decoration:underline">La règle des menus permanents ou fixes</span> est la suivante : pour toute rubrique '<span style="font-weight:600">RubriqueXXX</span>' il peut exister dans la section <span style="font-weight:600;color:#005500">[MenuContextuel]</span> <br />une entrée du nom de la rubrique , suivi du signe égal, lui même suivi de la liste permanente correspondant à<br />cette rubrique. Une entrée spéciale <span style="font-weight:600;color:#005500">ListImages </span>concerne le menus dédiés aux images.<br /><br /><span style="font-weight:600;color:#005500">[MenuContextuel]</span></p>
<ul type="disc"><div><span style="font-weight:600;color:#005500">Observation  = Date SU<br />Prescription  = pendant<br />Documents = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">Identification = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">ListImages = Gestion des images</span></div></ul>
<p><a name="4.1.2  Définir l'option de menu d'appel de Xsane"></a><span style="font-weight:600">4.1.2 </span><span style="font-weight:600;text-decoration:underline">Définir l'option de menu d'appel de Xsane</span> :<br /><br />L'objectif est d'ajouter à ma liste déroulante permanente : <span style="font-weight:600;color:#005500">Gestion des documents</span> l'option de menu <br />permettant d'appeler et d'accéder à <span style="font-weight:600">Xsane</span>, avec les bons paramètres d'appel.<br />Pour cela, cliquez sur <img src=GestMenuIcone.png >ou touche <span style="font-weight:600">F8</span> pour accéder au gestionnaire de menus déroulants.<br />Sélectionnez le menu permanent : <span style="font-weight:600;color:#005500">Gestion des documents</span> de la rubrique '<span style="font-weight:600">Documents</span>' et,<br />s'il n'y a pas cette liste déroulante créez-la.<br />Ajoutez-y et créez l'option de menu : <span style="font-weight:600">'Numériser et insérer.html</span>'<br />et saisissez pour cette option <span style="text-decoration:underline">sur une ligne</span> le texte suivant (vous pouvez copier coller). <br /><br /><span style="font-size:9pt;font-weight:600">$start_title</span><span style="font-size:9pt;font-weight:600;color:#aa0000">Numérisation avec Xsane</span><span style="font-size:9pt;font-weight:600">$end_title\ <br />{{::Intitule ( Image scannée ) }}\<br />{{::exe_process (WaitEnd ,/usr/bin/xsane,--save,-N$ToAbsPath../../tmp/LastScanned.png)}}\ <br />{{::insert_image (../../tmp/LastScanned.png , 550 , 500, clear_src remove_src,../../ImagesScanner)}} </span><br /><br />Pour des raisons didactiques le texte est présenté ici sur trois lignes, mais il faut qu'il soit sur une ligne<br />sinon tous les retours à la ligne et espaces inutiles seront insérés. <br />Enregistrez <img src=PrintSaveIcn.png >votre magnifique texte.<br /><br /><img src=ScannerMenuTexte.png ><br /><br /><a name="4.1.3  Créer dans la rubrique 'Documents' un document vide pour y insérer une numérisation"></a><span style="font-weight:600">4.1.3 </span><span style="font-weight:600;text-decoration:underline">Créer dans la rubrique 'Documents' un document vide pour y insérer une numérisation</span> :<br /><br />C'est ce document vide qui recevra l'image numérisée.<br />Pour cela, sélectionnez et double cliquez dans le <span style="font-weight:600">Glossaire</span> sur le fichier <span style="font-weight:600">VIDE.html<br /></span><br /><img src=ScannerDocuVide.png ><br /><br /><a name="4.1.4 Actionnez le menu déroulant en cliquant avec le bouton droit de la souris"></a><span style="font-weight:600">4.1.4 </span><span style="font-weight:600;text-decoration:underline">Actionnez le menu déroulant en cliquant avec le bouton droit de la souris</span> :<br /><br />Cliquez sur l'option précédemment définie : <span style="font-weight:600">Numériser et insérer</span><br /><br /><img src=ScannerMenuActive.png ><br /><br /><a name="4.1.5 Numériser l'image dans Xsane"></a><span style="font-weight:600">4.1.5 </span><span style="font-weight:600;text-decoration:underline">Numériser l'image dans Xsane</span> :<br /><br /><span style="font-weight:600">Xsane</span> s'ouvre placez le document à numériser dans le scanner.<br />Sélectionnez l'option : <img src=ScannerXsane-Apercu.png >pour faire apparaître un aperçu de l'ensemble du document.<br />Encadrez dans l'aperçu avec la souris la zone du document que vous désirez numériser.<br />Quand votre cadre vous semble correct, cliquez sur l'option : <img src=ScannerXsane-Numeriser.png >attendez la fin des opérations...<br />Fermez la fenêtre de <span style="font-weight:600">Xsane</span> ou cliquez sur l'option <span style="font-weight:600">Quitter</span> du menu déroulant de la fenêtre de <span style="font-weight:600">Xsane</span>.<br /><br /><img src=ScannerXsane-00.png ><img src=ScannerXsane-01.png ><br /><br /><a name="4.1.6  Résultat de la numérisation dans MedinTux"></a><span style="font-weight:600">4.1.6 </span><span style="font-weight:600;text-decoration:underline">Résultat de la numérisation dans MedinTux</span> :<br /><br /><img src=ScannerDocuPlein.png ><br /><br />Simple non ?</p>
<p><br /><br /><hr><a name="4.2 Exemple avancé de menu de retouche d'images avec The Gimp et MedinTux"></a><span style="font-size:12pt;font-weight:600">4.2 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Exemple avancé de menu de retouche d'images avec The Gimp et MedinTux :</span></p>
<p align="center"><img src=zix-arrow-right.png >Retour au menu principal</p>
<p>Nous allons voir dans cet exemple les différentes étapes permettant la mise en oeuvre de <span style="font-weight:600">The Gimp </span><br />directement à partir de MedinTux avec retouche directe de l'image où se trouve le curseur<br />de la souris et mise à jour automatique de l'image modifiée.<br /><br /><a name="4.2.1  Préalables The Gimp et le Menu d'appel"></a><span style="font-weight:600">4.2.1 </span><span style="font-weight:600;text-decoration:underline">Préalables The Gimp et le Menu d'appel</span> :<br /><br />° Il faut bien sûr que <span style="font-weight:600">The Gimp</span> soit installé.<br />° Il faut aussi que les fichiers <span style="font-weight:600">drtux.ini</span> et <span style="font-weight:600">Manager.ini</span> comportent dans la section :<span style="font-weight:600;color:#005500">[MenuContextuel]</span><br />l'entrée suivante : <span style="font-weight:600;color:#005500">ListDocuments = Gestion des images</span> désignant la liste déroulante<br /><span style="font-weight:600;color:#005500">Gestion des images</span> comme liste permanente du menu contextuel de la rubrique '<span style="font-weight:600">Documents</span>'<br /><br /><span style="font-weight:600;color:#005500">[MenuContextuel]</span></p>
<ul type="disc"><div><span style="font-weight:600;color:#005500">Observation  = Date SU<br />Prescription  = pendant<br />Documents = Gestion des documents<br />Identification = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">ListImages = Gestion des images</span></div></ul>
<p><br /><a name="4.2.2  Définir l'option de menu d'appel de The Gimp"></a><span style="font-weight:600">4.2.2 </span><span style="font-weight:600;text-decoration:underline">Définir l'option de menu d'appel de The Gimp</span> :<br /><br />L'objectif est d'ajouter à ma liste déroulante permanente : <span style="font-weight:600;color:#005500">Gestion des images</span> l'option de menu <br />permettant d'appeler et d'accéder à <span style="font-weight:600">The Gimp</span>, avec les bons paramètres d'appel.<br />Pour cela, cliquez sur <img src=GestMenuIcone.png >ou touche <span style="font-weight:600">F8</span> pour accéder au gestionnaire de menus déroulants.<br />sélectionner le menu permanent : <span style="font-weight:600;color:#005500">Gestion des images</span> de la rubrique '<span style="font-weight:600">Documents</span>' et,<br />s'il n'y a pas cette liste déroulante, créez-la.<br />Ajoutez-y et créez l'option de menu : <span style="font-weight:600">'Modifier l'image avec The Gimp.html</span>'<br />et saisissez pour cette option <span style="text-decoration:underline">sur une ligne</span> le texte suivant (vous pouvez copier coller). <br /><br /><span style="font-size:9pt;font-weight:600">$start_title</span><span style="font-size:9pt;font-weight:600;color:#aa0000">Mofifier l'image avec The Gimp</span><span style="font-size:9pt;font-weight:600">$end_title\<br />{{SAVE LAST IMAGE NAME=../../tmp/}}\<br />{{:: exe_process (WaitEnd , /usr/bin/gimp ,$ToAbsPath ../../tmp/{{GET LAST IMAGE NAME}})}}\<br />{{:: replace_image ({{GET LAST IMAGE NAME}}, ../../tmp/{{GET LAST IMAGE NAME}},-1,-1,keep_src_file_Name remove_src ) }} </span><br /><br />Pour des raisons didactiques, le texte est présenté ici sur trois lignes, mais il faut qu'il soit sur une ligne,<br />sinon tous les retours à la ligne et espaces inutiles seront insérés. <br />Enregistrez <img src=PrintSaveIcn.png >votre magnifique texte.<br /><br /><img src=TheGimpGestionnaireDeListe.png ><br /><br /><a name="4.2.3  Actionnez le menu déroulant en cliquant avec le bouton droit de la souris"></a><span style="font-weight:600">4.2.3 </span><span style="font-weight:600;text-decoration:underline">Actionnez le menu déroulant en cliquant avec le bouton droit de la souris</span> :<br /><br />Cliquez sur l'option précédemment définie '<span style="font-weight:600">Modifier l'image avec The Gimp'</span> avec la souris au dessus de l'image<br />à modifier.<span style="font-weight:600"> </span><br /><br /><img src=TheGimpMenuAppel.png ><br /><br /><a name="4.2.4  Modifier l'image dans The Gimp"></a><span style="font-weight:600">4.2.4 </span><span style="font-weight:600;text-decoration:underline">Modifier l'image dans The Gimp </span>:<br /><br /><span style="font-weight:600">The Gimp</span> s'ouvre et par exemple rajoutez un texte annotant une partie remarquable, ici il <br />s'agit d'une lésion cérébrale hémorragique :<br /><br /><img src=TheGimpEnAction.png ><br /><br />Une fois votre texte et vos modifications apportées, sauvegardez votre travail en <br />cliquant sur l'option <span style="font-weight:600">Enregistrer</span> du menu <span style="font-weight:600">Fichier</span> ou plus simplement en appuyant<br />simultanément sur les touches <span style="font-weight:600">Control</span> et <span style="font-weight:600">S</span><br /><br /><img src=TheGimpSaveModif.png ><br /><br />Si le dialogue suivant s'ouvre cliquez sur l'option <span style="font-weight:600">Exporter</span> ou appuyez<br />plus simplement sur la touche <span style="font-weight:600">Return</span> ou <span style="font-weight:600">Enter</span> de votre clavier :<br /><br /><img src=TheGimpExporter.png ><br /><br />Fermez la fenêtre de <span style="font-weight:600">The Gimp</span> ou cliquez sur l'option <span style="font-weight:600">Quitter</span> du menu déroulant <span style="font-weight:600">Fichier</span> de la fenêtre de <span style="font-weight:600">The Gimp</span>.<br />ou plus simplement en appuyant simultanément sur les touches <span style="font-weight:600">Control</span> et <span style="font-weight:600">Q<br /></span><br /><a name="4.2.5  Résultat des modifications intégrées dans MedinTux"></a><span style="font-weight:600">4.2.5 </span><span style="font-weight:600;text-decoration:underline">Résultat des modifications intégrées dans MedinTux</span> :<br /><br /><img src=TheGimpResultat.png ><br /><br />Simple et efficace non ?</p>
<p><br /><br /><hr><a name="4.3 Exemple avancé de menu d'OCR (reconnaissance de caractères) avec Xsane Tesseract et MedinTux"></a><span style="font-size:12pt;font-weight:600">4.3 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Exemple avancé de menu d'OCR (reconnaissance de caractères) avec Xsane Tesseract et MedinTux :</span></p>
<p align="center"><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p>Nous allons voir dans cet exemple les différentes étapes permettant la mise en oeuvre de <span style="font-weight:600">L'OCR </span>directement à partir de MedinTux. Cet exemple est donné à titre didactique pour que vous puissiez en comprendre le fonctionnement. MedinTux est déjà pré-paramétré et fourni avec tout ce qu'il faut pour que vous n'ayez pas à faire tout ce qui est décrit ci-dessous. Pour juste utiliser le menu allez au paragraphe : <span style="font-weight:600">-C-</span><br /><br /><a name="4.3.1  Préalables d'installations des divers utilitaires nécessaires et le Menu d'appel"></a><span style="font-weight:600">4.3.1 </span><span style="font-weight:600;text-decoration:underline">Préalables d'installations des divers utilitaires nécessaires et le Menu d'appel</span> :<br /><br /><br />° Il faut bien sûr que <span style="font-weight:600">Xsane</span> le logiciel de numérisation d'images soit installé. http://www.xsane.org/<br />paramétrer lors de la première utilisation de <span style="font-weight:600">Xsane</span> l'absence de compression pour les <span style="font-weight:600">images.tif<br /></span>et une <span style="font-weight:600">résolution </span>de numérisation<span style="font-weight:600"> de 400 DPI.<br /></span><br /><img src=OCR_TifParam.png ><br /><br />° Il faut bien sûr que <span style="font-weight:600">Tesseract,</span> le logiciel de reconnaissance de caractères, soit installé. http://code.google.com/p/tesseract-ocr/<br />il faut aussi installer l'adaptateur : <span style="font-weight:600">medintux2tess.sh</span> de <span style="font-weight:600">Tesseract</span> pour <span style="font-weight:600">MedinTux</span> dans le répertoire <span style="font-weight:600">/Plug/OCR/<br /></span><br /><img src=OCR_Wrapper.png ><br /><br />ci dessous le script l'adaptateur <span style="font-weight:600">medintux2tess.sh</span> :<br /><span style="font-weight:600"><br /></span><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff">#!/bin/bash<br />##############################################################################<br /># medintux2tess<br />##############################################################################<br /># medintux2tess is a TesseractOCR wrapper to be able to use tesseract with<br /># xsane and MedinTux</span></p>
<p><span style="font-size:8pt;font-weight:600;color:#00aa00">ERRORLOG</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;medintux2tess.log&quot;</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#5555ff"># file where STDERR goes<br /></span><span style="font-size:8pt;font-weight:600;color:#00aa00">TEMP_DIR</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$4</span></p>
<p><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff">#............... redirect STDOUT to FILE_OUT ................<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">exec</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00007f">1&gt;&gt;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$FILE_OUT</span></p>
<p><span style="font-size:8pt;font-weight:600;color:#5555ff">#</span><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff">............... </span><span style="font-size:8pt;font-weight:600;color:#5555ff">redirect STDERR to ERRORLOG</span><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff"> ............... </span><span style="font-size:8pt;font-weight:600;color:#5555ff"><br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">exec</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00007f">2&gt;&gt;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR$ERRORLOG</span></p>
<p><span style="font-size:8pt;font-weight:600;color:#00aa00">TIF_FILE</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$1<br />TXT_FILE</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$2<br />TES_LANG</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$3<br />FILE_OUT</span><span style="font-size:8pt;font-weight:600">=</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;medintux2tess.out&quot;</span></p>
<p><span style="font-size:8pt;font-weight:600">if [ </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$5</span><span style="font-size:8pt;font-weight:600"> == </span><span style="font-size:8pt;font-weight:600;color:#ff0000">'debug'</span><span style="font-size:8pt;font-weight:600"> ]; </span><span style="font-size:8pt;font-weight:600;color:#aa007f">then<br />echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;=========================================&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot; medintux2tess&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;=========================================&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;------------ arguments-------------------&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$1</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$2</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$3</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$4</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;------------ fichiers--------------------&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;Rep. Temp : &quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;Fichier tif : &quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TIF_FILE</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;Fichier txt : &quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TXT_FILE</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;Langage : &quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TES_LANG</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600;color:#aa007f">echo</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;-----------------------------------------&quot;</span><span style="font-size:8pt;font-weight:600;color:#00007f">&gt;&amp;2<br /></span><span style="font-size:8pt;font-weight:600">fi</span></p>
<p><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff"># ............... converting image into TIFF (ImageMagick) ............... <br /></span><span style="font-size:8pt;font-weight:600">convert -compress none </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TIF_FILE</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot; &quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TIF_FILE</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00007f">1&gt;&amp;2</span></p>
<p><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff">#............... start OCR (tesseract expands output with *.txt) ............... <br /></span><span style="font-size:8pt;font-weight:600">tesseract </span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR$TIF_FILE $TEMP_DIR$TXT_FILE $TES_LANG</span><span style="font-size:8pt;font-weight:600"> </span><span style="font-size:8pt;font-weight:600;color:#00007f">1&gt;&amp;2</span></p>
<p><span style="font-style:italic;font-size:8pt;font-weight:600;color:#5555ff">#............... STDOUT scanned text =&gt; FILE_OUT ............... <br /></span><span style="font-size:8pt;font-weight:600">cat </span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TEMP_DIR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;&quot;</span><span style="font-size:8pt;font-weight:600;color:#00aa00">$TXT_FILE</span><span style="font-size:8pt;font-weight:600;color:#ff0000">&quot;</span><span style="font-size:8pt;font-weight:600">.txt</span><br /><br /><br />° Il faut aussi que <span style="font-weight:600">ImageMagick</span> soit installé.<br />http://www.imagemagick.org/<br /><br />° Il faut aussi que les fichiers <span style="font-weight:600">drtux.ini</span> et <span style="font-weight:600">Manager.ini</span> comportent dans la section :<span style="font-weight:600;color:#005500">[MenuContextuel]</span><br />l'entrée suivante : <span style="font-weight:600;color:#005500">ListDocuments = Gestion des images</span> désignant la liste déroulante<br /><span style="font-weight:600;color:#005500">Gestion des images</span> comme liste permanente du menu contextuel de la rubrique '<span style="font-weight:600">Documents</span>'<br /><br /><span style="font-weight:600;color:#005500">[MenuContextuel]</span></p>
<ul type="disc"><div><span style="font-weight:600;color:#005500">Observation  = Date SU<br />Prescription  = pendant<br />Documents = Gestion des documents<br />Identification = Gestion des documents</span><span style="font-weight:600"><br /></span><span style="font-weight:600;color:#005500">ListImages = Gestion des images</span></div></ul>
<p><a name="4.3.2  Définir l'option de menu d'appel de l'OCR"></a><span style="font-weight:600">4.3.2 </span><span style="font-weight:600;text-decoration:underline">Définir l'option de menu d'appel de l'OCR</span> (MedinTuxScript):<br /><br />L'objectif est d'ajouter à ma liste déroulante pemanente : <span style="font-weight:600;color:#005500">Gestion des images</span> l'option de menu permettant d'appeler et d'accéder aux fonctions<span style="font-weight:600"> de l'OCR</span>, avec les bons paramètres d'appel.<br />Pour cela, cliquez sur <img src=GestMenuIcone.png >ou touche <span style="font-weight:600">F8</span> pour accéder au gestionnaire de menus déroulants.<br />Sélectionner le menu permanent : <span style="font-weight:600;color:#005500">Gestion des images</span> de la rubrique '<span style="font-weight:600">Documents</span>' et,<br />s'il n'y a pas cette liste déroulante, créez-la.<br />Ajoutez-y et créez l'option de menu : <span style="font-weight:600">'</span><span style="font-size:9pt;font-weight:600">Numérisation et OCR avec Xsane et tesseract.html</span>'<br />et saisissez pour cette option le <span style="font-size:9pt;font-weight:600">Script MedinTux</span> suivant (vous pouvez copier coller). <br /><span style="font-size:9pt;font-weight:600"><br />$start_title</span><span style="font-size:9pt;font-weight:600;color:#aa0000">Numérisation et OCR avec Xsane et tesseract</span><span style="font-size:9pt;font-weight:600">$end_title\<br />\<br />{{::delete_file (../../tmp/LastScanned.tif)}}\<br />{{::delete_file (../../tmp/LastScanned.txt, clear)}}\<br />{{::delete_file (../../tmp/medintux2tess.log)}}\<br />{{::exe_process (WaitEnd ,/usr/bin/xsane,--save,-N$ToAbsPath../../tmp/LastScanned.tif)}}\<br />{{::exe_process (WaitEnd,../../Plug/OCR/medintux2tess.sh,LastScanned.tif,LastScanned,-l fra,$ToAbsPath../../tmp$EndToAbsPath/,nodebug)}}\<br />{{::import (../../tmp/LastScanned.txt , insert)}}</span> <br /><br /><span style="text-decoration:underline">Rappel sur la mise en lignes d'un </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Script MedinTux</span> : <br />un <span style="font-style:italic">Script MedinTux</span> est un texte qui comporte des <span style="font-weight:600">instructions</span> situées entre doubles crochets pouvant se trouver dans les documents d'en-tête et de pied de pages, <br /><br />dans les modèles et maquettes du Glossaire, dans les menus déroulants <br />Nous appellerons et désignerons ce bloc de texte par les termes suivants (équivalents) : champs de fusion ou champs d'extraction ou champs d'insertion.<br />Exemple :<span style="font-size:9pt;font-weight:600">{{::Intitule ( Importation Texte OCR ) }}</span>.<br />Ces instructions seront exécutées <br />Tout texte situé en dehors des doubles crochets <span style="font-size:9pt;font-weight:600">{{</span> <span style="font-size:9pt;font-weight:600">}}</span> ou situé en dehors des deux balises <span style="font-size:9pt;font-weight:600">$start_title</span> et <span style="font-size:9pt;font-weight:600">$end_title</span> est ajouté au résultat . <br />Le texte d'un script peut être sur plusieurs lignes, et si vous ne voulez pas que les retours à la ligne du script soient ajoutés lors de l'insertion du texte résultant de la résolution de ce script, il faut les invalider par le caractère <span style="font-weight:600">\ </span><span style="font-size:9pt;font-weight:600">placé en fin de ligne</span><span style="font-size:9pt">.</span><br /><br />Enregistrez <img src=PrintSaveIcn.png >votre magnifique texte de script.<br /><br /><img src=OCR_Script.png ><br /><br /><a name="4.3.3  Actionnez le menu déroulant en cliquant avec le bouton droit de la souris"></a><span style="font-weight:600">4.3.3 </span><span style="font-weight:600;text-decoration:underline">Actionnez le menu déroulant en cliquant avec le bouton droit de la souris</span> :<br /><br />Cliquez sur l'option précédemment définie '<span style="font-size:9pt;font-weight:600">Numérisation et OCR avec Xsane et tesseract</span><span style="font-weight:600">'</span> avec le bouton droit de la souris ou la touche <span style="font-weight:600">F2 </span>au-dessus de la rubrique <span style="font-weight:600">'Documents</span>' .<span style="font-weight:600"> </span><br /><br /><img src=OCR_MenuAppel.png ><br />cela doit faire apparaître la fenêtre suivante ci-dessous.<br /><br /><a name="4.3.4  Numériser l'image, en sélectionnant la zone d'image avec le texte"></a><span style="font-weight:600">4.3.4 </span><span style="font-weight:600;text-decoration:underline">Numériser l'image, en sélectionnant la zone d'image avec le texte </span>:<br /><br /><img src=OCR_XsaneAvantApercu.png ><br />Cliquez sur le bouton <span style="font-weight:600">'Acquisition de l'aperçu'</span> : <img src=OCR_XsaneBoutonApercu.png >afin d'afficher l'aperçu du document dont il faut sélectionner la zone d'image pour laquelle il faut faire une reconnaissance de caractères. <br /><br /><img src=OCR_XsaneSelection.png ><br /><br />Encadrez à l'aide de la souris la zone d'image pour laquelle il faut faire une reconnaissance de caractères et, une fois celle-ci définie, cliquez sur le bouton<span style="font-weight:600"> 'Numériser' </span><img src=OCR_XsaneBoutonNumeriser.png >. Lorsque la numérisation est finie, fermez la fenêtre en cliquant sur la case de fermeture,<br /><br /><img src=OCR_XsaneFermeture.png ><br />et après un petit instant pendant lequel la reconnaissance opère ...<br /><span style="font-weight:600"><br /></span><br /><a name="4.3.5  Résultat de l'OCR (reconnaissance de caractères) intégré dans MedinTux"></a><span style="font-weight:600">4.3.5 </span><span style="font-weight:600;text-decoration:underline">Résultat de l'OCR (reconnaissance de caractères) intégré dans MedinTux</span> :<br /><br />vous aurez la surprise de voir s'insérer à l'emplacement du curseur texte, le résultat de la reconnaissance dont Il vous faudra probablement corriger les approximations et erreurs.<br /><br /><img src=OCR_Resultat.png ><br />Simple et efficace non ?</p>
<p><br /><br /><hr><a name="4.4 Les menus utilisateurs"></a><span style="font-size:12pt;font-weight:600">4.4 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Les menus utilisateurs :<br /></span><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a><br /><br />MedinTux offre la possibilité de créer autant de menus supplémentaires que l'utilisateur le désire. Chaque option du menu permettant d'activer un Script MedinTux qu'il vous est laissé libre de définir. Cela peut être l'appel d'un programme externe ou toute action de votre choix. Ces menus se placent automatiquement dans la barre d'outils de menus. La figure ci-dessous montre (encadrés en rouge) trois options supplémentaires.<br /><br /><img src=user_menu_WhereInDrTux.png ><br /><br />Une option de menu est un répertoire contenant deux fichiers :<br />° une icône,<br />° un script XML très simple devant être appelé : <span style="font-weight:600">definition.txt</span><br /><br />Ce répertoire peut porter un nom quelconque (choisissez tout de même un nom en rapport avec le contenu), et doit être situé dans le répertoire : <span style="font-weight:600">MedinTux/Programmes/drtux/bin/Ressources/Menus</span> de MedinTux.<br /><br /><span style="font-style:italic;font-size:9pt">ci-dessous l'endroit où doivent être placés les menus utilisateurs.</span><br /><img src=user_menu_FileArbo.png ><br /><br />° <span style="text-decoration:underline">Exemple de script XML d'un fichier de définition d'un menu </span><br /><br /><span style="font-size:9pt;font-weight:600">&lt;!DOCTYPE CMenu&gt;&lt;CMenu version=&quot;0.0&quot; stdsetdef=&quot;1&quot;&gt;<br />&lt;actions&gt;<br />&lt;action&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">name</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;cstring&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">OCR avec Xsane et Tesseract</span><span style="font-size:9pt;font-weight:600">&lt;/cstring&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">iconSet</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;iconset&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">ocr.png</span><span style="font-size:9pt;font-weight:600">&lt;/iconset&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">text</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">OCR avec Xsane et Tesseract</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">menuText</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">OCR avec Xsane et Tesseract</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">accel</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">Ctrl+=</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">script</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::delete_file (../../tmp/LastScanned.tif)}}\<br />{{::delete_file (../../tmp/LastScanned.txt, clear)}}\<br />{{::delete_file (../../tmp/medintux2tess.log)}}\<br />{{::exe_process (WaitEnd ,/usr/bin/xsane,--save,-N$ToAbsPath../../tmp/LastScanned.tif)}}\<br />{{::exe_process (WaitEnd,../../Plug/OCR/medintux2tess.sh,LastScanned.tif,LastScanned,-l fra,$ToAbsPath../../tmp$EndToAbsPath/,nodebug)}}\<br />{{::import (../../tmp/LastScanned.txt , new crlf2html)}}</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br />&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">period</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">0</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br />&lt;/action&gt;<br />&lt;/actions&gt;<br />&lt;/CMenu&gt;<br /><br /></span><span style="text-decoration:underline">dans lequel nous pouvons voir</span> <span style="font-size:9pt;font-weight:600">:<br /><br /></span>° le nom de l'option texte à afficher : <span style="font-weight:600;color:#aa0000">OCR avec Xsane et Tesseract </span><br />° le nom de l'icône <span style="font-weight:600;color:#aa0000">ocr.png </span><br />° le raccourci clavier à associer à cette option <span style="font-size:9pt;font-weight:600;color:#aa0000">Ctrl+=</span><span style="font-weight:600;color:#aa0000"> </span><br />° le script que l'option doit actionner </p>
<ul type="disc"><div><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::delete_file (../../tmp/LastScanned.tif)}}\<br />{{::delete_file (../../tmp/LastScanned.txt, clear)}}\<br />{{::delete_file (../../tmp/medintux2tess.log)}}\<br />{{::exe_process (WaitEnd ,/usr/bin/xsane,--save,-N$ToAbsPath../../tmp/LastScanned.tif)}}\<br />{{::exe_process (WaitEnd,../../Plug/OCR/medintux2tess.sh,LastScanned.tif,LastScanned,-l fra,$ToAbsPath../../tmp$EndToAbsPath/,nodebug)}}\<br />{{::import (../../tmp/LastScanned.txt , new crlf2html)}}<br /><br /></span><img src=gnome-warning.png >Si le script commence par la mention<span style="font-size:9pt;font-weight:600;color:#aa0000"> {{EXECUTE_ON_EXIT}}</span> alors le script s'exécutera lorsque une demande de fermeture de MedinTux est demandée.</div></ul>
<p>° la période en millisecondes de déclenchement du script.</p>
<ul type="disc"><div>Si cette valeur est négative, alors le timer de lancement du script ne s'exécutera qu'une fois.<br />Si cette valeur est positive, alors le timer de lancement du script s'exécutera à chaque période écoulée.<br />Si cette valeur est à zéro, le script n'aura pas de timer et ne s'exécutera que lors de l'action sur le menu.<br /><br /><img src=gnome-warning.png >Si après exécution, un script de menu retourne la mention suivante dans son texte :<br /><span style="font-weight:600;color:#aa0000">$setMenuTimer=[</span><span style="font-weight:600;color:#0055ff">1000</span><span style="font-weight:600;color:#aa0000">] </span>alors le Timer sera réinitialisé sur la valeur entre crochets ici 1000 millisecondes : </div>
<ul type="disc"><div>si positive l'action se répètera à chaque période écoulée.<br />si négative l'action s'exécutera qu'une seule fois, après la période écoulée.<br />si zéro le timer sera détruit et l'action non répétée.</div></ul></ul>
<p><img src=bulletcyan01.png ><span style="text-decoration:underline">Créer un menu dont le script se lance au démarrage de MedinTux</span> : pour cela placez la valeur -100 (soit 1/10 ème de seconde) comme période. <br /><span style="font-size:9pt;font-weight:600">&lt;property name=&quot;</span><span style="font-size:9pt;font-weight:600;color:#0000ff">period</span><span style="font-size:9pt;font-weight:600">&quot;&gt;<br />&lt;string&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">-100</span><span style="font-size:9pt;font-weight:600">&lt;/string&gt;<br />&lt;/property&gt;<br /></span>ce qui lancera le script 1 fois après la période de 1/10 ème de seconde<br /><br /><img src=bulletcyan01.png ><span style="text-decoration:underline">Créer un menu dont le script se lance à la fin de MedinTux</span> : <br />pour cela placez la la mention<span style="font-size:9pt;font-weight:600;color:#aa0000"> {{EXECUTE_ON_EXIT}}</span> en début de script. <br /><br /><img src=bulletcyan01.png ><span style="text-decoration:underline">Désactiver une option de menu</span> :<br />Si un répertoire de définition de menu commence par le signe moins alors il ne sera plus évalué et cela désactivera l'option.</p>
<p><br /><hr><a name="4.5 Le Langage de Script de MedinTux"></a><span style="font-size:12pt;font-weight:600">4.5 </span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Le Langage de Script de MedinTux :</span></p>
<p><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a></p>
<p><a name="4.5.1 - Définition"></a><span style="font-weight:600">4.5.1 </span><span style="font-weight:600;text-decoration:underline">Définition</span> :<br /><br />Un <span style="font-style:italic">Script MedinTux</span> est un bloc de texte qui comporte des <span style="font-weight:600">instructions</span> situées entre deux doubles crochets, exemple :<span style="font-size:9pt;font-weight:600">{{::Intitule ( Importation Texte OCR ) }}</span><span style="font-size:9pt"> </span>qui seront exécutées ou résolues et remplacées par le texte résultant de leur exécution. Si le texte résultant est vide alors l'instruction sera effacée ne modifiant pas alors le texte où elle est insérée.<br />Ces scripts servent à effectuer toutes sortes d'opérations, comme produire des documents automatisés ou des menus intelligents.<br />Les scripts de MedinTux sont un vrai <span style="font-weight:600">langage de Macros</span>, et permettent à l'utilisateur d'inventer les fonctions dont il a besoin et qui ne sont pas présentes dans le programme.<br />Nous appellerons et désignerons ces blocs de texte par les termes suivants (équivalents) : </p>
<ul type="disc"><div><span style="font-weight:600">instructions</span> ou <br /><span style="font-weight:600">champs de fusion</span> ou <br /><span style="font-weight:600">champs d'extraction</span> ou <br /><span style="font-weight:600">champs d'insertion</span></div></ul>
<p><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Les </span><span style="font-style:italic;text-decoration:underline">Script MedinTux</span><span style="text-decoration:underline"> sont récursifs,</span> ce qui signifie qu'il est possible d'imbriquer plusieurs <span style="font-weight:600">champs de fusion</span>, les instructions les plus imbriquées seront résolues avant les autres.<br />Dans l'exemple suivant :<br /><br /><span style="font-size:9pt;font-weight:600">$start_title</span><span style="font-size:9pt;font-weight:600;color:#aa0000">Modifier l'image avec The Gimp</span><span style="font-size:9pt;font-weight:600">$end_title\<br />{{SAVE LAST IMAGE NAME=../../tmp/}}\<br />{{:: exe_process (WaitEnd , /usr/bin/gimp ,$ToAbsPath ../../tmp/</span><span style="font-size:9pt;font-weight:600;color:#005500">{{GET LAST IMAGE NAME}}</span><span style="font-size:9pt;font-weight:600">)}}\<br />{{:: replace_image (</span><span style="font-size:9pt;font-weight:600;color:#005500">{{GET LAST IMAGE NAME}}</span><span style="font-size:9pt;font-weight:600">, ../../tmp/</span><span style="font-size:9pt;font-weight:600;color:#005500">{{GET LAST IMAGE NAME}}</span><span style="font-size:9pt;font-weight:600">,-1,-1,keep_src_file_Name remove_src ) }}<br /><br /></span>Le champ de fusion <span style="font-size:9pt;font-weight:600">{{GET LAST IMAGE NAME}}</span><span style="font-size:9pt"> </span>sera résolu avant les autres, et remplacé par le nom de la dernière image enregistrée.<br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Les </span><span style="font-style:italic;text-decoration:underline">Script MedinTux</span><span style="text-decoration:underline"> sont orientés texte</span> tout le texte situé en dehors des doubles crochets <span style="font-size:9pt;font-weight:600">{{</span> <span style="font-size:9pt;font-weight:600">}}</span> ou situé en dehors des deux balises <span style="font-size:9pt;font-weight:600">$start_title</span> et <span style="font-size:9pt;font-weight:600">$end_title</span> est conservé et sera ajouté au résultat final y compris les retours à la ligne (la partie située entre <span style="font-size:9pt;font-weight:600">$start_title</span> et <span style="font-size:9pt;font-weight:600">$end_title </span><span style="font-size:9pt">sera affichée comme infobulle)</span>.<br /><span style="text-decoration:underline">Exemple</span> :<br /><span style="font-weight:600">Nom :</span> {{NOM PRENOM PATIENT}} <span style="font-weight:600">Sexe: </span>{{SEXE PATIENT}}<br /><span style="font-weight:600">Né(e) :</span> {{DATE NAISSANCE PATIENT}} <span style="font-weight:600">Age :</span> {{AGE PATIENT ABREGE}} ans<br /><br />pourra ressembler à cela après résolution ou exécution des macros.<br /><br /><span style="font-weight:600">Nom :</span> TARTEMPION MARCEL <span style="font-weight:600">Sexe:</span> Masculin<br /><span style="font-weight:600">Né(e) :</span> 01-01-2001 <span style="font-weight:600">Age :</span> 7 ans<br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Invalidation des fins de lignes</span> Si le caractère <span style="font-size:9pt;font-weight:600">\</span><span style="font-weight:600"> est placé en fin de ligne</span>, le retour chariot suivant cette ligne sera ignoré. Cela permet d'écrire sur plusieurs lignes un script long pour lequel l'on ne veut pas insérer de retours à la ligne.<br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Caractère d'échappement</span> Si le caractère <span style="font-size:9pt;font-weight:600">\</span><span style="font-weight:600"> est placé avant un caractère</span>, exemple <span style="font-weight:600">\(, </span>le caractère le suivant sera interprété comme un caractère de texte et non comme un caractère de structure d'instruction. Dans notre exemple, la parenthèse ouvrante ne sera pas interprétée comme un début de liste de paramètres de fonction.<br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Les </span><span style="font-style:italic;text-decoration:underline">Script MedinTux</span><span style="text-decoration:underline"> peuvent comporter des variables</span> <br />Les instructions de manipulation de variables sont : <br />          - <span style="font-weight:600">Affectation d'une variable</span> : <span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: SET_VAR ( NomDeLaVairiable, ValeurAPlacerDansLaVariable ) }}<br /></span><br />          - <span style="font-weight:600">Lecture d'une variable</span> : la macro suivante <span style="font-size:9pt;font-weight:600;color:#aa0000">{{VAR=NomDeLaVariable}}</span> sera remplacée par le <br />            contenu de la variable dont le nom est situé après le signe <span style="font-weight:600;color:#aa0000">=</span> .<br />             <span style="font-family:Luxi Mono;font-size:8pt"><br /><a name="4.5.1.1  Affectation directe du résultat d'une macro dans une variable"></a></span><span style="font-weight:600">4.5.1.1 <a name="Affectation_directe_du_resultat_d'une_macro_dans_une_variable"></a></span><span style="font-weight:600;text-decoration:underline">Affectation directe du résultat d'une macro dans une variable</span> :<span style="font-family:Luxi Mono;font-size:8pt"><br />        Cette nouvelle possibilité augmente considérablement la performance du langage de macro.<br />        Pour que le résultat d'une macro soit directement affecté à une variable, il suffit de placer <br />        après la parenthèse fermante de la macro le symbole '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">&gt;</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600">'</span><span style="font-family:Luxi Mono;font-size:8pt"> ou '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">-</span><span style="font-family:Luxi Mono;font-size:8pt">' suivi du nom de la variable devant être<br />        affectée par le résultat. Si cette variable n'existe pas elle sera créée. <br />        Si le symbole '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">-</span><span style="font-family:Luxi Mono;font-size:8pt">' est utilisé, alors les espaces de début et de fin du contenu de la variable seront<br />        nettoyés. <br />        Il ne doit </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;text-decoration:underline">pas y avoir d'espaces</span><span style="font-family:Luxi Mono;font-size:8pt"> entre la parenthèse fermante </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">)</span><span style="font-family:Luxi Mono;font-size:8pt"> le symbole '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">-</span><span style="font-family:Luxi Mono;font-size:8pt">' ou '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">&gt;</span><span style="font-family:Luxi Mono;font-size:8pt">' le<br />        nom de la variable et le symbole '</span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">}</span><span style="font-family:Luxi Mono;font-size:8pt">'<br />        </span><span style="font-family:Luxi Mono;font-style:italic;font-size:8pt;text-decoration:underline">Exemple</span><span style="font-family:Luxi Mono;font-size:8pt"> : <br />        </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">{{:: DATE_TONUM ( 12-12-1990 08:30:45 , S , 12-12-1990 08:30:00 )&gt;MaVariable}} </span><span style="font-family:Luxi Mono;font-size:8pt"><br />        Le résultat (45) de la macro </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">DATE_TONUM (...)</span><span style="font-family:Luxi Mono;font-size:8pt"> sera directement placé dans la variable </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">MaVariable</span><span style="font-family:Luxi Mono;font-size:8pt">.<br /><br />        Ancienne façon beaucoup moins concise et moins performante d'arriver au même résultat :<br />        </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">{{:: SET_VAR ( MaVariable, {{:: DATE_TONUM ( 12-12-1990 08:30:45 , S , 12-12-1990 08:30:00 )}} )}}<br /></span><br /><a name="4.5.1.2  Passage de valeurs aux fonctions par référence à une variable"></a><span style="font-weight:600">4.5.1.2 </span><span style="font-weight:600;text-decoration:underline">Passage de valeurs aux fonctions par référence à une variable</span> :<span style="font-family:Luxi Mono;font-size:8pt"><br />        Si le paramètre d'une macro commençe par le </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$</span><span style="font-family:Luxi Mono;font-size:8pt"> exemple </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$MaVariable</span><span style="font-family:Luxi Mono;font-size:8pt"> c'est alors<br />        </span><span style="font-family:Luxi Mono;font-size:8pt;text-decoration:underline">le contenu de la variable</span><span style="font-family:Luxi Mono;font-size:8pt"> </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">MaVariable</span><span style="font-family:Luxi Mono;font-size:8pt"> indiquée après le symbole </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$</span><span style="font-family:Luxi Mono;font-size:8pt"> qui sera transmis comme<br />        paramètre d'appel et non simplement le texte du paramètre. Ceci est équivalent à </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">{{VAR=MaVariable}}</span><span style="font-family:Luxi Mono;font-size:8pt"><br />        mais beaucoup plus rapide en éxécution, fiable et plus simple à écrire dans un script.<br />        Ne pas utiliser comme nom de variable les mots clefs réservés suivants :<br />        </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$END_WIDTH $File $Paste $WIDTH $allString $toInt $stopIfNotNum $IsAbsPath<br />        $IsBinPath $NoAddExe $toStdIn $NomPatient $PrenomPatient $DateDeb $DateFin<br />        $DateDebFiche $DateFinFiche $HeureDeb $HeureFin $NomRub $TitreRub $User<br />        $SignUser $NumFicheRub $GUIDPat $PkPat $pkFiche $Duree $NumFicheTot $Selection<br />        $VAR $SET_VAR $no key $TableName $USER_PARAM $TOEND $keepHtml<br /></span><br /><a name="4.5.2 Où se situent et se cachent les Scripts MedinTux ? dans"></a><span style="font-weight:600">4.5.2 </span><span style="font-weight:600;text-decoration:underline">Où se situent et se cachent les Scripts MedinTux ? dans</span> :<br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Les en-têtes et de pieds de pages d'impression</span> accessibles par le gestionnaire d'utilisateurs <span style="font-weight:600">gest_user</span>, les instructions contenues dans ces documents sont résolues lors de l'incorporation des en-têtes et de pieds de pages au cours d'une impression. <br /><br />             <img src=gnome-warning.png ><span style="font-weight:600;text-decoration:underline">VARIABLES ET MENTIONS PARTICULIERES</span> : </p>
<ul type="disc"><li><span style="font-size:9pt">Si lors d'une résolution ou exécution de script ou de macro, le texte généré, contient la mention </span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#aa0000">$PRINT_STOP</span><span style="font-size:9pt"> alors l'impression du document sera interrompue.</span> </li>
<li><span style="font-size:9pt">Lors de la résolution et exécution d'un script la variable</span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#aa0000"> $SCRIPT_STATUS</span><span style="font-size:9pt"> accessible dans un script avec </span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#aa0000">{{VAR=$SCRIPT_STATUS}}</span><span style="font-size:9pt"> peut prendre les valeurs suivantes : <br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#00aa00">nom de la rubrique</span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">_$FUSION_ADD_Tout</span><span style="font-size:9pt"> lors du remplacement d'un document déjà existant d'une rubrique de MedinTux par un modèle ou document-type du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#00aa00">nom de la rubrique</span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">_$FUSION_ADD_Ajouter</span><span style="font-size:9pt"> lors de l'ajout à un document déjà existant d'une rubrique de MedinTux, d'un modèle ou document-type du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#00aa00">nom de la rubrique</span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">_$FUSION_CREATE</span><span style="font-size:9pt"> lors de la création d'un nouveau document d'une rubrique de MedinTux à partir d'un modèle ou document-type du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#00aa00">nom de la rubrique</span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">_$FUSION_END</span><span style="font-size:9pt;font-weight:600;color:#0000ff"> </span><span style="font-size:9pt">lorsque l'exécution d'une macro ou script a été opéré est est terminé (vous ne devriez pas avoir à vous en servir).<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#00aa00">nom de la rubrique</span><span style="font-size:9pt"> peut prendre les valeurs suivantes selon la rubrique dans laquelle st exécutée la macro :<br />Observation, Prescription, Documents, Identification.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">$PREVISUALISATION</span><span style="font-size:9pt"> lorsque l'exécution d'une macro ou script est en train de se faire dans le cadre de la fenêtre de prévisualisation du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">$PREVISUALISATION_END</span><span style="font-size:9pt"> lorsque l'exécution d'une macro ou script vient de se terminer dans le cadre de la fenêtre de prévisualisation du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">$PRINT_SCRIPT_BEFORE</span><span style="font-size:9pt"> Lorsque lors d'une impression aucune exécution de script d'en-tête et de pied de page n'a encore été réalisée cette valeur est retournée (script exécuté la première fois)</span><span style="font-size:9pt;font-weight:600;color:#aa0000">. </span><span style="font-size:9pt"><br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">$PRINT_HEADER_CHANGED</span><span style="font-size:9pt"> Cette valeur est positionnée si dans le dialogue d'impression le modèle d'impression a été changé, et que l'éventuel script de l'en-tête et du pied de page de ce modèle va être exécuté.<br /></span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#0000ff">$PRINT_SCRIPT_END</span><span style="font-size:9pt;font-weight:600;color:#0000ff"> </span><span style="font-size:9pt">Cette valeur est positionnée après la résolution et exécution lors d'une impression d'un script de l'en-tête et du pied de page.</span></li></ul>
<p><span style="font-family:Comic Sans Ms"><br /><img src=SCRIPT_WhereGestUser.png ><br /><br /><br /><img src=PetitCarreOrange.png ></span><span style="text-decoration:underline">Les modèles de documents types ou maquettes</span> du <span style="font-weight:600">Glossaire.<br /></span>les instructions contenues dans ces documents sont résolues lors de l'incorporation du document<br />dans une rubrique de MedinTux.<br /><br /><img src=SCRIPT_WhereGlossaire.png ><br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Le système de Menus déroulants de MedinTux</span> accessible par le bouton <img src=ToolGestList_Item.png >dans le gestionnaire de dossier médical <span style="font-weight:600">drtux</span>.<br />Les instructions contenues dans ces documents sont résolues lors de l'incorporation dans un document après exécution de l'option de menu correspondant au script.<br /><br /><img src=OCR_Script.png ><br /><br /><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Le système de Menus utilisateur de la barre de menu de MedinTux</span> (options encadrées en rouge)<br /><br /><img src=user_menu_WhereInDrTux.png ><br />Ces instructions seront exécutées et résolues lors du clic sur une des options.<br />Les fichiers de configuration se trouvent dans <span style="font-weight:600">drtux/bin/Ressources/Menus</span></p>
<p><br /><a name="Le_menu_d'entrée"></a><img src=PetitCarreOrange.png ><span style="text-decoration:underline">Le menu d'entrée</span> (actionné lors du démarrage du programme <span style="font-weight:600">après le chargement des documents</span>) est un script, programmable comme les autres. Cela permet d'ajouter de nombreuses fonctions intelligentes à effectuer lors du démarrage du programme, comme :</p>
<ul type="disc"><div>Positionnement de variables par extraction de données dans des fiches<br />lancement de programmes tiers<br />positionnement de diverses valeurs<br />informations personnalisées dans la zone d'affichage<br />etc.</div></ul>
<p>Il se situe dans <span style="font-weight:600">drtux/bin/Ressources/Macro de debut</span>. Si ce répertoire n'existe pas, il n'y aura pas de menu d'entrée.<br />(par exemple pour le désactiver, renommer le répertoire <span style="font-weight:600">Macro de debut</span> en <span style="font-weight:600">Macro de debut_0</span>)<br /><br /><img src=PetitCarreOrange.png ><a name="Le_menu_de_sortie"></a><span style="text-decoration:underline">Le menu de sortie</span> (actionné par toute action de sortie du programme, comme Alt+F4, Fichier-&gt; Quitter, etc.) est un script, programmable comme les autres. Cela permet d'ajouter de nombreuses fonctions intelligentes à la sortie du programme, comme :</p>
<ul type="disc"><div>vérification du contenu des observations<br />lancement de la comptabilité<br />envoi d'une copie de l'observation par mail à l'utilisateur<br />informations personnalisées dans la zone d'affichage<br />etc.</div></ul>
<p><br /><img src=macro_de_sortie.png ><br />Il se situe dans <span style="font-weight:600">drtux/bin/Ressources/Macro de sortie</span>. Si ce répertoire n'existe pas, il n'y aura pas de menu de sortie.<br />(par exemple, pour le désactiver, renommer le répertoire <span style="font-weight:600">Macro de sortie</span> en <span style="font-weight:600">Macro de sortie_0</span>)<br /><br /><br /><hr><a name="4.5.3 Inventaire des instructions"></a><span style="font-weight:600">4.5.3 </span><span style="font-weight:600;text-decoration:underline">Inventaire des instructions</span><span style="font-weight:600"> </span>:<br /><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a><br /><br /><span style="font-size:9pt;font-weight:600;text-decoration:underline">NOTE</span><span style="font-size:9pt"> : toutes les instructions commençant par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::</span><span style="font-size:9pt"> sont épurées, et les attributs </span><span style="font-size:9pt;font-weight:600">html</span><span style="font-size:9pt"> de styles sont retirés.<br />Si elles contiennent juste après les doubles deux points le caractère </span><span style="font-size:9pt;font-weight:600;color:#aa0000">#</span><span style="font-size:9pt"> comme ci après :<br /><br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::# Extract_ATCD ( <br /></span><span style="font-size:9pt">                                                                             </span><span style="font-size:9pt;font-weight:600;color:#0000ff">&lt;b&gt;&lt;u&gt;° ::TYPE:: :&lt;/u&gt;&lt;/b&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                             </span><span style="font-size:9pt;font-weight:600;color:#ff0000">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::LIBELLE:: ::MEDCHIR:: ::ETAT:: ::CODE:: ::NOTE:: ::DATE:: ::ALD::</span><span style="font-size:9pt;font-weight:600;color:#0000ff"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                             </span><span style="font-size:9pt;font-weight:600;color:#ff007f">en date du :,</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\</span><span style="font-size:9pt;font-weight:600;color:#ff007f"><br />en rapport avec une pathologie ALD</span><span style="font-size:9pt;font-weight:600;color:#aa0000">) }}</span><span style="font-size:9pt"> <br /><br />il ne sera pas opéré d'épurage du code </span><span style="font-size:9pt;font-weight:600">html</span><span style="font-size:9pt"> afin de conserver les </span><span style="font-size:9pt;font-weight:600">attributs html</span><span style="font-size:9pt"> pouvant <br />être nécessaires à la mise en page comme dans l'instruction montrée en exemple <br />le paramètre : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">&lt;b&gt;&lt;u&gt;° ::TYPE:: :&lt;/u&gt;&lt;/b&gt;</span><span style="font-size:9pt"> <br />comporte des attributs de mise en gras : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">&lt;b&gt;&lt;/b&gt; </span><span style="font-size:9pt">et souligné </span><span style="font-size:9pt;font-weight:600;color:#0000ff">&lt;u&gt; &lt;/u&gt;</span><span style="font-size:9pt"> <br />servant à positionner le style des titres des antécédents.<br /><br /><br /></span><span style="font-size:9pt;text-decoration:underline"><br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.1</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract (Observation | Fiche initiale, après , avant , tester , mettre, mode de conversion numérique)}} </span><span style="font-size:9pt;text-decoration:underline"><br /><br /></span><span style="font-size:9pt">Ces instructions ont pour objectif d'aller récupérer et mettre en <br />forme des données appartenant à une rubrique.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (rubrique) :<br />    Le premier paramètre est la rubrique où aller chercher les données.<br />    le paramètre rubrique peut être :<br />    </span><span style="font-size:9pt;font-weight:600">Observation</span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600">Prescription</span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600">Ordonnance</span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600">Ordonnance Vidal </span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600">Certificat </span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600">Courrier <br />  </span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600">vide</span><span style="font-size:9pt"> auquel cas c'est dans la rubrique courante où seront extraites les données.<br />    Un paramètre vide est composé d'espaces uniquement comme dans l'exemple en rouge : </span><span style="font-style:italic;font-size:9pt">{{:: Extract </span><span style="font-style:italic;font-size:9pt;color:#ff0000">(</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#ff0000"> ,</span><span style="font-style:italic;font-size:9pt;color:#ff0000"> </span><span style="font-style:italic;font-size:9pt">apres , avant , tester , mettre )}}</span><span style="font-size:9pt"> </span><span style="font-style:italic;font-size:9pt"> </span></p>
<ul type="disc"><div><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANTE SUBTILITE</span><span style="font-size:9pt;font-weight:600"> : à la suite de ce paramètre vous pouvez indiquer séparé par le caractère '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">|</span><span style="font-size:9pt;font-weight:600">' le titre précis d'un document dans lequel l'extraction doit se faire.<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract (Observation | </span><span style="font-size:9pt;font-weight:600;text-decoration:underline;color:#aa0000">Fiche initiale</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> , après , avant , tester , mettre )}} </span><span style="font-size:9pt">   </span><span style="font-style:italic;font-size:9pt"> </span><span style="font-size:9pt"> </span><span style="font-style:italic;font-size:9pt"> <br /></span><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANTE SUBTILITE</span><span style="font-size:9pt;font-weight:600"> : Si le premier paramètre commence par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$VAR</span><span style="font-size:9pt;font-weight:600"> suivi du signe '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">=</span><span style="font-size:9pt;font-weight:600">' lui même suivi du nom d'une variable, c'est le contenu de la variable dont le nom est indiqué après le caractère '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">=</span><span style="font-size:9pt;font-weight:600">' qui sera évalué.<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract ($VAR = MaVariable, après , avant , tester , mettre )}} </span><span style="font-size:9pt">   </span><span style="font-style:italic;font-size:9pt"> </span><span style="font-size:9pt"> </span><span style="font-style:italic;font-size:9pt"> <br /></span><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANTE SUBTILITE</span><span style="font-size:9pt;font-weight:600"> : Si le premier paramètre commence par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$USER_PARAM</span><span style="font-size:9pt;font-weight:600"> suivi du signe '=' lui même suivi du nom d'un utilisateur de MedinTux la syntaxe est la suivante<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract ($USER_PARAM = Admin , Vigie , Montrer )}} </span><span style="font-size:9pt">   </span><span style="font-style:italic;font-size:9pt"> extrait la valeur de la variable </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Montrer</span><span style="font-style:italic;font-size:9pt"> de la section </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Vigie</span><span style="font-style:italic;font-size:9pt"> du fichier de paramétrage lié à l'utilisateur </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Admin</span><span style="font-style:italic;font-size:9pt"> comme visible ci-dessous.<br />Cela permet par exemple de stocker des paramètres utilisateurs supplémentaires de votre choix pour des usages de votre choix , et de les retrouver. Exemple un code numérique lié à un utilisateur ou tout autre élément de votre choix.<br /><br /><br /></span><img src=ExtractUserParam.png ><span style="font-style:italic;font-size:9pt"><br /></span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (délimiteur d'extraction de début) :<br />Terme après lequel la donnée doit être extraite.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (délimiteur d'extraction de fin) :<br />Terme avant lequel la donnée doit être extraite. <br />Si ce terme est egal à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">FinDeLigne</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#aa0000">EOL </span><span style="font-size:9pt">alors l'extraction se fera jusqu'à la fin de ligne.<br />Si ce terme est egal à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$ToEnd</span><span style="font-size:9pt"> alors l'extraction se fera jusqu'à la fin du document.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (facultatif opérateur de comparaison) :<br />Terme avec lequel doit être comparé le texte extrait. <br />La comparaison est dite vraie si le terme est contenu dans le texte extrait.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (facultatif terme de remplacement) :<br />Résultat à placer à la place du texte extrait si la comparaison est vraie.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (facultatif terme de remplacement) :<br />Résultat à placer à la place du texte extrait si la comparaison est vraie.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (modificateur de conversion et extraction ) facultatif et par défaut si non positionné ou absent il n'en sera pas tenu compte.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$stopIfNotNum</span><span style="font-size:9pt"> la conversion numérique s'arrête au premier caractère non numérique.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$allString</span><span style="font-size:9pt"> tous les caractères numériques de la chaîne seront retenus.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$toInt</span><span style="font-size:9pt"> la conversion numérique ne conservera que la partie entière.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$keepHtml</span><span style="font-size:9pt"> l'extraction conservera les attributs </span><span style="font-size:9pt;font-weight:600">html</span><span style="font-size:9pt">.<br /> SI    toute autre valeur, la conversion s'arrêtera à la première occurrence de cette valeur.<br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemples concernant le mode de conversion voir la macro : </span><a href="DrTux.html#4.5.3.127_|=="><span style="font-style:italic;font-size:9pt;font-weight:600">TO_NUM</span></a><span style="font-style:italic;font-size:9pt"> : <br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Exemple pour mieux comprendre </span><span style="font-size:9pt;font-weight:600">:</span><span style="font-size:9pt"> <br />Installation d'une automatisation de la mention </span><span style="font-size:9pt;font-weight:600">AT</span><span style="font-size:9pt"> lors de l'impression d'une ordonnance .<br /><br />Placez le texte suivant ,<br /><br /></span><span style="font-size:9pt;font-weight:600;color:#0000ff">Circonstances</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;text-decoration:underline;color:#0000ff">Heure d'Arrivée SU</span><span style="font-size:9pt">:   {{DT=hh|mm}}  <br /><br />dans tous </span><span style="font-size:9pt;font-weight:600">vos modèles de documents d'observations</span><span style="font-size:9pt"> et est donc il sera présent dans toutes vos observations.<br />À la droite du terme : '</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Circonstances</span><span style="font-size:9pt"> :' un menu permet de saisir entre autres choix, le texte suivant : '</span><span style="font-size:9pt;font-weight:600;color:#0000ff">AT</span><span style="font-size:9pt;font-weight:600"> (sur les lieux du travail)'</span><span style="font-size:9pt"> ce qui donne après sélection de l'option, le texte suivant :<br /><br /></span><span style="font-size:9pt;font-weight:600;color:#0000ff">Circonstances</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">AT</span><span style="font-size:9pt;font-weight:600"> (sur les lieux du travail)</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline;color:#0000ff">Heure d'Arrivée SU</span><span style="font-size:9pt">:   08h30 <br /><br /><br />S</span><span style="font-style:italic;font-size:9pt">élection de l'option </span><span style="font-size:9pt;font-weight:600;color:#0000ff">AT</span><span style="font-size:9pt;font-weight:600"> (sur les lieux du travail)</span><span style="font-style:italic;font-size:9pt"> du menu déroulant d'une observation.</span><span style="font-size:9pt"><br /><img src=Script_AT.png ><br /><br /></span><span style="font-size:9pt;font-weight:600">L'en-tête des ordonnances</span><span style="font-size:9pt"> contient le champ d'extraction suivant :<br /><br /> </span><span style="font-size:9pt;font-weight:600">{{:: Extract (Observation , Circonstances : , Heure d'Arrivée SU: , AT ,AT )}}</span><span style="font-size:9pt"><br /><br />que va-t-il se passer ?<br />Lors de l'impression d'une ordonnance, son en-tête va être utilisé avec le champ d'extraction ci-dessus, et il va être extrait de l'observation en cours, la portion de texte située entre le terme délimiteur d'extraction de début </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Circonstances</span><span style="font-size:9pt"> : et le terme délimiteur d'extraction de fin </span><span style="font-size:9pt;font-weight:600;text-decoration:underline;color:#0000ff">Heure d'Arrivée SU</span><span style="font-size:9pt">: soit le texte suivant : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">AT</span><span style="font-size:9pt;font-weight:600"> (sur les lieux du travail)</span><span style="font-size:9pt"> comme l'imposent les paramètres N° 1 et le N°2.<br />il sera vérifié dans le texte extrait </span><span style="font-size:9pt;font-weight:600;color:#0000ff">AT</span><span style="font-size:9pt;font-weight:600"> (sur les lieux du travail)</span><span style="font-size:9pt"> si la mention AT y est présente comme l'impose le paramètre N° 3 et si c'est le cas, le paramètre N°4 : </span><span style="font-size:9pt;font-weight:600">AT </span><span style="font-size:9pt">remplacera  </span><span style="font-size:9pt;font-weight:600">{{:: Extract (Observation , Circonstances : , Heure d'Arrivée SU: , AT ,AT )}}</span><span style="font-size:9pt"> dans le texte de l'en-tête. <br />Cela aboutit à une automatisation de l'inscription de la mention </span><span style="font-size:9pt;font-weight:600">AT</span><span style="font-size:9pt"> sur les ordonnances.<br /><br />De même, il est possible d'imaginer un courrier automatisé qui va extraire des documents, des données situées entres deux titres balises constants sur vos modèles, séparant des zones clefs de vos observations.</span></div></ul>
<p><span style="font-size:9pt"><br /><br /><hr><a name="4.5.3.1.2 -------------------  {{,, Extract_ATCD"></a></span><span style="font-size:9pt;font-weight:600">4.5.3.2</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::# Extract_ATCD ( </span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#0000ff">&lt;b&gt;&lt;u&gt;° ::TYPE:: :&lt;/u&gt;&lt;/b&gt;</span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                       </span><span style="font-size:9pt;font-weight:600;color:#ff0000">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::LIBELLE:: ::MEDCHIR:: ::ETAT:: ::CODE:: ::NOTE:: ::DATE:: ::ALD::</span><span style="font-size:9pt;font-weight:600;color:#0000ff"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                       </span><span style="font-size:9pt;font-weight:600;color:#ff007f">en date du :,</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\</span><span style="font-size:9pt;font-weight:600;color:#ff007f"><br />en rapport avec une pathologie ALD</span><span style="font-size:9pt;font-weight:600;color:#aa0000">) }}</span><span style="font-size:9pt"> <br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /><br /></span><span style="font-size:9pt">Cette instruction a pour objectif de mettre en forme les données appartenant aux antécédents de la rubrique terrain de façon à inclure les antécédents d'un patient dans vos documents. <br />la liste sera classée et triée selon les familles positionées lors de la définition de l'antécédent.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (titre de la liste des antécédents médicaux) :<br />   Inscrivez dans ce paramètre le motif HTML devant servir de titre aux antécédents médicaux.<br />   </span><span style="font-style:italic;font-size:9pt">Exemple : </span><span style="font-style:italic;font-size:9pt;font-weight:600">&lt;b&gt;&lt;u&gt;::TYPE:: :&lt;/u&gt;&lt;/b&gt;</span><span style="font-size:9pt"><br />   si ce paramètre est égal à la valeur : </span><span style="font-size:9pt;font-weight:600;color:#ff0000">lineaire </span><span style="font-size:9pt">alors, la présentation ne tiendra pas compte des autres paramètres et sera de type textuel, avec les antécédents ajoutés les uns à la suite des autres.<br />   le paramètre </span><span style="font-style:italic;font-size:9pt;font-weight:600">::TYPE::</span><span style="font-size:9pt"> sera remplacé par la famille et le genre de l'antécédent.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(sélecteur de présentation des propriétés des antécédents) :<br />    Ce paramètre permet de déterminer l'affichage d'une ligne d'antécédent en indiquant au sein d'une ligne html l'emplacement et les attribut d'affichage de chaque propriété.<br />   </span><span style="font-style:italic;font-size:9pt">Exemple : </span><span style="font-size:9pt;font-weight:600;color:#ff0000">&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::LIBELLE:: ::MEDCHIR:: ::ETAT:: ::CODE:: ::NOTE:: ::DATE:: ::ALD::<br /></span><span style="font-size:9pt">            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::LIBELLE::</span><span style="font-size:9pt">         sera remplacé par le libellé de l'antécédent.<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::MEDCHIR::</span><span style="font-size:9pt">      sera remplacé par la catégorie de l'antécédent (Médical chirurgical etc..).<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\</span><span style="font-size:9pt;font-weight:600;color:#ff0000">(MEDCHIR</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\</span><span style="font-size:9pt;font-weight:600;color:#ff0000">)::</span><span style="font-size:9pt">    sera remplacé par la catégorie de l'antécédent (Médical chirurgical etc..) entre parenthèses.<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::ETAT::</span><span style="font-size:9pt">              sera remplacé par l'état de l'antécédent (Actif, Passé).<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::CODE::</span><span style="font-size:9pt">             sera remplacé par le code CIM10 de l'antécédent.<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::NOTE::</span><span style="font-size:9pt">              sera remplacé par le commentaire de l'antécédent.<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::DATE::</span><span style="font-size:9pt">              sera remplacé par la date de l'antécédent avec la formule d'introduction indiquée dans le paramètre N°3.<br />            </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::ALD::</span><span style="font-size:9pt">               sera remplacé par la formule indiquée dans le paramètre N°4 si l'antécédent est placé en ALD.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(formule d'introduction de la date) :<br />   formule d'introduction de la date<br />   </span><span style="font-style:italic;font-size:9pt">Exemple : </span><span style="font-size:9pt;font-weight:600;color:#ff007f">en date du :<br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(formule ALD) :<br />   qui si l'antécédent est en ALD remplacera le motif : </span><span style="font-size:9pt;font-weight:600;color:#ff0000">::ALD::</span><span style="font-size:9pt"><br />   </span><span style="font-style:italic;font-size:9pt">Exemple : </span><span style="font-size:9pt;font-weight:600;color:#ff007f">est en rapport avec une pathologie ALD</span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;text-decoration:underline">Quelques exemples</span><span style="font-size:9pt"> :<br /><br />   {{::#Extract_ATCD (<br />                  &lt;b&gt;&lt;u&gt;° Antécédents </span><span style="font-style:italic;font-size:9pt">::TYPE:: </span><span style="font-size:9pt">:&lt;/u&gt;&lt;/b&gt; ,\<br />                  &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;::LIBELLE:: ::MEDCHIR:: ::NOTE:: ::DATE:: ,\<br />                  en date du :,\<br />est en rapport avec une pathologie ALD) }}<br /><br /></span><span style="font-size:9pt;text-decoration:underline">produira l'affichage suivant </span><span style="font-size:9pt">:<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">° Antécédents allergiques :</span><span style="font-size:9pt"> <br />      pénicilline G Gynécologiques Actif (6106A) <br />      pollen Méd Passé (2530L) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">° Antécédents divers :</span><span style="font-size:9pt"> <br />      Problème de dépendance à la cocaïne Passé ~F14.2~ <br />      ascite maligne Passé ~C78~ <br />      Asthme sai Facteurs de risque familiaux Passé ~J45.9~ en date du :24-01-2008 est en rapport avec une pathologie ALD<br />      ne se lave pas Facteurs de risque hygiène Passé <br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.3</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract_Table (<br /></span><span style="font-size:9pt">                                                                              </span><span style="font-size:9pt;font-weight:600;color:#0000ff">VAR</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Constantes de Base</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                              </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Pouls</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">20</span><span style="font-size:9pt"> ; </span><span style="font-size:9pt;font-weight:600;color:#0000ff">SAO2</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">80</span><span style="font-size:9pt"> ; </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Temp</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">30</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                              DATE VISITE </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                             </span><span style="font-size:9pt;font-weight:600;color:#aa0000">2008/12/24,\<br /></span><span style="font-size:9pt">                                                                              100, 20, 1, 200 </span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                              </span><span style="font-size:9pt;font-weight:600;color:#0000ff">dd-MM-yyyy hh:mm</span><span style="font-size:9pt">=</span><span style="font-size:9pt;font-weight:600;color:#ff0000">Dates de prises</span><span style="font-size:9pt;font-weight:600;color:#aa0000">,\<br /></span><span style="font-size:9pt">                                                                              </span><span style="font-size:9pt;font-weight:600;color:#ff0000">50</span><span style="font-size:9pt;font-weight:600;color:#aa0000">) }}</span><span style="font-size:9pt"><br /><br />Cette instruction a pour objectif de mettre en forme des données provenant d'une table ou tableau de variable du terrain de façon à les inclure dans vos documents .<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (Nom du tableau ou de la table à afficher) :<br /></span><span style="font-size:9pt;font-weight:600;color:#0000ff">VAR</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Constantes de Base</span><span style="font-size:9pt"><br />Nom du tableau ou de la table tel qu'indiqué dans le modèle du tableau après la mention </span><span style="font-size:9pt;font-weight:600;color:#0000ff">VAR</span><span style="font-size:9pt"><br />exemple : </span><span style="font-style:italic;font-size:9pt;font-weight:600">Constantes de Base</span><span style="font-size:9pt"> dans le modèle ci-dessous<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple de modèle</span><span style="font-size:9pt"> :<br /><br />[VAR </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Constantes de Base</span><span style="font-size:9pt">]     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Pouls</span><span style="font-size:9pt">, 31536000, 130, 40, pps, Tachycardie, Bradycardie     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">SAO2</span><span style="font-size:9pt">, 31536000, 0, 92, %, , Hypoxie     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Temp</span><span style="font-size:9pt">, 31536000, 40.5, 35, ?, Hypothermie, Hyperthermie     <br />[VAR </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Poids</span><span style="font-size:9pt">]     <br />   Modèle = Date, Poids,  31536000, 100, 50, Kg(s), Obésité, Amaigrissement     <br />   Modèle = Date, Taille, 31536000, 0, 0, cm(s), ,      <br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (liste des variables à afficher) :<br /></span><span style="font-size:9pt;font-weight:600;color:#0000ff">Pouls</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">20</span><span style="font-size:9pt"> ; </span><span style="font-size:9pt;font-weight:600;color:#0000ff">SAO2</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">80</span><span style="font-size:9pt"> ; </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Temp</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600;color:#ff0000">30</span><span style="font-size:9pt"><br />Cette liste présente chaque variable dont on désire afficher les valeurs, séparées par un point virgule.<br />suit ensuite après le signe = <br />                                                            soit le nombre de pixels aloués pour la largeur d'affichage, <br />                                                            soit si le signe % suit cette valeur, le pourcentage de largeur d'affichage.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (première date à partir de laquelle afficher les données) :<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">soit la date est exprimée sous la forme : </span><span style="font-size:9pt;font-weight:600">YYYY-MM-DD</span><span style="font-size:9pt"> où YYYY est l'année, MM est le mois de l'année (entre 01 et 12), et DD est le jour du mois (entre 01 et 31). <br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">soit la date est exprimée sous la forme des formules préétablies suivantes :<br />                    TOUTE DATE pas de limite inférieure.<br />                    DATE VISITE date de l'observation en cours.<br />                    DATE ACTUELLE date du jour en cours.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(date de fin pour afficher les données) :<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">soit la date est exprimée sous la forme : YYYY-MM-DD où YYYY est l'année, MM est le mois de l'année (entre 01 et 12), et DD est le jour du mois (entre 01 et 31). <br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">soit la date est exprimée sous les formes suivantes :<br />                    </span><span style="font-size:9pt;font-weight:600">+</span><span style="font-size:9pt"> suivi d'une valeur correspondant au nombre d'heures à rajouter à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : +24</span><span style="font-size:9pt"><br />                    </span><span style="font-size:9pt;font-weight:600">+-</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600">-+</span><span style="font-size:9pt"> suivi d'une valeur correspondant au nombre d'heures à enlever à la date de début et à rajouter à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : +-24</span><span style="font-size:9pt"><br />                    </span><span style="font-size:9pt;font-weight:600">-</span><span style="font-size:9pt"> suivi d'une valeur correspondant au nombre d'heures à enlever à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : -24</span><span style="font-size:9pt"><br />                    chiffre 0 ou vide, alors la date de fin est la date de début à laquelle est ajouté 24 heures.<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">soit la date est exprimée sous la forme des formules préétablies suivantes : <br />                    TOUTE DATE pas de limite inférieure.<br />                    DATE VISITE date de l'observation en cours.<br />                    DATE ACTUELLE date du jour en cours.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur de la cellule) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Hauteur de la cellule) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur de la ligne de séparation) :<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 8</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur totale du tableau) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale de la page.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 9</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(format d'affichage des dates) :<br />          exprimé selon la règle suivante : </span><a href="DrTux.html#format_des_dates"><span style="font-size:9pt">format des dates</span></a><span style="font-size:9pt"><br />          ce paramètre peut être suivi (séparé par le signe = ) du titre de la colonne des dates.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 10</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(largeur de la colonne des dates) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Quelques exemples</span><span style="font-size:9pt"> :<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , TOUTE DATE , DATE VISITE, 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , TOUTE DATE , TOUTE DATE, 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , DATE VISITE , +24 , 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , DATE VISITE , +-24 , 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , DATE VISITE , -24 , 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br />          {{:: Extract_Table (VAR Constantes de Base , Pouls = 20 ; SAO2 = 80 ; Temp = 30 , DATE ACTUELLE , +24 , 100, 20, 1, 200 ,dd-MM-yyyy hh:mm=Dates de prises, 50)}}<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.4</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: Extract_VAR (VAR Constantes de Base , SAO2 , DATE VISITE , 0 , TOUTES )}}</span><span style="font-size:9pt"><br />{{:: Extract_VAR (VAR Constantes de Base , SAO2 , DATE VISITE , -24 , PREMIERE )}}<br />{{:: Extract_VAR (VAR Constantes de Base , SAO2 , DATE VISITE , +24 , DERNIERE )}}<br />{{:: Extract_VAR (VAR Constantes de Base , SAO2 , DATE VISITE , +-24 , PLUS PROCHE )}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.5</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\t</span><span style="font-size:9pt;font-weight:600;color:#0000ff">*</span><span style="font-size:9pt;font-weight:600;color:#ff0000">20</span><span style="font-size:9pt;font-weight:600">}}</span><span style="font-size:9pt"> cette instruction sera remplacée par 20 tabulations<br />de même : </span><span style="font-size:9pt;font-weight:600">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\r</span><span style="font-size:9pt;font-weight:600;color:#0000ff">*</span><span style="font-size:9pt;font-weight:600;color:#ff0000">15</span><span style="font-size:9pt;font-weight:600">}}</span><span style="font-size:9pt"> sera remplacée par 15 caractères retour chariot,<br />de même : </span><span style="font-size:9pt;font-weight:600">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\\</span><span style="font-size:9pt;font-weight:600;color:#0000ff">*</span><span style="font-size:9pt;font-weight:600;color:#ff0000">10</span><span style="font-size:9pt;font-weight:600">}}</span><span style="font-size:9pt"> sera remplacée par 10 caractères \ ,<br />de même : </span><span style="font-size:9pt;font-weight:600">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">\n</span><span style="font-size:9pt;font-weight:600;color:#0000ff">*</span><span style="font-size:9pt;font-weight:600;color:#ff0000">25</span><span style="font-size:9pt;font-weight:600">}}</span><span style="font-size:9pt"> sera remplacée par 25 caractères fin de ligne,<br />de même </span><span style="font-size:9pt;font-weight:600">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">D</span><span style="font-size:9pt;font-weight:600;color:#0000ff">*</span><span style="font-size:9pt;font-weight:600;color:#ff0000">30</span><span style="font-size:9pt;font-weight:600">}}</span><span style="font-size:9pt"> sera remplacée par 30 caractères D<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.6</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: exe_process ( </span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#0000ff">WaitEnd</span><span style="font-size:9pt"> ,  </span><span style="font-size:9pt;font-weight:600;color:#aa007f">../../QLightPad/bin/QLightPad</span><span style="font-size:9pt;font-weight:600;color:#aa0000">)</span><span style="font-size:9pt">  </span><span style="font-size:9pt;font-weight:600;color:#aa0000">}}</span><span style="font-size:9pt"><br /><br />Exécute sans sommation le processus ou programme dont le chemin est désigné par le deuxième argument.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (option d'attente) :<br />         peut prendre les valeurs suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">WaitEnd</span><span style="font-size:9pt;color:#0000ff"> </span><span style="font-size:9pt">et alors il sera attendu la fin du processus.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">NoWaitEnd</span><span style="font-size:9pt"> et alors la fin du processus n'est pas attendue.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (chemin du processus ou programme à exécuter) :<br />       Terme désignant le processus ou programme devant être exécuté.<br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">ce chemin peut être exprimé en chemin relatif lorsqu'il commence par deux points </span><span style="font-size:9pt;font-weight:600">..</span><span style="font-size:9pt"><br />                 les deux points signifient alors de remonter d'un répertoire à partir du répertoire appelant (en général le répertoire appelant est : </span><span style="font-size:9pt;font-weight:600">/MedinTux/Programmes/drtux/bin</span><span style="font-size:9pt"> )<br />                exemple le chemin relatif suivant </span><span style="font-size:9pt;font-weight:600">../..</span><span style="font-size:9pt"> fera remonter dans le répertoire </span><span style="font-size:9pt;font-weight:600">/MedinTux/Programmes.</span><span style="font-size:9pt"> La conversion en chemin absolu est inhibée si la mention </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$IsAbsPath</span><span style="font-size:9pt"> est présente dans le chemin.<br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Pour les </span><span style="font-size:9pt;font-weight:600">MacOsX</span><span style="font-size:9pt"> ce chemin peut être précédé de la mention </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$IsBinPath</span><span style="font-size:9pt"> et alors le chemin sera considéré comme le binaire direct à exécuter et non comme une simple application( à laquelle sans cette mention il est ajouté le chemin vrai du binaire : </span><span style="font-size:9pt;font-weight:600">.app/Contents/MacOS/</span><span style="font-size:9pt"> )</span><span style="font-size:9pt;font-weight:600"><br /></span><span style="font-size:9pt">                 </span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: exe_process ( </span><span style="font-size:9pt;font-weight:600;color:#0000ff">NoWaitEnd</span><span style="font-size:9pt"> ,</span><span style="font-size:9pt;font-weight:600;color:#ff0000"> $IsBinPath</span><span style="font-size:9pt;font-weight:600;color:#aa007f">../../QLightPad/bin/QLightPad.app/Contents/MacOS/QLightPad</span><span style="font-size:9pt;font-weight:600;color:#aa0000">)}}</span><span style="font-size:9pt;font-weight:600"><br /></span><span style="font-size:9pt">                 pour les autres Os, cette mention est ignorée.<br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Si la mention </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$IsAbsPath</span><span style="font-size:9pt"> est présente dans le chemin, la conversion en chemin absolu est inhibée.<br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Si la mention </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$NoAddExe </span><span style="font-size:9pt">est présente dans le chemin, l'extension </span><span style="font-size:9pt;font-weight:600">.exe</span><span style="font-size:9pt"> n'est pas ajoutée. Cela est utile pour l'appel de </span><span style="font-size:9pt;font-weight:600">script</span><span style="font-size:9pt"> exemple lors de l'appel direct d'un </span><span style="font-size:9pt;font-weight:600">script PHP </span><span style="font-size:9pt">il ne faut pas ajouter l'extension </span><span style="font-size:9pt;font-weight:600">.exe</span><span style="font-size:9pt"> au nom de l'exécutable qui est ici le script.<br /></span><span style="font-size:9pt;font-weight:600"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (premier argument du programme) :<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° N</span><span style="font-size:9pt"> (nième argument du programme) :<br />             </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Si un argument commence par le modificateur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> alors ce qui suit la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> sera considéré comme le chemin d'un fichier dont le contenu sera placé dans l'argument, et alors le nom de ce fichier peut contenir les mentions suivantes :<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /><br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Si un argument commence par le modificateur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">[$File]</span><span style="font-size:9pt"> alors il sera transformé en </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> après interprétation et remplacement par le contenu des </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> normaux, cela permet de protéger la mention </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> dans une ligne d'arguments dans laquelle il est nécessaire de la placer, et éviter que le terme soit interprété et remplacé par le contenu.<br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{::exe_process ( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#0000ff">NoWaitEnd</span><span style="font-style:italic;font-size:9pt;font-weight:600">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa00ff">../../APropos/bin/APropos</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">MailOnly</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600">roland-sevin@medintux.org?subject=Salut tout le monde&amp;body=</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">[$File]</span><span style="font-family:Fixed;font-size:9pt;font-weight:600">../../fichierDuCorpsDuMail.txt</span><span style="font-family:Fixed;font-size:9pt">)}}</span> <span style="font-size:9pt"><br /><br />              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Mentions de conversion de chemins : il est parfois nécessaire de convertir en chemin absolu certaines parties des arguments, il faut alors encadrer la partie à convertir par les mentions suivantes :<br /></span><span style="font-size:9pt;font-weight:600;color:#ff0000">$ToAbsPath</span><span style="font-size:9pt"> et </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$EndToAbsPath </span><span style="font-size:9pt;font-weight:600">.<br /><br /></span><span style="font-size:9pt">              </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt">Mentions de direction d'un agument :</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">Si un argument commence par la mention</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$toStdIn</span><span style="font-size:9pt"> (qui peut être suivie de la mention </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt">) alors il sera écrit sur l'entrée standard du processus.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{::exe_process ( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#0000ff">WaitEnd</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa00ff">../../Plug/OCR/medintux2tess.sh</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00aa00">LastScanned.tif</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#55aa00">LastScanned</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#55aa00">-l fra</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#ff0000">$ToAbsPath</span><span style="font-style:italic;font-size:9pt;font-weight:600">../../tmp</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#ff0000">$EndToAbsPath</span><span style="font-style:italic;font-size:9pt;font-weight:600">/, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#55aa00">nodebug</span><span style="font-style:italic;font-size:9pt;font-weight:600">)}}\<br /></span><span style="font-size:9pt">              convertira le texte </span><span style="font-style:italic;font-size:9pt;font-weight:600">../../tmp</span><span style="font-size:9pt"> en chemin absolu comme par exemple </span><span style="font-style:italic;font-size:9pt;font-weight:600">/MedinTux/Programmes/tmp</span><span style="font-size:9pt"> .<br />              cette fonctionnalité est très utile, car elle permet d'exprimer des arguments de chemins en chemins relatifs afin de rendre le script indépendant de la localisation. <br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.7</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::import ( </span><span style="font-size:9pt;font-weight:600;color:#0000ff">../../tmp/LastScanned.txt</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#aa007f">insert , </span><span style="font-size:9pt;font-weight:600;color:#00aa00">Observation , </span><span style="font-size:9pt;font-weight:600;color:#aa5500">destPath</span><span style="font-size:9pt;font-weight:600;color:#00aa00">, </span><span style="font-size:9pt;font-weight:600;color:#aa0000">title )}}<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chemin du fichier à importer) :<br />         peut contenir les mentions suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Theme</span><span style="font-size:9pt">             qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Thème</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (modificateurs de comportement) :<br />         peut contenir, séparées par un espace, les valeurs suivantes :<br /><br />              </span><span style="font-size:9pt;font-weight:600">° insert</span><span style="font-size:9pt"> et alors le contenu du fichier sera ajouté au curseur texte.<br />              </span><span style="font-size:9pt;font-weight:600">° new</span><span style="font-size:9pt"> et alors il sera crée une nouvelle rubrique avec le contenu du fichier .<br />              </span><span style="font-size:9pt;font-weight:600">° print </span><span style="font-size:9pt">en cas de création de nouveau document avec </span><span style="font-size:9pt;font-weight:600">new</span><span style="font-size:9pt"> une impression directe sera aussi effectuée.<br />              </span><span style="font-size:9pt;font-weight:600">° replace </span><span style="font-size:9pt">et alors le contenu de la rubrique actuelle sera remplacé avec le contenu du fichier.<br />              </span><span style="font-size:9pt;font-weight:600">° crlf2html </span><span style="font-size:9pt">et alors les retours chariot seront convertis en retours html </span><span style="font-size:9pt;font-weight:600">&lt;br /&gt;</span><span style="font-size:9pt">.<br />              </span><span style="font-size:9pt;font-weight:600">° remove_src </span><span style="font-size:9pt">et alors le fichier d'origine est détruit.<br />              </span><span style="font-size:9pt;font-weight:600">° clear_src </span><span style="font-size:9pt">et alors le fichier d'origine est effacé mais non détruit.<br />              </span><span style="font-size:9pt;font-weight:600">° no_html </span><span style="font-size:9pt">et alors lors du mode insert seulement, le contenu du fichier sera débarrassé des tag html, et ne sera inséré que si il contient du texte significatif,.<br />              </span><span style="font-size:9pt;font-weight:600">° verbose </span><span style="font-size:9pt">et alors, s'il y a des erreurs, elles seront retournées dans le texte à la place du fichier à importer.<br />              </span><span style="font-size:9pt;font-weight:600">° noInquire </span><span style="font-size:9pt">et alors, s'il y a des boîtes de confirmation de choix, elles seront ignorées et le fichier importé.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline"><br />Paramètre N° 3</span><span style="font-size:9pt"> (rubrique de destination) :<br />         peut contenir le nom de la rubrique de destination, si omis alors c'est la rubrique active qui recevra le contenu du fichier.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (facultatif : répertoire de copie du document) :<br />         si indiqué et non vide alors le document sera copié le répertoire indiqué par ce paramètre.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (facultatif : titre du document) :<br />         peut contenir le titre du document.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (facultatif : sous type du document) : est utile pour relier le document à un en-tête et pied de page (voir doc GestUser)<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt"> (facultatif : le type du document) : ce paramètre est surtout utile lors de l'importation d'un document relatif à une prescription, pour signaler si il s'agit :<br />         - d'une ordonnance textuelle (</span><span style="font-size:9pt;font-weight:600">20020200</span><span style="font-size:9pt"> auquel cas le duplicata sera imprimé),<br />         - d'un certificat ou document d'information (</span><span style="font-size:9pt;font-weight:600">20020300</span><span style="font-size:9pt"> pas d'impression du duplicata),<br />         - d'un courrier (</span><span style="font-size:9pt;font-weight:600">20020500</span><span style="font-size:9pt"> pas d'impression du duplicata),<br />         - d'une ordonnance structurée .ord (</span><span style="font-size:9pt;font-weight:600">20020100</span><span style="font-size:9pt"> auquel cas le duplicata sera imprimé. <br />            ce type est normalement détecté automatiquement si le document a l'extension </span><span style="font-size:9pt;font-weight:600">.ord</span><span style="font-size:9pt">)<br /><br />Si le paramètre N°7 n'est pas précisé : soit le document à importer se termine avec l'extension </span><span style="font-size:9pt;font-weight:600">.ord</span><span style="font-size:8pt"><br />et alors il sera considéré comme une ordonnance structurée, sinon le document sera considéré comme une ordonnance textuelle (impression d'un duplicata) <br /></span><span style="font-size:9pt"><br />         <br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{::import ( </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-style:italic;font-size:9pt;font-weight:600">/Vigie/Classeurs/Hospitalisation.html , </span><span style="font-size:9pt;font-weight:600;color:#aa007f">new noInquire </span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-size:9pt;font-weight:600;color:#00aa00">Observation </span><span style="font-style:italic;font-size:9pt;font-weight:600">)}}\<br /></span><span style="font-size:9pt">              créera une nouvelle rubrique </span><span style="font-size:9pt;font-weight:600;color:#00aa00">Observation</span><span style="font-size:9pt"> avec le fichier : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-style:italic;font-size:9pt;font-weight:600">/Vigie/Classeurs/Hospitalisation.html</span><span style="font-size:9pt"> .<br />              </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt"> sera remplacé par le chemin du glossaire. Il ne sera pas demandé de confirmation si un même fichier du même jour existe déjà.<br /><br />Cette instruction est utile, car permet de réaliser des scripts d'insertion de plusieurs documents à la fois sous forme de liasse de documents :<br /><br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : Création d'une </span><span style="font-size:9pt;font-weight:600">liasse de documents</span><span style="font-size:9pt">. J'ai un protocole de prise en charge d'une entorse de la cheville. Lors d'une immobilisation plâtrée, il est utile de produire plusieurs documents :<br />              ° une ordonnance de médicaments avec notamment une injection d'HBPM.<br />              ° une prescription d'injections destinée à l'infirmière qui fera les injections.<br />              ° une prescription de surveillance des plaquettes deux fois par semaine.<br />              ° un document d'information au patient concernant la surveillance plâtrée.<br />              ° éventuellement un courrier au médecin qui va suivre ce patient.<br /><br />              Il suffit alors de placer dans un script de menu déroulant plusieurs instructions d'importation qui chacune importeront un des documents ci-dessus, et en un clic ils seront tous créés.<br />              Il n'y a plus qu'à imprimer.<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.8</span><span style="font-size:9pt"> |==&gt; {{::delete_file (../../tmp/LastScanned.txt, clear)}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.9</span><span style="font-size:9pt"> |==&gt; {{::copy_file($ToAbsPath ../../tmp/{{GET LAST IMAGE NAME}} , $ToAbsPath ../../tmp/NewName.png, $remove_src_file)}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.10</span><span style="font-size:9pt"> |==&gt; {{SAVE CURRENT DOC=../../tmp/exemple.text}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.11</span><span style="font-size:9pt"> |==&gt; {{GET SAVE FILE NAME = ../../tmp/}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.12</span><span style="font-size:9pt"> |==&gt; {{GET LAST IMAGE NAME}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.13</span><span style="font-size:9pt"> |==&gt; {{GET LAST IMAGE SRC_NAME}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.14</span><span style="font-size:9pt"> |==&gt; {{SAVE LAST IMAGE NAME== ../../tmp/ }}<br />{{SAVE LAST IMAGE NAME=../../tmp/ }}{{:: copy_files ($ToAbsPath ../../tmp/{{GET LAST IMAGE NAME}} ,<br />$ToAbsPath ../../tmp/NewName.png, $remove_src_file)}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.15</span><span style="font-size:9pt"> |==&gt; {{::insert_image (./Ressources/icones/PingouinsSimple.png , 300 , 500) }}<br />{{SAVE LAST IMAGE NAME=../../tmp/}}{{:: exe_process (WaitEnd , /usr/bin/gimp ,$ToAbsPath ../../tmp/{{GET LAST IMAGE<br />NAME}})}}{{:: replace_image ({{GET LAST IMAGE NAME}}, ../../tmp/{{GET LAST IMAGE NAME}},-1,-1,$keep_src_name<br />$remove_src_file)}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.16</span><span style="font-size:9pt"> |==&gt; {{:: replace_image ({{GET LAST IMAGE NAME}}, ../../tmp/{{GET LAST IMAGE NAME}},-1,-1, $keep_src_name<br />$remove_src_file) }}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.17</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: OPEN_FILE_NAME(</span><span style="font-size:9pt;font-weight:600;color:#aa00ff">Fichiers IMAGE [*.jpg *.jpeg *.png *.PNG *.gif *.GIF *.JPEG *.JPG];;Tous les fichiers [*]</span><span style="font-size:9pt;font-weight:600;color:#aa0000">, </span><span style="font-size:9pt;font-weight:600;color:#005500">$ToAbsPath../../tmp$EndToAbsPath/</span><span style="font-size:9pt;font-weight:600;color:#aa0000">}}</span><span style="font-size:9pt"><br />Cette instruction permet d'ouvrir le sélecteur de fichiers afin de sélectionner un fichier.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (filtre de sélection).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> ( facultatif : prépositionne le répertoire avec lequel s'ouvrira le sélecteur de fichier )<br />{{:: replace_image ({{GET LAST IMAGE NAME}}, {{OPEN_FILE_NAME}}, -1, -1, $keep_Original_W $keep_Original_H) }}<br />{{:: replace_image ({{GET LAST IMAGE NAME}}, {{OPEN_FILE_NAME}}, 600, -1) }}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.18</span><span style="font-size:9pt"> |==&gt; {{IF {{SEXE PATIENT}} = F | e | |}}<br />{{IF {{::Upper ( {{ADRESSE COMPLETE MEDECIN}} ) }} %= MARS | commence par MARS | ne commence pas par MARS|}}<br />{{IF {{::Upper ( {{ADRESSE COMPLETE MEDECIN}} ) }} =% EILLE | finit par EILLE | ne finit pas par EILLE|}}<br />{{IF {{::Upper ( {{ADRESSE COMPLETE MEDECIN}} ) }} %% SEIL | contient SEIL | ne contient pas SEIL|}}<br />{{IF {{::Lower ( {{ADRESSE COMPLETE MEDECIN}} ) }} %% seil | contient seil | ne contient pas seil|}}<br />{{IF {{::DaysTo( {{DATE OBSERVATION}},{{CURRENT DATE}} ) }} &gt; 30 | Observation datant de plus de 30 jours ||}}<br />{{IF {{AGE PATIENT ANNEE ABREGE}} &gt;= 18 | Majeur | Mineur|}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.19</span><span style="font-size:9pt"> |==&gt; {{:: Intitule ( Intitule du document , add ) }}<br />{{:: Intitule ( Intitule du document , change ) }}<br />{{:: Intitule ( Intitule du document ) }}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.20</span><span style="font-size:9pt"> |==&gt; {{:: sous_type ( sous_type du document , add ) }}<br />{{:: sous_type ( sous_type du document , change ) }}<br />{{:: sous_type ( sous_type du document ) }}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.21</span><span style="font-size:9pt"> |==&gt; {{::Calc (25 , * , POIDS) }}<br />{{::Calc (25 , x , POIDS) }}<br />{{::Calc (25 , + , POIDS) }}<br />{{::Calc (25 , / , POIDS) }}<br />{{::Calc (25 , - , POIDS) }}<br />{{::Calc (25 , * , TAILLE) }}<br />{{::Calc (25 , * , SURFACE) }}<br />{{::Calc (25 , * , BMI) }}<br />{{::Calc (25 , * , {{AGE PATIENT ANNEE ABREGE}}) }}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.22</span><span style="font-size:9pt"> |==&gt; {{INTERVENANT = Médecine générale CHAMPS DESIRES = TNP,S,A,CV DECALAGE= }}<br />{{INTERVENANT = Médecine générale CHAMPS DESIRES = TNP,S,A,CV DECALAGE= SEP=&lt;hr&gt;}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.23</span><span style="font-size:9pt"> |==&gt; {{INTERV_STRUCT_XXX = Médecine generale STYLE = liste CHAMPS DESIRES = TNPSACV DECALAGE= }}<br />{{INTERV_STRUCT_XXX = Médecine generale STYLE = noms CHAMPS DESIRES = TNPSACV DECALAGE= }}<br />{{INTERV_CHAMP_XXX_TITRE}}<br />{{INTERV_CHAMP_XXX_SPECIALITE}}<br />{{INTERV_CHAMP_XXX_NOM}}<br />{{INTERV_CHAMP_XXX_PRENOM}}<br />{{INTERV_CHAMP_XXX_ADR_1}}<br />{{INTERV_CHAMP_XXX_ADR_2}}<br />{{INTERV_CHAMP_XXX_ADR_3}}<br />{{INTERV_CHAMP_XXX_CODE_POST}}<br />{{INTERV_CHAMP_XXX_VILLE}}<br />{{INTERV_CHAMP_XXX_NOM}}<br />{{INTERV_CHAMP_XXX_NOM}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.24</span><span style="font-size:9pt"> |==&gt; {{DATE TIRET}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.25</span><span style="font-size:9pt"> |==&gt; {{dd-MM-yyyy}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.26</span><span style="font-size:9pt"> |==&gt; {{date}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.27</span><span style="font-size:9pt"> |==&gt; {{HHHMM}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.28</span><span style="font-size:9pt"> |==&gt; {{DT=expression}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.29</span><span style="font-size:9pt"> |==&gt; {{hh:mm}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.30</span><span style="font-size:9pt"> |==&gt; {{DATE DOCUMENT=Prescription FORMAT=dd-MM-yyyy}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.31</span><span style="font-size:9pt"> |==&gt; {{DATE VISITE}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.32</span><span style="font-size:9pt"> |==&gt; {{DATE OBSERVATION}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.33</span><span style="font-size:9pt"> |==&gt; {{USER TITRE PS}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.34</span><span style="font-size:9pt"> |==&gt; {{USER ADRESSE COMPLETE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.35</span><span style="font-size:9pt"> |==&gt; {{USER ADRESSE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.36</span><span style="font-size:9pt"> |==&gt; {{USER VILLE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.37</span><span style="font-size:9pt"> |==&gt; {{USER CP MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.38</span><span style="font-size:9pt"> |==&gt; {{USER SEXE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.39</span><span style="font-size:9pt"> |==&gt; {{USER SPECIALITE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.40</span><span style="font-size:9pt"> |==&gt; {{USER IDENTIFICATION MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.41</span><span style="font-size:9pt"> |==&gt; {{USER CONVENTION MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.42</span><span style="font-size:9pt"> |==&gt; {{USER NOM PRENOM MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.43</span><span style="font-size:9pt"> |==&gt; {{USER NOM MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.44</span><span style="font-size:9pt"> |==&gt; {{USER PRENOM MEDECIN}}<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.45</span><span style="font-size:9pt"> |==&gt; {{USER LOGIN MEDECIN}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.46</span><span style="font-size:9pt"> |==&gt; {{TITRE PS}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.47</span><span style="font-size:9pt"> |==&gt; {{ADRESSE COMPLETE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.48</span><span style="font-size:9pt"> |==&gt; {{ADRESSE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.49</span><span style="font-size:9pt"> |==&gt; {{VILLE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.50</span><span style="font-size:9pt"> |==&gt; {{CP MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.51</span><span style="font-size:9pt"> |==&gt; {{SEXE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.52</span><span style="font-size:9pt"> |==&gt; {{SPECIALITE MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.53</span><span style="font-size:9pt"> |==&gt; {{IDENTIFICATION MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.54</span><span style="font-size:9pt"> |==&gt; {{CONVENTION MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.55</span><span style="font-size:9pt"> |==&gt; {{NOM PRENOM MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.56</span><span style="font-size:9pt"> |==&gt; {{NOM MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.57</span><span style="font-size:9pt"> |==&gt; {{PRENOM MEDECIN}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.58</span><span style="font-size:9pt"> |==&gt; {{AGE PATIENT ABREGE}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.59</span><span style="font-size:9pt"> |==&gt; {{AGE PATIENT ANNEE ABREGE}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.60</span><span style="font-size:9pt"> |==&gt; {{AGE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.61</span><span style="font-size:9pt"> |==&gt; {{NUM. TEL1 PATIENT}}<br />Cette instruction retourne le premier numéro de téléphone du patient.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{NUM TEL1 PATIENT}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.62</span><span style="font-size:9pt"> |==&gt; {{NUM. TEL2 PATIENT}}<br />Cette instruction retourne le deuxième numéro de téléphone du patient.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{NUM TEL2 PATIENT}}</span><span style="font-family:Comic Sans Ms"><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.63</span><span style="font-size:9pt"> |==&gt; {{NUM. TEL3 PATIENT}}<br />Cette instruction retourne le troisième numéro de téléphone du patient.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{NUM TEL3 PATIENT}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.64</span><span style="font-size:9pt"> |==&gt; {{EMAIL PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.65</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{DATE NAISSANCE PATIENT=format de la date}}</span><span style="font-size:9pt"><br />retourne la date de naissance de l'assuré selon le format spécifié dans le paramètre facultatif N°1<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (format de retour pour la date : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy</span><span style="font-size:9pt">) voir en paragraphe </span><span style="font-weight:600">3.4.3.5</span><span style="font-size:9pt"> <br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.66</span><span style="font-size:9pt"> |==&gt; {{SEXE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.67</span><span style="font-size:9pt"> |==&gt; {{TITRE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.68</span><span style="font-size:9pt"> |==&gt; {{PROFESSION PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.69</span><span style="font-size:9pt"> |==&gt; {{NOMBRE D'ENFANT PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.70</span><span style="font-size:9pt"> |==&gt; {{VILLE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.71</span><span style="font-size:9pt"> |==&gt; {{CODE POSTAL PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.72</span><span style="font-size:9pt"> |==&gt; {{ADRESSE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.73</span><span style="font-size:9pt"> |==&gt; {{ADRESSE COMPLETE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.74</span><span style="font-size:9pt"> |==&gt; {{ADRESSE PATIENT UNE LIGNE}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.75</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{NUM. SECU PATIENT = separateur}}</span><span style="font-size:9pt"><br />Cette instruction retourne le numéro de sécurité sociale du patient.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> ( séparateur de clef facultatif). si indiqué alors la clef du numéro de sécurité sociale est rajoutée avec l'éventuel séparateur indiqué dans le</span><span style="font-size:9pt;font-weight:600"> paramètre N°1</span><span style="font-size:9pt">.<br />Si la valeur du séparateur est égale à </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$no key </span><span style="font-size:9pt">, le numéro de sécurité sociale du patient est retourné sans la clef.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{NUM SECU PATIENT}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.76</span><span style="font-size:9pt"> |==&gt; {{NOM PRENOM ASSURE}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.77</span><span style="font-size:9pt"> |==&gt; {{NOM PRENOM INTERVENANT=Médecine générale}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.78</span><span style="font-size:9pt"> |==&gt; {{NOM PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.79</span><span style="font-size:9pt"> |==&gt; {{PRENOM PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.80</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{NOM_PRENOM_PATIENT}}</span><span style="font-size:9pt"><br />Cette instruction sera remplacée par le nom et prénom du patient séparés par un caractère espace.<br />La forme {{NOM_PRENOM_PATIENT=;}} permet de préciser après le signe égal le caractère de séparation (dans cet exemple le point virgule).<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.81</span><span style="font-size:9pt"> |==&gt; {{POIDS PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.82</span><span style="font-size:9pt"> |==&gt; {{BMI PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.83</span><span style="font-size:9pt"> |==&gt; {{SURFACE PATIENT}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.84</span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::Nouveau Document (nom rubrique)}}</span><span style="font-size:9pt"><br />Cette instruction permet de créer un nouveau document avec pour nom de la rubrique, un des types suivants : Observation Prescription Documents Terrain.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{Nouveau Document = nom rubrique}}<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.85</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: TEST(String, Valeur1, = ,Valeur2, c'est vrai, c'est faux )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: SI (String, Valeur1, = ,Valeur2, c'est vrai, c'est faux )}}<br /></span><span style="font-size:9pt">Cette instruction de type opérateur ternaire, permet de faire des tests conditionnels.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (type de test).</span></p>
<p><span style="font-size:9pt">° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">S</span><span style="font-size:9pt"> les valeurs testées seront des chaînes.<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">N</span><span style="font-size:9pt"> les valeurs comparées sont des valeurs numériques</span></p>
<p><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (première valeur à tester )<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (opérateur de test à effectuer)</span></p>
<ul type="disc"><div><span style="font-size:9pt">° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">=</span><span style="font-size:9pt"> teste l'égalité.<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">&gt;</span><span style="font-size:9pt"> vrai si Valeur1 supérieure à Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">&lt;</span><span style="font-size:9pt"> vrai si Valeur1 inférieure à Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">&gt;=</span><span style="font-size:9pt"> vrai si Valeur1 supérieure ou égale à Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">&lt;=</span><span style="font-size:9pt"> vrai si Valeur1 inférieure ou égale à Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">!=</span><span style="font-size:9pt"> vrai si Valeur1 différente de Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">%=</span><span style="font-size:9pt"> vrai si Valeur1 commence par Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">=%</span><span style="font-size:9pt"> vrai si Valeur1 finit par Valeur2<br />° Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">%=%</span><span style="font-size:9pt"> vrai si Valeur1 contient de Valeur2</span></div></ul>
<p><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (deuxième valeur à tester).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (données à placer si vrai).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (données à placer si faux).<br /><br />{{:: TEST(Numérique, Valeur1, = ,Valeur2, c'est vrai, c'est faux )}}<br />{{:: SI (S,{{SEXE MEDECIN}},=,F,e)}}<br />{{:: Si (N,{{AGE PATIENT}},&gt;=,18,majeur,mineur)}}<br /><br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.86</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::Fill ( </span><span style="font-size:9pt;font-weight:600;color:#0000ff">38</span><span style="font-size:9pt"> , ---</span><span style="font-size:9pt;font-weight:600;color:#00aa00"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">)}}<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nombre de répétitions) :<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (motif à répéter) :<br />         Peut contenir la valeur suivante </span><span style="font-size:9pt;font-weight:600">spc</span><span style="font-size:9pt"> qui sera remplacée par un espace.<br />         Si le deuxième paramètre est absent, le motif par défaut à répéter sera un espace.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.87</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DO_LISTE</span><span style="font-size:9pt"> (</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Bernard</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Bruno</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Jean</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Vincent</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">Paul </span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600;color:#00aa00">Choix d'un prénom </span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#00aaff">retour</span><span style="font-size:9pt;font-weight:600">, </span><span style="font-size:9pt;font-weight:600;color:#aa00ff">nbr de champs à afficher</span><span style="font-size:9pt;font-weight:600;color:#00aaff">, </span><span style="font-size:8pt;font-weight:600;color:#00aa00">mode multi ou simple sélection</span><span style="font-size:9pt;font-weight:600;color:#aa0000">)}}<br /></span><span style="font-size:9pt"><br />Cette instruction permet d'afficher un dialogue de liste de choix d'items.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (liste des items séparés par le séparateur indiqué en paramètre N°3 ou | si celui-ci est absent) . <br />                         </span><span style="font-size:9pt;text-decoration:underline">Facilité</span><span style="font-size:9pt"> :   si, dans un item, est présent le motif </span><span style="font-size:9pt;font-weight:600;color:#aa0000">::</span><span style="font-size:9pt">,</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> </span><span style="font-size:9pt">il sera affiché à la place le caractère espace.<br />                                        Cette facilité permet d'afficher des items constitués eux-mêmes d'un ensemble d'éléments<br />                                        séparés par un séparateur que l'on ne veut pas rendre visible lors de l'affichage. <br />                                        <br />Exemple : </span><span style="font-size:8pt;font-weight:600;color:#aa0000">{{:: DO_LISTE</span><span style="font-size:8pt"> (</span><span style="font-size:8pt;font-weight:600;color:#005500">TARTEMPION</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Bernard</span><span style="font-size:8pt;font-weight:600;color:#ff0000">|</span><span style="font-size:8pt;font-weight:600;color:#005500">COEUR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Bruno</span><span style="font-size:8pt;font-weight:600;color:#ff0000">|</span><span style="font-size:8pt;font-weight:600;color:#005500">AYMARD</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Jean</span><span style="font-size:8pt;font-weight:600;color:#ff0000">|</span><span style="font-size:8pt;font-weight:600;color:#005500">MAUVE</span><span style="font-size:8pt;font-weight:600;color:#aa0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Guy </span><span style="font-size:8pt">, </span><span style="font-size:8pt;font-weight:600;color:#00aa00">Choix d'un prénom </span><span style="font-size:8pt">,</span><span style="font-size:8pt;font-weight:600;color:#ff0000">|</span><span style="font-size:8pt">, </span><span style="font-size:8pt;font-weight:600;color:#00aaff">retour_de_liste,</span><span style="font-size:8pt;font-weight:600;color:#aa00ff">-1,</span><span style="font-size:8pt;font-weight:600;color:#00aaff"> </span><span style="font-size:8pt;font-weight:600;color:#aa0000">S )}}<br /></span><span style="font-size:8pt">                     </span><span style="font-size:8pt;font-weight:600;color:#aa0000">{{VAR=</span><span style="font-size:8pt;font-weight:600;color:#00aaff">retour_de_liste</span><span style="font-size:8pt;font-weight:600;color:#aa0000">}}<br /></span><span style="font-size:9pt"><br />                 Affichera la liste suivante: <br />                 </span><img src=MacroDO_LISTE-00.png > <br /><span style="font-size:9pt">                 affichera : </span><span style="font-size:9pt;font-weight:600">Rejected</span><span style="font-size:9pt"> si vous cliquez sur le bouton de fermeture sans avoir cliqué sur un item de la liste.<br />                 affichera : </span><span style="font-size:9pt;font-weight:600">Accepted</span><span style="font-size:9pt"> si vous cliquez sur le bouton de fermeture après avoir cliqué sur un item de la liste.</span><span style="font-size:9pt;font-weight:600;text-decoration:underline"><br />Paramètre N° 2</span><span style="font-size:9pt"> (titre du dialogue) ce paramètre est facultatif.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (séparateur d'items) ce paramètre est facultatif et alors le séparateur par défaut sera </span><span style="font-size:9pt;font-weight:600;color:#aa0000">|</span><span style="font-size:9pt"> si</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> EOL</span><span style="font-size:9pt"> se sera les fins de lignes . <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (variable de retour) ce paramètre est facultatif et, si indiqué, est le nom d'une variable dans laquelle sera retourné : '</span><span style="font-size:9pt;color:#aa0000">Rejected</span><span style="font-size:9pt">' si la fenêtre a été fermée sans qu'un choix ait été fait . '</span><span style="font-size:9pt;color:#aa0000">Accepted</span><span style="font-size:9pt">' si un des éléments de la liste a été cliqué. La valeur de cette variable peut être obtenue par la suite en faisant comme dans l'exemple ci-dessus </span><span style="font-size:8pt;font-weight:600;color:#aa0000">{{VAR=</span><span style="font-size:8pt;font-weight:600;color:#00aaff">retour_de_liste</span><span style="font-size:8pt;font-weight:600;color:#aa0000">}} .</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (nombre de champs à afficher par item) paramètre facultatif qui permet de limiter l'affichage d'un item composé de plusieurs champs à seulement certains champs. Ce nombre est le nombre de champs séparés par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">::</span><span style="font-size:9pt"> qu'il conviendra d'afficher par item. Cela permet de cacher par exemple lors du retour d'une requête SQL, une clef primaire. Le séparateur de champs composant l'item doit être obligatoirement </span><span style="font-size:9pt;font-weight:600;color:#aa0000">::</span><span style="font-size:9pt"> lors de l'affichage il sera remplacé par un espace, lors de la sélection d'un item, le texte retourné, contient lui l'entière liste des champs séparés par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">::</span><span style="font-size:9pt">, comme lors de l'appel.<br />Si </span><span style="font-size:9pt;font-weight:600">-1</span><span style="font-size:9pt"> alors tous les champs sont à afficher.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (mode multisélection) paramètre facultatif qui permet de limiter de spécifier le mode de sélection simple '</span><span style="font-size:9pt;font-weight:600;color:#aa00ff">S</span><span style="font-size:9pt">' ou multi '</span><span style="font-size:9pt;font-weight:600;color:#aa00ff">M</span><span style="font-size:9pt">'.<br /><br />Exemple : </span><span style="font-size:8pt;font-weight:600;color:#aa0000">{{:: DO_LISTE</span><span style="font-size:8pt"> (</span><span style="font-size:8pt;font-weight:600;color:#005500">TARTEMPION</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Bernard</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::103|</span><span style="font-size:8pt;font-weight:600;color:#005500">COEUR</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Bruno</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::105|</span><span style="font-size:8pt;font-weight:600;color:#005500">AYMARD</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Jean</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::110|</span><span style="font-size:8pt;font-weight:600;color:#005500">MAUVE</span><span style="font-size:8pt;font-weight:600;color:#aa0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Guy</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::140</span><span style="font-size:8pt;font-weight:600;color:#0000ff"> </span><span style="font-size:8pt">, </span><span style="font-size:8pt;font-weight:600;color:#00aa00">Choix d'un prénom </span><span style="font-size:8pt">,</span><span style="font-size:8pt;font-weight:600;color:#ff0000">|</span><span style="font-size:8pt">, </span><span style="font-size:8pt;font-weight:600;color:#00aaff">retour,</span><span style="font-size:8pt;font-weight:600;color:#005500">2</span><span style="font-size:8pt;font-weight:600;color:#aa0000">)}}<br /><br /></span><span style="font-size:9pt">                Affichera la liste suivante: <br />                </span><img src=MacroDO_LISTE-00.png > <span style="font-size:9pt">      <br />                et retournera : </span><span style="font-size:8pt;font-weight:600;color:#005500">AYMARD</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:8pt;font-weight:600;color:#0000ff">Jean</span><span style="font-size:8pt;font-weight:600;color:#ff0000">::110</span><span style="font-size:9pt"> si vous cliquez sur la ligne correspondante. Nous voyons que l'affichage dans la liste remplace </span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:9pt"> par un espace et que la liste n'affiche que les deux premiers champs séparés par </span><span style="font-size:8pt;font-weight:600;color:#ff0000">::</span><span style="font-size:9pt"> comme indiqué par le paramètre </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">N° 5</span><span style="font-size:9pt"> et cache donc le dernier champ qui est un nombre.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple sophistiqué :</span><span style="font-size:9pt"> permettant le choix d'un correspondant et d'affecter la clef primaire de ce correspondant à une variable, pouvant être utilisée par la suite pour récupérer son adresse postale ou autres renseignements, pour automatiser l'en-tête d'un courrier.<br /></span><span style="font-size:7pt"><br /></span><span style="font-size:8pt">{{\<br />{{:: SET_VAR(resultat,{{::DO_LISTE({{::#SQL_SELECT (Personnes , Nom |Prenom|ID_PrimKey,WHERE NumOrdre!='' , 30,::,|) }},Nom du médecin,|,retourAdressePar,2)}})}}\<br />{{:: VAR_SPLIT(AdressePar_,{{VAR=resultat}},::)}}\<br />}}\<br />{{REM= -------------- utilisation par la suite des renseignements du choix --------------}}\<br />{{::#TEST(S,{{VAR=retourAdressePar}},=,Accepted, <br /></span><span style="font-size:8pt;font-weight:600">Nom :</span><span style="font-size:8pt"> {{VAR=AdressePar_0}}<br /></span><span style="font-size:8pt;font-weight:600">Prénom :</span><span style="font-size:8pt"> {{VAR=AdressePar_1}}<br /></span><span style="font-size:8pt;font-weight:600">Clef primaire :</span><span style="font-size:8pt"> {{VAR=AdressePar_2}},)}}<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple sophistiqué :</span><span style="font-size:9pt"> permettant la numérisation directe d'un document, sans passer par Xsane en utilisant directement </span><span style="font-size:9pt;font-weight:600">scanimage</span><span style="font-size:9pt"> et deux petits scripts bash : <br />à pla</span><span style="font-family:Courier;font-size:9pt">cer dans le répertoire </span><span style="font-family:Courier;font-size:9pt;font-weight:600">/Plug/scanimage/</span><span style="font-family:Courier;font-size:9pt"><br /><br /></span><span style="font-family:Courier;font-size:9pt;text-decoration:underline">Fichier </span><span style="font-family:Courier;font-style:italic;font-size:9pt;font-weight:600;text-decoration:underline">scan.sh</span><span style="font-family:Courier;font-size:9pt"><br /><br /></span><span style="font-family:Courier;font-style:italic;font-size:9pt;font-weight:600">#!/bin/bash<br /># file : scan.sh<br />DEVICE=$1<br />DEV_COMMAND=$2<br />FILE_OUT=$3<br />scanimage --device-name=&quot;$DEVICE&quot; $DEV_COMMAND --format=tiff&gt;&quot;$FILE_OUT&quot;&quot;.tiff&quot;<br />convert &quot;$FILE_OUT&quot;&quot;.tiff&quot; &quot;$FILE_OUT&quot;&quot;.png&quot;<br /><br /></span><span style="font-family:Courier;font-size:9pt;text-decoration:underline">Fichier </span><span style="font-family:Courier;font-style:italic;font-size:9pt;font-weight:600;text-decoration:underline">listdevice.sh</span><span style="font-family:Courier;font-style:italic;font-size:9pt;font-weight:600"><br /><br />#!/bin/bash<br /># file : listdevice.sh<br />FILE_OUT=$1<br />scanimage -f%d&quot;-+-&quot;&gt;&quot;$FILE_OUT&quot;</span><span style="font-family:Courier;font-size:9pt"><br /><br /></span><span style="font-family:Courier;font-size:9pt;text-decoration:underline">Script à placer dans une option de menu</span><span style="font-family:Courier;font-size:9pt">.<br /><br />$start_titleNumérisation d'image sans interface$end_title{{\ <br />{{REM=                     NUMERISATION AVEC scanimage (nécessite aussi ImageMagick)                 }}\<br />{{REM=                                      testé sous Linux                                         }}\<br />{{REM=-------------------- cette commande est spécifique à chaque scanner ---------------------------}}\<br />{{REM=                     pour connaître les paramètres de votre scanner tapez dans une console     }}\<br />{{REM=                     </span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#550000">scanimage -f%d'|'</span><span style="font-family:Courier;font-size:9pt"> cela affichera séparés par | les noms des scanners      }}\<br />{{REM=                                exp :     </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">brother3:net1;dev0|epkowa:libusb:001:007|</span><span style="font-family:Courier;font-size:9pt">            }}\<br />{{REM=                     récuperer la partie du nom de votre scanner située avant les deux points  }}\<br />{{REM=                                exp :     epkowa       ou    brother3                          }}\<br />{{REM=                     tapez dans une console,                                                   }}\<br />{{REM=                                </span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#550000">scanimage --help -d epkowa</span><span style="font-family:Courier;font-size:9pt">                   ou                }}\<br />{{REM=                                </span><span style="font-family:Courier;font-size:9pt;font-weight:600;color:#550000">scanimage --help -d brother3</span><span style="font-family:Courier;font-size:9pt">                                   }}\<br />{{REM=                     cela listera les commandes possibles et acceptées par votre scanner       }}\<br />{{REM=                                 exemple (tronqué) : pour     epkowa                           }}\<br />{{REM=             </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Options specific to device `epkowa':  </span><span style="font-family:Courier;font-size:9pt">                                            }}\<br />{{REM=             </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Scan Mode: </span><span style="font-family:Courier;font-size:9pt">                                                                       }}\<br />{{REM=                </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">--mode Binary|Gray|Color [Binary] </span><span style="font-family:Courier;font-size:9pt">                                             }}\<br />{{REM=                    </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Selects the scan mode (e.g., lineart, monochrome, or color).</span><span style="font-family:Courier;font-size:9pt">               }}\<br />{{REM=                </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">--depth 8|16 [inactive] </span><span style="font-family:Courier;font-size:9pt">                                                       }}\<br />{{REM=                    </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Number of bits per sample, typical values are 1 for &quot;line-art&quot; and 8</span><span style="font-family:Courier;font-size:9pt">       }}\<br />{{REM=                    </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">for multibit scans.</span><span style="font-family:Courier;font-size:9pt">                                                        }}\<br />{{REM=                </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">--resolution 50..3200dpi [300]                                                </span><span style="font-family:Courier;font-size:9pt"> }}\<br />{{REM=                    </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Sets the resolution of the scanned image.                                  </span><span style="font-family:Courier;font-size:9pt">}}\<br />{{REM=                                                                                               }}\<br />{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;font-size:9pt;color:#0000ff">mode</span><span style="font-family:Courier;font-size:9pt"> peut comporter trois valeurs : </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">Binary|Gray|Color</span><span style="font-family:Courier;font-size:9pt">          }}\<br />{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;font-size:9pt;color:#0000ff">depth</span><span style="font-family:Courier;font-size:9pt"> peut comporter deux valeurs : </span><span style="font-family:Courier;font-size:9pt;color:#0000ff">8|16</span><span style="font-family:Courier;font-size:9pt">                       }}\<br />{{REM=     nous voyons que l'option --</span><span style="font-family:Courier;font-size:9pt;color:#0000ff">resolution</span><span style="font-family:Courier;font-size:9pt"> peut comporter plusieurs valeurs de :</span><span style="font-family:Courier;font-size:9pt;color:#0000ff">50..3200 dpi</span><span style="font-family:Courier;font-size:9pt">   }}\<br />{{REM=                                                                                               }}\<br />{{REM=     nous bâtissons la ligne de commande du scanner en modifiant quelques options possibles    }}\<br />{{:: SET_VAR(scanCommande  ,--mode=Color --resolution=72 )}}\<br />{{REM=-------------------- on part a priori sur un seul scanner trouvé ----------------------------}}\<br />{{:: SET_VAR(scanDev_0,)}}\<br />{{:: SET_VAR(scanDev_1,)}}\<br />{{REM=-------------------- définition des fichiers temporaires ------------------------------------}}\<br />{{:: SET_VAR(ListScanDevFile,{{AP=../../tmp/devicelist.txt}})}}\<br />{{:: SET_VAR(LastScannedFile,{{AP=../../tmp/lastscanned}})}}\<br />{{REM=-------------------- récuperer la liste des scanners ----------------------------------------}}\<br />{{:: exe_process (WaitEnd,../../Plug/scanimage/listdevice.sh,{{VAR=ListScanDevFile}})}}\<br />{{:: SET_VAR(ListScanDevData,$File{{VAR=ListScanDevFile}})}}\                  {{REM=      on charge dans 'ListScanDevData' le fichier de la liste des scanners }}<br />{{REM=-------------------- positionner les actions selon les scanners trouvés----------------------}}\<br />{{:: VAR_SPLIT(scanDev_,{{VAR=ListScanDevData}},-+-,FALSE) }}\                 {{REM=      on explose 'ListScanDevData' en plusieurs variables 'scanDev_0' 'scanDev_1' ... 'scanDev_n' }} <br />{{:: SET_VAR(annulerTout  ,{{:: TEST(S,{{VAR=scanDev_0}},=,,NOP,)}})}}\              {{REM=      si pas de scanner trouve en premiere position 'annulerTout' prend la valeur NOP}}<br />{{:: SET_VAR(doChoixListe ,{{:: TEST(S,{{VAR=scanDev_1}},=,,NOP,DO_LISTE)}})}}\      {{REM=      test si plus d'un scanner alors afficher la liste de choix}}<br />{{REM=-------------------- selection du scanner----------------------------------------------------}}\<br />{{REM=                     si un seul on ne présente pas la liste de choix on le prend             }}\<br />{{REM=           On actionne l'affichage de la liste dans le cas ou doChoixListe=DO_LISTE          }}\<br />{{:: SET_VAR(resultatSelectLst     ,{{:: {{VAR=doChoixListe}}({{VAR=ListScanDevData}},Liste des scanners,-+-,listConfirmation)}})}}\<br />{{:: SET_VAR(resultatSelectDev     ,{{:: SI(S,{{VAR=scanDev_1}},=,,{{VAR=scanDev_0}},{{:: SI(S,{{VAR=listConfirmation}},=,Accepted,{{VAR=resultatSelectLst}},)}})}})}}\<br />{{::#SET_VAR(toPrefix     ,{{::#SI(S,{{VAR=resultatSelectDev}},=,,,&lt;p&gt;&lt;br&gt;)}})}}\            {{REM=      si sélection du scanner vide mettre le prefix à vide }}<br />{{:: SET_VAR(doScanner    ,{{:: SI(S,{{VAR=resultatSelectDev}},=,,NOP,EXE_PROCESS)}})}}\     {{REM=      si sélection du scanner vide ne pas lancer le process }}<br />{{:: SET_VAR(doInsert     ,{{:: SI(S,{{VAR=resultatSelectDev}},=,,NOP,INSERT_IMAGE)}})}}\    {{REM=      si sélection du scanner vide ne pas inserer l'image }}<br />{{REM=-------------------- on actionne le scanner et l'insertion -------------------------------}}\<br />{{:: {{VAR=annulerTout}}{{VAR=doScanner}}(WaitEnd,../../Plug/scanimage/scan.sh,{{VAR=resultatSelectDev}},{{VAR=scanCommande}},{{VAR=LastScannedFile}})}}\<br />}}{{::#{{VAR=annulerTout}}VAR(toPrefix)}}{{:: {{VAR=annulerTout}}{{VAR=doInsert}}({{VAR=LastScannedFile}}.png, 700 , 700)}}</span><span style="font-size:9pt"><br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.88</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::SQL_EXEC( </span><span style="font-size:9pt;font-weight:600;color:#0000ff">requete sql </span><span style="font-size:9pt;font-weight:600;color:#aa0000">)}}</span><span style="font-size:9pt"><br />Cette instruction exécute une requête SQL sur la base </span><span style="font-size:9pt;font-weight:600">DrTuxTest</span><span style="font-size:9pt"> . Une requête SQL contient souvent des parenthèses et des virgules qui seraient interprétées de façon inappropriée par le langage de macro, il convient donc d'écrire la requête en plaçant :<br />- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#44;</span><span style="font-size:9pt"> à la place d'une virgule </span><span style="font-size:9pt;font-weight:600">,</span><span style="font-size:9pt"> <br />- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#40;</span><span style="font-size:9pt"> à la place d'une parenthèse ouvrante </span><span style="font-size:9pt;font-weight:600">(<br /></span><span style="font-size:9pt">- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#41;</span><span style="font-size:9pt"> à la place d'une parenthèse fermante </span><span style="font-size:9pt;font-weight:600">)</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.89</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::SQL_GET_RUB_HEAD_PK ( Observation) }}</span><span style="font-size:9pt"><br />Cette instruction affiche la clef primaire de la rubrique en cours d'affichage, instruction utile pour les appels aux programmes externes et instructions SQL.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom de la rubrique) .<br />         Paramètre facultatif. Si le nom de la rubrique n'est pas précisé, c'est la rubrique courante en cours d'affichage qui est concernée<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{SQL_GET_RUB_HEAD_PK = nom rubrique}}<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.90</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::SQL_SELECT ( </span><span style="font-size:9pt;font-weight:600;color:#aa007f">table </span><span style="font-size:9pt;font-weight:600;color:#aa0000">, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">nom</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">prenom</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#0000ff">sexe </span><span style="font-size:9pt;font-weight:600;color:#aa0000">, </span><span style="font-size:9pt;font-weight:600;color:#00aa00">WHERE nom=paul</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> , 1000 , % , </span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> , </span><span style="color:#55007f">&amp;nbsp;&amp;nbsp;&amp;nbsp;° </span><span style="text-decoration:underline;color:#55007f">Nom</span><span style="color:#55007f"> : %0 </span><span style="text-decoration:underline;color:#55007f">Prénom</span><span style="color:#55007f"> : %1 </span><span style="text-decoration:underline;color:#55007f">Sexe</span><span style="color:#55007f"> : %2</span> <span style="font-size:9pt;font-weight:600;color:#aa0000">)}}<br /></span><span style="font-size:9pt"><br />Cette instruction permet d'exécuter une requête SQL et de formater le retour par exemple pour l'afficher avec la liste de choix d'items </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DO_LISTE}}</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom de la table sur laquelle la requête s'exécute) .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (nom des champs à retourner séparés par </span><span style="font-size:9pt;font-weight:600;color:#ff0000">| </span><span style="font-size:9pt">)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (condition SQL de la requête).<br />Une requête SQL et donc la condition SQL contient souvent des parenthèses et des virgules qui seraient interprétées de façon inappropriée par le langage de macro, il convient donc d'écrire la condition SQL en plaçant :<br />- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#44;</span><span style="font-size:9pt"> à la place d'une virgule </span><span style="font-size:9pt;font-weight:600">,</span><span style="font-size:9pt"> <br />- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#40;</span><span style="font-size:9pt"> à la place d'une parenthèse ouvrante </span><span style="font-size:9pt;font-weight:600">(<br /></span><span style="font-size:9pt">- la mention : </span><span style="font-size:9pt;font-weight:600">&amp;#41;</span><span style="font-size:9pt"> à la place d'une parenthèse fermante </span><span style="font-size:9pt;font-weight:600">)</span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (nombre maximum de réponses par défaut 20, facultatif).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (séparateur de champs lors du retour, par défaut un espace, facultatif).<br />                           si ce séparateur prend la valeur :     </span><span style="font-size:9pt;font-weight:600;color:#ff0000">$SET_VAR</span><span style="font-size:9pt">     alors chaque champ retourné après exécution de la requête SQL <br />                           le sera dans une variable dont le nom aura la forme suivante </span><span style="font-size:9pt;font-weight:600;color:#00007f">nomdelatable</span><span style="font-size:9pt;font-weight:600;color:#aa0000">.</span><span style="font-size:9pt;font-weight:600;color:#005500">nomduchamp</span><span style="font-size:9pt;font-weight:600;color:#00ff00">0</span><span style="font-size:9pt;font-weight:600;color:#005500"> <br /></span><span style="font-size:9pt">                           où</span><span style="font-size:9pt;font-weight:600;color:#005500"> </span><span style="font-size:9pt;font-weight:600;color:#00ff00">0</span><span style="font-size:9pt;font-weight:600;color:#005500"> </span><span style="font-size:9pt">sera l'occurrence du retour soit le numéro de la rangée (notez que cela peut créer beaucoup de variables)</span><span style="font-size:9pt;font-weight:600;color:#005500">.</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (séparateur de lignes lors du retour, par défaut un retour chariot, facultatif).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt"> (Masque d'intégration des données facultatif).</span></p>
<ul type="disc"><div><span style="font-size:9pt">Si, dans ce paramètre, vous placez une chaîne de caractères contenant : le séparateur de champ donné en paramètre N°5 auquel vous accolez le numéro d'ordre du champ tel qu'il apparaît dans le paramètre N°2, comme par exemple %0 pour nom %1 pour prénom %2 pour le sexe, alors, pour chaque réponse de la requête, la sortie se fera en ajoutant cette chaîne avec les motifs %0 %1 %2 remplacés par la valeur du champ correspondant suivie du séparateur de lignes. Cela permet d'envisager des sorties avec la présentation de votre choix.</span></div></ul>
<p><span style="font-size:9pt"><br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#75858c">{{::Do_liste(</span><span style="font-style:italic;font-size:9pt">\</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::#SQL_SELECT ( </span><span style="font-size:9pt;font-weight:600;color:#aa007f">Personnes</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;color:#0000ff">Nom</span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt;color:#0000ff">Prenom </span><span style="font-size:9pt">, </span><span style="font-size:9pt;font-weight:600;color:#00aa00">WHERE Qualite='Maintenance informatique'</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#aa0000">300</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#ff007f">&amp;nbsp;</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#ff0000">|</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">) }}</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#797979">,\<br />Nom du médecin<br />)}}</span><span style="font-style:italic;font-size:9pt;font-weight:600"><br /></span><span style="font-size:9pt">              affichera la liste des intervenants limitée à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">300</span><span style="font-size:9pt"> lignes, ayant pour qualité </span><span style="font-size:9pt;font-weight:600;color:#00aa00">Maintenance informatique</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : {{::DO_LISTE({{::#SQL_SELECT (Personnes , Nom |Prenom,WHERE NumOrdre!='' , 30,&amp;nbsp;,| ) }}, Nom du médecin)}}<br /><br />              affichera la liste des intervenants médecins limitée à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">30</span><span style="font-size:9pt"> lignes de résultats.<br /><br />              </span><img src=Macro-ListeIntervenant.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> :</span><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::#SQL_SELECT</span><span style="font-size:9pt"> (</span><span style="font-size:9pt;color:#aa007f"> fchpat_Intervenants INNER JOIN Personnes ON fchpat_Intervenants.fchpat_Intervenants_IntervPK=Personnes.ID_PrimKey</span><span style="font-size:9pt"> , <br /></span><span style="font-size:9pt;color:#0000ff">Personnes.Qualite</span><span style="font-size:9pt;color:#ff0000">|</span><span style="font-size:9pt;color:#0000ff">Personnes.Nom</span><span style="font-size:9pt;color:#ff0000">|</span><span style="font-size:9pt;color:#0000ff">Personnes.Prenom</span><span style="font-size:9pt;color:#ff0000">|</span><span style="font-size:9pt;color:#0000ff">Personnes.Tel_1</span><span style="font-size:9pt"> , <br /></span><span style="font-size:9pt;color:#00aa00">WHERE fchpat_Intervenants.fchpat_Intervenants_PatPK = '</span><span style="font-size:9pt;color:#aa0000">{{SQL_GET_DOSS_PK}}</span><span style="font-size:9pt;color:#00aa00">'</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;color:#aa0000">300</span><span style="font-size:9pt">,</span><span style="font-size:9pt;font-weight:600;color:#ff007f">%</span><span style="font-size:9pt">,</span><span style="font-size:9pt;color:#ff007f">&lt;br&gt;,&amp;nbsp;&amp;nbsp;&amp;nbsp;° %0 : %1 %2 </span><span style="font-size:9pt;font-weight:600;color:#ff007f">Tél</span><span style="font-size:9pt;color:#ff007f">. %3</span><span style="font-size:9pt">) }}</span><span style="font-size:9pt;text-decoration:underline"><br /></span><span style="font-size:9pt">               affichera la liste des intervenants limitée à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">300</span><span style="font-size:9pt"> lignes, concernant le patient en cours.<br /></span><span style="font-size:9pt;text-decoration:underline">exemple </span><span style="font-size:9pt">:</span></p>
<ul type="disc"><div><span style="font-size:9pt;font-weight:600;text-decoration:underline">Correspondants du patient</span><span style="font-size:9pt"> :<br />{{::#SQL_SELECT ( fchpat_Intervenants INNER JOIN Personnes ON fchpat_Intervenants.fchpat_Intervenants_IntervPK=Personnes.ID_PrimKey , Personnes.Qualite|Personnes.Nom|Personnes.Prenom|Personnes.Tel_1 , WHERE fchpat_Intervenants.fchpat_Intervenants_PatPK = '{{SQL_GET_DOSS_PK}}' , 300 ,%,&lt;br&gt;,&amp;nbsp;&amp;nbsp;&amp;nbsp;</span><span style="font-size:9pt;font-weight:600">° %0</span><span style="font-size:9pt"> : %1 %2 </span><span style="font-size:9pt;font-weight:600">Tél</span><span style="font-size:9pt">. %3) }} <br /><br /></span><span style="font-size:9pt;text-decoration:underline">produira l'affichage suivant</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Correspondants du patient</span><span style="font-size:9pt"> :<br />   ° </span><span style="font-size:9pt;font-weight:600">Infirmière</span><span style="font-size:9pt"> : DUPOND Béatrice </span><span style="font-size:9pt;font-weight:600">Tél</span><span style="font-size:9pt">. 1212121234<br />   ° </span><span style="font-size:9pt;font-weight:600">Maintenance informatique</span><span style="font-size:9pt"> : GERMAIN Pascal </span><span style="font-size:9pt;font-weight:600">Tél</span><span style="font-size:9pt">. 1212121234<br />   ° </span><span style="font-size:9pt;font-weight:600">Cardiologue</span><span style="font-size:9pt"> : DUCOEUR Bertrand </span><span style="font-size:9pt;font-weight:600">Tél</span><span style="font-size:9pt">. 1212121234</span></div></ul>
<p><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.91</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: LINE_EDIT (texte, title, texte d'information)}}</span><span style="font-size:9pt"><br />Cette instruction affiche un dialogue simple d'édition de texte vous permettant de saisir un petit texte.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne pour préremplir la ligne d'édition)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (titre du dialogue d'édition)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (facultatif : texte d'information sur la nature de al saisie) peut contenir les mentions suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> sera considéré comme le chemin d'un fichier à charger et alors le nom de ce fichier peut contenir les mentions suivantes.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (facultatif : répertoire où se trouvent les images) peut contenir les mentions suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br />                  par défaut, le répertoire des images est celui de l'éventuel fichier indiqué à la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> du Paramètre N° 1.<br /><br /></span><span style="font-size:9pt;font-weight:600">Exemple</span><span style="font-size:9pt"> : {{:: LINE_EDIT (Ligne de texte en édition, test de l'édition)}} affichera le dialogue suivant :<br /><br /></span><img src=Macro-LigneEdit.png ><br /><br /><span style="font-size:9pt;font-weight:600">Exemple</span><span style="font-size:9pt"> : <br /><br />     {{:: LINE_EDIT (Ligne de texte en édition, test de l'édition,</span><span style="font-size:9pt;font-weight:600">$File../../Doc/index.html</span><span style="font-size:9pt">)}} <br /><br />affichera le dialogue suivant :<br /></span><img src=LigneEditExemple.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">Exemple</span><span style="font-size:9pt"> : <br /><br />          {{:: LINE_EDIT (3000, Période du timer, Nouvelle période pour le timer : &lt;br&gt;* si négatif le timer sera activé juste une fois pour la période définie.&lt;br&gt;* si positif le timer sera activé à chaque période.&lt;br&gt;* zéro le timer s'arrête et n'est plus actif., paramétrage d'un menu timer)}}<br /><br />affichera le dialogue suivant :<br /></span><img src=LigneEditExemple1.png ><br /><br /><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.92</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{SQL_GET_DOSS_GUID}}</span><span style="font-size:9pt"><br />Cette instruction affiche le GUID (identifiant unique) du dossier en cours, instruction utile pour les appels aux programmes externes et instructions SQL.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{GET_DOSS_GUID}} {{GET_DOSS_GUID}} {{GUID}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.93</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{SQL_GET_DOSS_PK}}</span><span style="font-size:9pt"><br />Cette instruction affiche la clef primaire du dossier en cours, instruction utile pour les appels aux programmes externes et instructions SQL.<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.94</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{OS}}</span><span style="font-size:9pt"><br />Cette instruction, utile pour les possesseurs de chien, retourne L'OS en cours.</span></p>
<ul type="disc"><div><span style="font-size:9pt;font-weight:600;color:#aa0000">W</span><span style="font-size:9pt"> si </span><span style="font-size:9pt;font-weight:600">W</span><span style="font-size:9pt">indows<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">M</span><span style="font-size:9pt"> Si </span><span style="font-size:9pt;font-weight:600">M</span><span style="font-size:9pt">acOS<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000">L</span><span style="font-size:9pt"> Si </span><span style="font-size:9pt;font-weight:600">L</span><span style="font-size:9pt">inux</span></div></ul>
<p><hr><span style="font-size:9pt;font-weight:600">4.5.3.95</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: APPEND_DOC_IN_CLASSEUR (hierarchie, forcerInsertion)}}</span><span style="font-size:9pt"><br />Cette instruction de classement automatique est celle qui va permettre à un document d'indiquer lors de sa création<br />et insertion par l'utilisateur, l'endroit où il doit être classé dans la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (hiérarchie de classeurs indiquant le classeur final où doit être classé le document) .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (ce paramètre détermine le devenir d'un document si il n'a pas pu être classé dans la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">)</span></p>
<ul type="disc"><div><span style="font-size:9pt">Lorsque le classeur de destination indiqué par le </span><span style="font-size:9pt;font-weight:600">paramètre N°1</span><span style="font-size:9pt"> (hiérarchie de classeurs de destination)<br />n'est pas accessible (n'existe pas, inaccessible pour ce profil ou ce filtre, etc ...)<br />° si ce paramètre est </span><span style="font-size:9pt;font-weight:600">supérieur à 0 (zéro),</span><span style="font-size:9pt"> le document sera </span><span style="font-size:9pt;font-weight:600">ajouté et créé mais non classé dans la Vigie</span><span style="font-size:9pt">.<br />° si ce paramètre est </span><span style="font-size:9pt;font-weight:600">à zéro, le document ne sera ni classé ni ajouté ou créé</span><span style="font-size:9pt">.</span></div></ul>
<p><span style="font-size:9pt;text-decoration:underline">Exemple</span><span style="font-size:9pt"> :<br />dans cet exemple, le document ayant ces macros-instructions sera classé dans deux classeurs à la fois.<br />Si le classement dans un des classeurs échoue, le document sera tout de même créé (forcerInsertion à 1).<br /><br /></span><span style="font-style:italic;font-size:9pt">{{\<br />{{::Append_doc_in_classeur (Classeur_Médecine_Générale/Non classés, 1)}}\<br />{{::Append_doc_in_classeur (Historique du dossier, 1)}}\<br />}}</span></p>
<p><hr><span style="font-size:9pt;font-weight:600">4.5.3.96</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{DOC_TYPE=Prescription, 1}}</span><span style="font-size:9pt"><br />Cette instruction placée en début de document indique et force une rubrique de destination dans laquelle le document doit être placé lors de son chargement.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (Rubrique de destination du document)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (facultatif) si 1, il n'est pas posé de question au cas où un document est déjà existant à cette date. <br /></span><br /><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.97</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{GET_SELECTION=Nom de la variable}}</span><span style="font-size:9pt"><br />Cette instruction retourne le texte sélectionné dans le texte en cours.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (facultatif) modificateur de méthode<br />Si ce paramètre est égal à la valeur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File </span><span style="font-size:9pt">alors la sélection sera écrite sur le disque dans le fichier indiqué à la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> .<br />Si ce paramètre est égal à la valeur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Paste </span><span style="font-size:9pt">alors la méthode de sélection sera un copy/paste (parfois meilleurs résultats) .<br />Sinon ce paramètre indique le nom d'une variable à initialiser avec le contenu de la sélection. Idem à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: VAR_SET(Nom de la variable, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Selection</span><span style="font-size:9pt;font-weight:600;color:#aa0000">}}</span><span style="font-size:9pt"><br /><br /></span><br /><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.98</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: VAR_SET(Nom de la variable, valeur de la variable)}}</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{:: SET_VAR(nom de la variable, valeur de la variable)}}<br />Cette instruction positionne la variable '</span><span style="font-style:italic;font-size:9pt">Nom de la variable'</span><span style="font-size:9pt"> indiquée par le premier paramètre, sur la valeur indiqué dans le deuxième paramètre. Cette instruction est utile pour stocker un résultat provenant d'une série de macro complexes. Par la suite, il suffira juste d'utiliser {{VAR=Nom de la variable}} pour récupérer la valeur sans avoir à effectuer ni réécrire la macro complexe.<br /><br /></span><span style="font-family:Luxi Mono;font-size:8pt">Si le paramètre d'une macro commençe par le </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$</span><span style="font-family:Luxi Mono;font-size:8pt"> exemple </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$MaVariable</span><span style="font-family:Luxi Mono;font-size:8pt"> c'est alors<br /></span><span style="font-family:Luxi Mono;font-size:8pt;text-decoration:underline">le contenu de la variable</span><span style="font-family:Luxi Mono;font-size:8pt"> </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">MaVariable</span><span style="font-family:Luxi Mono;font-size:8pt"> indiquée après le symbole </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$</span><span style="font-family:Luxi Mono;font-size:8pt"> qui sera transmis comme<br />paramètre d'appel et non simplement le texte. Ceci est équivalent à </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">{{MaVariable}}<br /></span><span style="font-family:Luxi Mono;font-size:8pt">mais beaucoup plus rapide en éxécution, fiable et plus simple à écrire dans un script.<br />ne pas utiliser comme nom de variable les mots clefs réservés suivants :<br /><br />        </span><span style="font-family:Luxi Mono;font-size:8pt;font-weight:600;color:#aa0000">$END_WIDTH $File $Paste $WIDTH $allString $toInt $stopIfNotNum $IsAbsPath<br />        $IsBinPath $NoAddExe $toStdIn $NomPatient $PrenomPatient $DateDeb $DateFin<br />        $DateDebFiche $DateFinFiche $HeureDeb $HeureFin $NomRub $TitreRub $User<br />        $SignUser $NumFicheRub $GUIDPat $PkPat $pkFiche $Duree $NumFicheTot $Selection<br />        $VAR $SET_VAR $no key $TableName $USER_PARAM $TOEND $keepHtml<br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom de la variable)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (valeur de la variable) <br />              si cette valeur commence par le modificateur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Selection</span><span style="font-size:9pt"> alors elle sera initialisée avec le contenu du texte sélectionné dans l'éditeur de texte courant idem à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{GET_SELECTION=Nom de la variable}}</span><span style="font-size:9pt"><br />              si cette valeur commence par le modificateur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> alors ce qui suit la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> sera considéré comme le chemin d'un fichier à charger et alors le nom de ce fichier peut contenir les mentions suivantes :<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /><br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.99</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{VAR=Nom de la variable}}</span><span style="font-size:9pt"><br />Cette instruction place le contenu de la variable dont le nom est indiqué par le paramètre : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Nom de la variable</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom de la variable)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{PUT_VAR=nom de la variable}}</span></p>
<p><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.100</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: LIST_DIR (repertoire, filtre, extension, sep, 1) }}</span><span style="font-size:9pt"><br />Cette instruction crée une chaîne constituée de tous les éléments trouvés dans le répertoire spécifié dans le paramètre </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">N° 1</span><span style="font-size:9pt"> , séparés par le séparateur indiqué par le terme </span><span style="font-size:9pt;font-weight:600">sep</span><span style="font-size:9pt">.<br />La liste peut être filtrée par un filtre sur les extensions et sur les nom des fichiers.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom du répertoire dont il faut lister le contenu)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (liste de chaînes validantes : facultative) <br />Liste des chaînes validantes séparées par le séparateur sep, qui, si une est contenue dans le nom d'un des éléments du répertoire, retient cet élément comme à inclure dans la liste.<br />Si cette liste est vide, il ne sera pas tenu compte de cette liste.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (liste des extensions validantes : facultative)<br />Liste des extensions validantes séparées par le séparateur sep, qui si une est contenue dans l'extension d'un des éléments du répertoire, retient cet élément comme à inclure dans la liste.<br />Si cette liste est vide, il ne sera pas tenu compte de cette liste.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (séparateur : falcultatif)<br />si non indiqué par défaut, est égal à |<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (nature de la liste : falcultatif)<br />si non indiqué par défaut, est égal à 0<br />si à 1 alors il sera listé les répertoires.<br /><br /></span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.101</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: MESSAGE_ALERT (message, titre, bouton1, bouton2, bouton3, bouton4, hauteur, largeur, chemin des images) }}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">variante</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FORM_MESSAGE (message, titre, bouton1, bouton2, bouton3, bouton4, hauteur, largeur, chemin des images) }}</span><span style="font-size:9pt"><br /><br />Cette instruction affiche un dialogue à choix multiples constitué d'un texte d'information et d'un maximum de quatre boutons de choix.<br />Le texte retourné est celui du bouton cliqué.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (message du texte d'information) qui, si commence par<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> sera considéré comme le chemin d'un fichier à charger et alors le nom de ce fichier peut contenir les mentions suivantes.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (titre du dialogue : facultatif) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3 à 6</span><span style="font-size:9pt"> (texte des boutons : facultatif) si aucun bouton n'est défini, le bouton par défaut </span><span style="font-size:9pt;font-weight:600">ok</span><span style="font-size:9pt"> est activé. Cela permet d'afficher très simplement un texte d'information.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt"> (largeur du dialogue : facultatif) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 8</span><span style="font-size:9pt"> (hauteur du dialogue : facultatif) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 9</span><span style="font-size:9pt"> (répertoire où se trouvent les images : facultatif) peut contenir les mentions suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br />                  par défaut, le répertoire des images est celui de l'éventuel fichier indiqué à la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> du Paramètre N° 1.<br /></span><span style="font-size:9pt;text-decoration:underline">Exemple</span><span style="font-size:9pt"> :<br /><br />                  {{::#MESSAGE_ALERT (</span><span style="font-size:9pt;font-weight:600;color:#ff5500">message de test</span><span style="font-size:9pt;color:#ff5500"> </span><span style="font-size:9pt">pour vous </span><span style="font-size:9pt;text-decoration:underline">pour démonstration de l'instruction \<br /></span><span style="font-size:9pt">                  </span><span style="font-size:9pt;font-weight:600">MESSAGE_ALERT il est même possible d'y placer des images\</span><span style="font-weight:600"><br /></span><span style="font-size:9pt">                  </span><img src=./MedinTuxLogoHttp-300-200.png >,\<br /><span style="font-size:9pt">                  exemple MESSAGE ALERT, bouton1, bouton2, bouton3, bouton4, 450, 250) }}</span><br /><br /><span style="font-size:9pt">affichera la boîte de dialogue suivante :<br /></span><br /><span style="font-size:9pt">                  </span><img src=FormAlert.png ><span style="font-size:9pt"><br /><br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple</span><span style="font-size:9pt"> : <br />                  </span><span style="font-size:9pt;font-weight:600">{{::#MESSAGE_ALERT ($File../../Doc/index.html,exemple MESSAGE ALERT, bouton1,,,, 470,220,../../Doc) }}<br /></span><span style="font-size:9pt">ou la variante (alors le répertoire des images sera déduit de</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">../../Doc/</span><span style="font-size:9pt;font-weight:600">index.html</span><span style="font-size:9pt"> )<br />                  </span><span style="font-size:9pt;font-weight:600">{{::#MESSAGE_ALERT ($File../../Doc/index.html, exemple MESSAGE ALERT, bouton1,,,, 470,220) }}<br /></span><span style="font-size:9pt"><br />affichera la boîte de dialogue suivante :<br /><br />                  </span><img src=FormAlertFile.png ><span style="font-size:9pt"><br /><br /></span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.102</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: MESSAGE_POPUP (message, chemin bitmap, tempo) }}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">variante</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FORM_POPUP_MESSAGE (message, chemin bitmap, tempo) }}</span><span style="font-size:9pt"><br />Cette instruction affiche un petit texte dans un popup surgissant en bas à droite de l'écran, pour par exemple signaler pourquoi une action est sans effet.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (texte du message à afficher)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (chemin du bitmap à afficher : facultatif) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (temps de persistance du popup à l'écran en milli secondes : facultatif et alors par défaut 1000 ms soit 1 seconde)<br /><br /></span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.103</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FORM_DATE (05-06-1956, titre du dialogue , format de retour, liste de présélection de dates}}</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (date à prépositionner) format dd-MM-yyyy<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (titre du dialogue : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">Choix dans la date</span><span style="font-size:9pt">) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (format de retour : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy</span><span style="font-size:9pt">) voir en paragraphe <a name="3.4.3.5  Trucs et astuces du texte d'une option"></a></span><span style="font-weight:600">3.4.3.5</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (menu de présélection des dates: facultatif) ce paramètree permet de positionner un bouton de menu avec une présélection de dates<br />chacune des options de ce menu est séparée de l'autre par le séparateur '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">|</span><span style="font-size:9pt">' . La syntaxe d'une option est la suivante :<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h + 1 jour</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour plus un jour<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h + 8 jours</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour plus huit jours<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h - 8 jours</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour moins huit jours etc ....<br /><br /></span><span style="font-style:italic;font-size:9pt">exemple </span><span style="font-size:9pt">: </span><span style="font-size:9pt;color:#aa0000">{{:: FORM_DATE ({{dd-MM-yyyy}}, titre du dialogue ,dd-MM-yyyy, Ce jour à 8:00 h|Ce jour à 8:00 h + 1 jour|Ce jour à 8:00 h + 2 jours|Ce jour à 8:00 h + 3 jours|Ce jour à 8:00 h + 4 jours|Ce jour à 8:00 h + 6 jours|Ce jour à 8:00 h + 8 jours|Ce jour à 8:00 h + 15 jours)}}</span><span style="font-size:9pt"><br /><br /></span><span style="font-style:italic;font-size:9pt">exemple de menu avec les jours mois et années et heures prépositionnées</span><span style="font-size:9pt"> : <br /></span>     <span style="font-size:9pt">Ce jour à 8:00 h - 2 jours|Ce jour à 8:00 h - 1 jour|Ce jour à 8:00 h - 24 h|Ce mois à 0:00 h|Ce mois à 0:00 h - 1 mois|Cette année à  0:00 h|Cette année à  0:00 h - 1 an<br /><br /><br /></span><img src=FormDate.png ><br /><span style="font-size:9pt"><br /></span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.104</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FORM_HEURE (12:45:32, format de retour}}}</span><span style="font-size:9pt"><br />Cette instruction affiche le dialogue de choix de l'heure et en retourne l'heure saisie selon le paramètre : format de retour .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (heure à prépositionner : facultatif et par défaut l'heure courante) format hh:mm:ss<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (format de retour : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">hh:mm:ss</span><span style="font-size:9pt">) voir en paragraphe </span><span style="font-weight:600">3.4.3.5</span><span style="font-size:9pt"><br /><br /></span><img src=FormHeure.png ><span style="font-size:9pt"><br /><br /></span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.105</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FORM_DATE_HEURE (05-06-1956, 12:30:45, titre du dialogue , format de retour date, format de retour heure, séparation, , liste de présélection de dates}}</span><span style="font-size:9pt"><br />Cette instruction affiche le calendrier et l'heure pour choisir une date et une heure et en retourne la valeur saisie selon le format indiqué dans le quatrième et cinquième paramètre : format de retour .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (date à prépositionner : facultatif et par défaut la date courante) format dd-MM-yyyy<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (heure à prépositionner : facultatif et par défaut l'heure courante) format hh:mm:ss<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (titre du dialogue : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">saisie de la date et de l'heure</span><span style="font-size:9pt">)<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (format de retour pour la date : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy</span><span style="font-size:9pt">) voir en paragraphe </span><span style="font-weight:600">3.4.3.5</span><span style="font-size:9pt"> <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (format de retour pour l'heure : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">hh:mm:ss</span><span style="font-size:9pt">) voir en paragraphe </span><span style="font-weight:600">3.4.3.5 </span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (texte à placer entre la date et l'heure : facultatif et par défaut un </span><span style="font-size:9pt;font-weight:600">espace</span><span style="font-size:9pt">) <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt"> (menu de présélection des dates: facultatif) ce paramètre permet de positionner un bouton de menu avec une présélection de dates<br />chacune des options de ce menu est séparée de l'autre par le paramètre '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">|</span><span style="font-size:9pt">' . La syntaxe d'une option est la suivante :<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h + 1 jour</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour plus un jour<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h + 8 jours</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour plus huit jours<br /></span>     <span style="font-size:9pt;font-weight:600">Ce jour à 8:00 h - 8 jours</span><span style="font-size:9pt"> pour une option repositionnant à la date du jour moins huit jours etc ....<br /><br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemple</span><span style="font-style:italic;font-size:9pt"> </span><span style="font-size:9pt">: </span><span style="font-style:italic;font-size:9pt;font-weight:600">{{:: </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">FORM_DATE_HEURE</span><span style="font-style:italic;font-size:9pt;font-weight:600"> ( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00aa00">{{dd-MM-yyyy}}</span><span style="font-style:italic;font-size:9pt;font-weight:600">, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00aa00">08:00:00</span><span style="font-style:italic;font-size:9pt;font-weight:600">,</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#ffaa7f">saisie de l'heure et de la date</span><span style="font-style:italic;font-size:9pt;font-weight:600">,dd-MM-yyyy, hh:mm, à , </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 24 hr</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 2 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 3 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 4 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 6 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 8 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">|</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa55ff">Ce jour à 8:00 h + 15 jours</span><span style="font-style:italic;font-size:9pt;font-weight:600">)}}</span><span style="font-size:9pt"><br /><br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemple de menu avec les jours mois et années et heures prépositionnées</span><span style="font-size:9pt;text-decoration:underline"> </span><span style="font-size:9pt">:<br /></span>     <span style="font-size:9pt">Ce jour à 8:00 h - 2 jours|Ce jour à 8:00 h - 1 jour|Ce jour à 8:00 h - 24 h|Ce mois à 0:00 h|Ce mois à 0:00 h - 1 mois|Cette année à  0:00 h|Cette année à  0:00 h - 1 an<br /></span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> : <br /></span><span style="font-style:italic;font-size:9pt;font-weight:600">en date du {{:: FORM_DATE_HEURE (05-06-1956, 12:30:45, saisie de l'heure et de la date,dd-MM-yyyy, hh:mm, à ) }}</span><span style="font-size:9pt"><br /><br />affichera le dialogue suivant :<br /></span><img src=FormDateHeure.png ></p>
<p><span style="font-size:9pt">qui après saisie donnera </span>: <span style="font-style:italic;font-size:9pt;font-weight:600">en date du 05-06-1956 à 12:30</span><br /><hr><span style="font-size:9pt;font-weight:600">4.5.3.106</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{REM= texte de votre choix }}</span><span style="font-size:9pt"><br />Cette instruction ne fait rien, et permet d'afficher un commentaire dans le texte de la macro .</span></p>
<p><hr><span style="font-size:9pt;font-weight:600">4.5.3.107</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: INCLUDE( chemin du fichier, modificateur ) }}</span><span style="font-size:9pt"><br />Cette instruction charge un fichier et en retourne le contenu.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chemin du fichier à charger)          peut contenir les mentions suivantes : <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (modificateur : facultatif) si contient : </span><span style="font-size:9pt;font-weight:600">crlf2html</span><span style="font-size:9pt"> alors les retours chariots seront conservés et convertis en </span><span style="font-size:9pt;font-weight:600">&lt;br&gt;</span><span style="font-size:9pt"> <br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.108</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: VAR_SPLIT( prefix, string to split , séparateur de début, </span><span style="font-size:9pt;color:#aa0000">FALSE</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> </span><span style="font-size:9pt;color:#aa0000">TRIMMED</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">, séparateur de fin) }}</span><span style="font-size:9pt"><br />Cette puissante instruction distribue les segments d'une chaîne séparés par un séparateur indiqué par le troisième argument : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">séparateur de début , </span><span style="font-size:9pt"><br />en plusieurs variables dont le nom est constitué par : le deuxième argument </span><span style="font-size:9pt;font-weight:600">auquel est ajouté l'occurrence du segment dans la chaîne</span><span style="font-size:9pt">.<br />Euh .. un exemple S.V.P.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom préfixé de la variable)         préfixe du nom de la variable auquel sera ajoutée l'occurrence du segment dans la chaîne.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (chaîne de caractères à séparer)    exemple '</span><span style="font-style:italic;font-size:9pt;font-weight:600">premier segment | deuxième segment | troisième segment</span><span style="font-size:9pt">'.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (séparateur facultatif)        contient  le séparateur. Si vide il sera pris par défaut le séparateur </span><span style="font-size:9pt;font-weight:600;color:#aa0000">|</span><span style="font-size:9pt"> <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (modificateurs comportementaux)    ce paramètre peut contenir les termes suivants<br />                  </span><span style="font-size:9pt;font-weight:600;color:#aa0000">FALSE</span><span style="font-size:9pt;color:#aa0000"> </span><span style="font-size:9pt">(la première lettre '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">F</span><span style="font-size:9pt">' est suffisante) si à FALSE alors si un </span><span style="font-size:9pt;text-decoration:underline">segment est vide</span><span style="font-size:9pt">, il n'y aura </span><span style="font-size:9pt;text-decoration:underline">pas de variable affectée</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#aa0000">TRIMMED</span><span style="font-size:9pt"> (la première lettre '</span><span style="font-size:9pt;font-weight:600;color:#aa0000">T</span><span style="font-size:9pt">' est suffisante) si TRIMMED les espaces de fin et de début du segment sont éliminés.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (facultatif séparateur de fin) si ce paramètre est indiqué alors le segment sera coupè à ce séparateur de fin.<br />                  si il n'est pas trouvé dans le segment, le segment sera mis à une valeur vide. <br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple</span><span style="font-size:9pt"> : cet exemple permet d'extraire une suite de codes cim10 encadrés par </span><span style="font-family:Monospace;font-size:8pt;font-weight:600;color:#aa0000">~[</span><span style="font-size:9pt"> et </span><span style="font-family:Monospace;font-size:8pt;font-weight:600;color:#aa0000">]~</span><span style="font-size:9pt"><br />° La macro suivante, <br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">{{:: Extract </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">(</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">Observation</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">,</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">CIM10Urg</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">,</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">POST URGENCE</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">)&gt;</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#005500">rpu_CIMX_BLOC</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">}}</span><span style="font-size:9pt"><br /><br />  a extrait dans la variable </span><span style="font-size:9pt;font-weight:600;color:#005500">rpu_CIMX_BLOC,</span><span style="font-size:9pt"> à partir du document de la rubrique<br />  </span><span style="font-size:9pt;font-weight:600">Observation</span><span style="font-size:9pt"> en cours, le bloc de texte suivant :<br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt">principal :     amibiase ~[A06]~ <br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt">altération de l'état général ~[R53]~ <br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt">hypophyse ~[D35.2]~ <br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt">CIM10Urg associe 1 :  acouphènes ~[H93.1]~ <br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-family:Monospace;font-style:italic;font-size:8pt">CIM10Urg associe 2 : alcoolisme chronique ~[F10.2]~ </span><span style="font-size:9pt"><br /><br />° la macro suivante placée à la suite de la précedente,</span><span style="font-family:Monospace;font-size:8pt"><br /></span><span style="font-size:9pt">                 </span><span style="font-style:italic;font-size:9pt"> </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">{{:: VAR_SPLIT</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">(</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">rpu_cimx_item_</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">, </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">$</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#005500">rpu_CIMX_BLOC</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f"> </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">,</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#55007f">~[</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">,</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">FALSE TRIMMED</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">,</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#55007f">]~</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#ff0000">)</span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#00007f">}}</span><span style="font-family:Monospace;font-size:8pt"><br /><br /></span><span style="font-size:9pt">  </span><span style="font-family:Monospace;font-size:8pt">placera dans les variables </span><span style="font-family:Monospace;font-size:8pt;font-weight:600">rpu_cimx_item_0</span><span style="font-family:Monospace;font-size:8pt"> à </span><span style="font-family:Monospace;font-size:8pt;font-weight:600">rpu_cimx_item_xx</span><span style="font-family:Monospace;font-size:8pt"> <br /></span><span style="font-size:9pt">  </span><span style="font-family:Monospace;font-size:8pt">toutes</span><span style="font-size:9pt"> les occurences des chaines de textes encadrées par </span><span style="font-family:Monospace;font-size:8pt;font-weight:600;color:#aa0000">~[</span><span style="font-size:9pt"> et </span><span style="font-family:Monospace;font-size:8pt;font-weight:600;color:#aa0000">]~</span><span style="font-family:Monospace;font-size:8pt"> <br /></span><span style="font-size:9pt">  </span><span style="font-family:Monospace;font-size:8pt">trouvées dans</span><span style="font-size:9pt"> </span><span style="font-family:Monospace;font-size:8pt">le bloc texte contenu dans la variable </span><span style="font-family:Monospace;font-style:italic;font-size:8pt;font-weight:600;color:#005500">rpu_CIMX_BLOC</span><span style="font-family:Monospace;font-size:8pt"><br /><br /></span><span style="font-size:9pt">° l</span><span style="font-family:Monospace;font-size:8pt">es macros suivantes,</span><span style="font-size:9pt"><br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_0</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_0}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_1</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_1}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_2</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_2}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_3</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_3}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_4</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_4}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_5</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_5}}'<br /></span><span style="font-style:italic;font-size:9pt;color:#00007f">                  </span><span style="font-family:Monospace;font-style:italic;font-size:9pt;font-weight:600;color:#00007f">rpu_cimx_item_6</span><span style="font-family:Monospace;font-style:italic;font-size:9pt;color:#00007f"> : '{{VAR=rpu_cimx_item_6}}'</span><span style="font-family:Monospace;font-size:9pt"><br /><br /></span><span style="font-size:9pt">  </span><span style="font-family:Monospace;font-size:9pt">afficheront alors les résultats suivants :<br /></span><span style="font-style:italic;font-size:9pt">                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_0</span><span style="font-style:italic;font-size:9pt"> : 'A06'<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_1</span><span style="font-style:italic;font-size:9pt"> : 'R53'<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_2</span><span style="font-style:italic;font-size:9pt"> : 'D35.2'<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_3</span><span style="font-style:italic;font-size:9pt"> : 'H93.1'<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_4</span><span style="font-style:italic;font-size:9pt"> : 'F10.2'<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_5</span><span style="font-style:italic;font-size:9pt"> : ''<br />                  </span><span style="font-style:italic;font-size:9pt;font-weight:600">rpu_cimx_item_6</span><span style="font-style:italic;font-size:9pt"> : ''</span><span style="font-size:9pt"><br /><br /><br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.109</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{VAR_LIST_CLEAR}}</span><span style="font-size:9pt"> Cette instruction détruit toutes les variables afin de réinitialiser la liste des variables.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.110</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_EMAIL_MEDECIN}}</span><span style="font-size:9pt"> Retourne l'email du médecin en cours d'utilisation du programme.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.111</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_TEL_1_MEDECIN}}</span><span style="font-size:9pt"> Retourne le premier numéro de téléphone du médecin en cours d'utilisation du programme.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.112</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_TEL_2_MEDECIN}} </span><span style="font-size:9pt">Retourne le deuxième numéro de téléphone du médecin en cours d'utilisation du programme.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.113</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_TEL_3_MEDECIN}} </span><span style="font-size:9pt">Retourne le troisième numéro de téléphone du médecin en cours d'utilisation du programme.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.114</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{EMAIL_MEDECIN}}</span><span style="font-size:9pt"> Cette instruction retourne l'email du médecin auteur du document en cours.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.115</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{TEL_1_MEDECIN}}</span><span style="font-size:9pt"> Cette instruction retourne le premier numéro de téléphone du médecin auteur du document en cours.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.116</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{TEL_2_MEDECIN}} </span><span style="font-size:9pt">Cette instruction retourne le deuxième numéro de téléphone du médecin auteur du document en cours.<br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.117</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{TEL_3_MEDECIN}} </span><span style="font-size:9pt">Cette instruction retourne le troisième numéro de téléphone du médecin auteur du document en cours.<br /><br /><br /></span><hr><span style="font-size:9pt;font-weight:600">4.5.3.118</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{::#CADRE(largeur, epaisseur du bord, marge, espace entre cellules, justification, séparateur de ligne, cadre N°1, cadre N°2, cadre N°2, ....)}} <br /></span><span style="font-size:9pt">Cette instruction permet de présenter un affichage sous forme de cadres horizontaux. Elle est utile par exemple dans les documents types pour afficher un cadre gauche avec les coordonnées du médecin, un cadre central avec les caractéristiques du documents, un cadre droit avec les coordonnées du destinataire.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (largeur totale du cadre) est exprimé en pixels mais peut être exprimé en </span><span style="font-size:9pt;font-weight:600">%</span><span style="font-size:9pt"> de la largeur totale alors il faut faire suivre la valeur par le caractère </span><span style="font-size:9pt;font-weight:600">%</span><span style="font-size:9pt"> exemple </span><span style="font-size:9pt;font-weight:600">100%</span><span style="font-size:9pt"> .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (épaisseur du cadre) si zéro, le cadre ne sera pas dessiné.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (marge interne) marge interne au cadre en pixels.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (espace entre cellules)  en pixels.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (justification du cadre général) </span><span style="font-size:9pt;font-weight:600">left, center, right</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt"> (motif à utiliser à la place des retours chariots \r\n ) en général </span><span style="font-size:9pt;font-weight:600">&lt;br&gt;</span><span style="font-size:9pt"> .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7 à 7+N</span><span style="font-size:9pt"> (contenu de chaque cadre) chacun de ces paramètres sera considéré comme un cadre, par défaut la largeur de chaque cadre sera celle générale définie par le paramètre N°1 divisé par le nombre de cadres. Cependant, si la définition d'un cadre comporte le motif suivant : </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$WIDTH</span><span style="font-size:9pt"> </span><span style="font-size:9pt;color:#ff0000">30%</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$END_WIDTH</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">encadrant une valeur, celle-ci sera utilisée à la place de celle par défaut. <br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Exemple avancé de macro à placer dans l'en-tête d'un document pour choisir et afficher l'adresse d'un médecin correspondant lors d'une impression</span><span style="font-size:9pt"> : <br /><br />Lors d'une impression avec cet en-tête, il est demandé de choisir le médecin auquel est destiné le document dans une liste </span><span style="font-style:italic;font-size:8pt;font-weight:600">DO_LISTE</span><span style="font-size:9pt"> qui présente le résultat d'une requête SQL </span><span style="font-style:italic;font-size:8pt;font-weight:600">SQL_SELECT</span><span style="font-size:9pt"> listant tous les médecins correspondants. <br />Si la liste est quittée sans choix </span><span style="font-style:italic;font-size:8pt;font-weight:600">{{VAR=retour}} = Rejected</span><span style="font-size:9pt"> l'impression sera annulée car il sera placé la mention </span><span style="font-style:italic;font-size:8pt;font-weight:600">$PRINT_STOP</span><span style="font-size:9pt"> <br />Si il est choisi un correspondant, ses coordonnées postales seront affichées dans un cadre en haut à droite du document afin de pouvoir poster directement le document dans une enveloppe à fenêtre. <br /></span><span style="font-size:9pt;font-weight:600">Remarquez l'astuce</span><span style="font-size:9pt"> qui consiste a créer une variable </span><span style="font-family:Courier;font-size:9pt;font-weight:600">actionDoListe</span><span style="font-size:9pt"> contenant elle même l'instruction </span><span style="font-size:9pt;font-weight:600">DO_LISTE</span><span style="font-size:9pt"> (présente une liste) ou </span><span style="font-size:9pt;font-weight:600">M_NOP</span><span style="font-size:9pt"> (ne fait rien) selon le résultat du test du statut d'exécution de la macro. <br /></span><span style="font-size:9pt;font-weight:600">Remarquez le choix</span><span style="font-size:9pt"> du séparateur de champ particulier </span><span style="font-size:9pt;font-weight:600">::</span><span style="font-size:9pt"> pour que </span><span style="font-size:9pt;font-weight:600">DO_LISTE</span><span style="font-size:9pt"> puisse afficher les items composés de plusieurs champs, avec masquage de la dernière donnée (</span><span style="font-family:Courier;font-size:9pt">ID_PrimKey)</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">La Macro</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-family:Courier;font-size:9pt">{{\<br />{{REM= ---------------------- test du statut d'impression -----------------------------}}\<br />{{REM= ne faire appel à la liste des medecins }}\<br />{{REM= que si il n'y a pas encore eu de resolution }}\<br />{{REM= de macro lors de l'impression }}\<br />{{REM= sous Mac DO_LISTE ne doit pas etre re-executee lors }}\<br />{{REM= d'un changement d'en-tete }}\<br /><br />{{:: SET_VAR(actionDoListe,{{:: TEST(S,{{VAR=$SCRIPT_STATUS}},=,$PRINT_SCRIPT_END,M_NOP,DO_LISTE)}})}}\<br />{{:: SET_VAR(actionDoListe,{{:: TEST(S,{{OS}},=,M,{{:: TEST(S,{{VAR=$SCRIPT_STATUS}},=,$PRINT_HEADER_CHANGED,M_NOP,{{VAR=actionDoListe}})}},{{VAR=actionDoListe}})}})}}<br />{{:: SET_VAR(resultatDoListeEnteteCourrier,{{::{{VAR=actionDoListe}}({{::#SQL_SELECT (Personnes , Nom |Prenom|ID_PrimKey,WHERE NumOrdre!='' , 30,::,|) }},Choix du mécecin destinataire,|,retourChoixMedecinPrint,2)}})}}\<br />{{:: VAR_SPLIT(AdressePar_,{{VAR=resultatDoListeEnteteCourrier}},::)}}\</span></p>
<p><span style="font-family:Courier;font-size:9pt">{{REM= -------------- utilisation par la suite des renseigments du choix --------------}}\<br />{{REM= pour selectionner les renseignements du destinataire }}\<br />{{:: SQL_SELECT (Personnes,Nom|Prenom|Adresse|CodePostal|Ville|ID_PrimKey,WHERE ID_PrimKey='{{VAR=AdressePar_2}}',1,$SET_VAR)}}\</span></p>
<p><span style="font-family:Courier;font-size:9pt">{{REM= -------------- creation des variables des contenus des cadres -----------------}}\<br />{{::#SET_VAR(cadreGauche,&lt;center&gt;{{TITRE PS}} {{NOM PRENOM MEDECIN}}&lt;br&gt;{{IDENTIFICATION MEDECIN}}&lt;br&gt;{{CONVENTION MEDECIN}}&lt;br&gt;{{USER ADRESSE COMPLETE MEDECIN}}&lt;br&gt;Tél. {{TEL_1_MEDECIN}})}}\<br />{{::#SET_VAR(cadreCentral, )}}\<br />{{::#SET_VAR(cadreDestinataire,&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;{{VAR=Personnes.Nom0}} {{VAR=Personnes.Prenom0}}&lt;br&gt;{{VAR=Personnes.Adresse0}}&lt;br&gt;{{VAR=Personnes.CodePostal0}} {{VAR=Personnes.Ville0}})}}\<br /><br />{{REM= -------------- si choix annuler stocker la mention $PRINT_STOP ----------------}}\<br />{{REM= d'annulation de l'impression dans retourChoixMedecinPrint }}\<br />{{::#SET_VAR(retourChoixMedecinPrint,{{::#TEST(S,{{VAR=retourChoixMedecinPrint}},=,Rejected,$PRINT_STOP,)}})}}\<br />}}<br />{{REM= -------------- affichage des cadres -------------------------------------------}}<br />{{::#CADRE(100%,0, 0 ,0 ,right,&lt;br&gt;,$WIDTH 25% $END_WIDTH{{VAR=cadreGauche}},$WIDTH 45% $END_WIDTH{{VAR=cadreCentral}},$WIDTH 30% $END_WIDTH{{VAR=cadreDestinataire}})}}<br />{{REM= ----------------------- si choix annuler afficher $PRINT_STOP -----------------}}<br />{{REM= que si il n'ya pas de changement d'entete }}<br />{{:: TEST(S,{{VAR=$SCRIPT_STATUS}},=,$PRINT_HEADER_CHANGED, ,{{VAR=retourChoixMedecinPrint}})}}<br /></span><span style="font-style:italic;font-size:8pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Exemple avancé de macro à placer dans un modèle de document pour choisir un médecin correspondant destinataire</span><span style="font-size:9pt"> : <br /><br />Lors du double clic d'un document dans le </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">, cette macro propose et affiche la liste des médecins correspondants et après choix positionne un cadre texte avec les coordonnées du médecin auteur du courrier ou document et dans un autre cadre les coordonnées du destinataire du document dans un cade prêt à poster.<br />S'il est choisi un correspondant, ses coordonnées postales seront affichées dans un cadre en haut à droite du document afin de pouvoir poster directement le document dans une enveloppe à fenêtre. <br /></span><span style="font-size:9pt;font-weight:600">Remarquez l'astuce</span><span style="font-size:9pt"> qui consiste a créer une variable </span><span style="font-family:Courier;font-size:9pt;font-weight:600">actionDoListe</span><span style="font-size:9pt"> contenant elle même l'instruction </span><span style="font-size:9pt;font-weight:600">DO_LISTE</span><span style="font-size:9pt"> (présente une liste) ou </span><span style="font-size:9pt;font-weight:600">M_NOP</span><span style="font-size:9pt"> (ne fait rien) selon le résultat du test du statut d'exécution de la macro. <br /></span><span style="font-size:9pt;font-weight:600">Remarquez les doubles tests imbriqués</span><span style="font-size:9pt"> pour tester une valeur ou l'autre.<br /></span><span style="font-size:9pt;font-weight:600">Remarquez le retour</span><span style="font-size:9pt"> de la mention particulière </span><span style="font-size:9pt;font-weight:600">__ERREUR Fusion :__</span><span style="font-size:9pt"> lorsque la liste de choix a été quittée sans choix </span><span style="font-style:italic;font-size:8pt;font-weight:600">{{VAR=retour}} = Rejected</span><span style="font-size:9pt">, ayant pour conséquence la non incorporation du document dans MedinTux.<br /></span><span style="font-size:9pt;font-weight:600">Remarquez le choix</span><span style="font-size:9pt"> du séparateur de champ particulier </span><span style="font-size:9pt;font-weight:600">::</span><span style="font-size:9pt"> pour que </span><span style="font-size:9pt;font-weight:600">DO_LISTE</span><span style="font-size:9pt"> puisse afficher les items composés de plusieurs champs, avec masquage de la dernière donnée (</span><span style="font-family:Courier;font-size:9pt">ID_PrimKey)</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">La Macro</span><span style="font-size:9pt"> :<br /></span><span style="font-family:Courier;font-size:9pt"><br />{{\<br />{{REM= ---------------------- LA MACRO QUI TUE ----------------------------------------}}\<br />{{REM= test du statut du document pour }}\<br />{{REM= ne faire appel à la liste des medecins }}\<br />{{REM= que lors de l'incorporation du document et non }}\<br />{{REM= lors de la prévisualisation }}\<br />{{:: SET_VAR(actionDoListe,{{:: TEST(S,{{VAR=$SCRIPT_STATUS}},%%,$FUSION_ADD,DO_LISTE,{{:: TEST(S,{{VAR=$SCRIPT_STATUS}},%%,$FUSION_CREATE,DO_LISTE,M_NOP)}})}})}}\<br />{{:: SET_VAR(resultatDoListeEnteteCourrier,{{::{{VAR=actionDoListe}}({{::#SQL_SELECT (Personnes , Nom |Prenom|ID_PrimKey,WHERE NumOrdre!='' , 30,::,|) }},Choix du mécecin destinataire,|,retourChoixMedecin,2)}})}}\<br />{{:: VAR_SPLIT(AdressePar_,{{VAR=resultatDoListeEnteteCourrier}},::)}}\<br /><br />{{REM= -------------- utilisation par la suite des renseigments du choix --------------}}\<br />{{REM= pour selectionner les renseignements du destinataire }}\<br />{{:: SQL_SELECT (Personnes,Nom|Prenom|Adresse|CodePostal|Ville|ID_PrimKey,WHERE ID_PrimKey='{{VAR=AdressePar_2}}',1,$SET_VAR)}}\<br />{{REM= -------------- creation des variables des contenus des cadres -----------------}}\<br />{{::#SET_VAR(cadreGauche,&lt;center&gt;</span><span style="font-family:Courier;font-size:9pt;font-weight:600">{{TITRE PS}} {{NOM PRENOM MEDECIN}}&lt;br&gt;N° Adeli {{IDENTIFICATION MEDECIN}}</span><span style="font-family:Courier;font-size:9pt">&lt;br&gt;</span><span style="font-family:Courier;font-size:9pt;font-weight:600">{{CONVENTION MEDECIN}}</span><span style="font-family:Courier;font-size:9pt">&lt;/center&gt;&lt;p&gt;{{USER ADRESSE COMPLETE MEDECIN}}&lt;br&gt;</span><span style="font-family:Courier;font-size:9pt;font-weight:600">Tél.</span><span style="font-family:Courier;font-size:9pt"> </span><span style="font-family:Courier;font-style:italic;font-size:9pt">{{TEL_1_MEDECIN}}</span><span style="font-family:Courier;font-size:9pt">&lt;/p&gt;)}}\<br />{{::#SET_VAR(cadreCentral, )}}\<br />{{::#SET_VAR(cadreDestinataire,&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;{{VAR=Personnes.Nom0}} {{VAR=Personnes.Prenom0}}&lt;br&gt;{{VAR=Personnes.Adresse0}}&lt;br&gt;{{VAR=Personnes.CodePostal0}} {{VAR=Personnes.Ville0}})}}\<br />}}<br />{{REM= -------------- affichage des cadres -------------------------------------------}}\<br />{{::#CADRE(100%,0, 0 ,0 ,right,&lt;br&gt;,$WIDTH 25% $END_WIDTH{{VAR=cadreGauche}},$WIDTH 45% $END_WIDTH{{VAR=cadreCentral}},$WIDTH 30% $END_WIDTH{{VAR=cadreDestinataire}})}}<br />{{::#TEST(S,{{VAR=retourChoixMedecin}},=,Rejected,__ERREUR Fusion :__,)}}</span><span style="font-family:Comic Sans Ms"><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.119</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{NUM. CLEF PATIENT}}</span><span style="font-size:9pt"><br />Cette instruction retourne la clef du numéro de sécurité sociale du patient.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : {{NUM CLEF PATIENT}}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.120 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_POLITESSE_MEDECIN}}</span><span style="font-size:9pt"> retourne la mention indiquée dans le champ </span><span style="font-size:9pt;font-weight:600">Politesse</span><span style="font-size:9pt"> dans l'annuaire des utilisateurs, pour l'utilisateur en cours.<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.121 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{POLITESSE_MEDECIN}}</span><span style="font-size:9pt"> retourne la mention indiquée dans le champ </span><span style="font-size:9pt;font-weight:600">Politesse</span><span style="font-size:9pt"> dans l'annuaire des utilisateurs, pour l'utilisateur de l'observation en cours d'affichage.<br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.122 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: LEFT( chaîne à traiter, nombre de caractères)}} </span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (nombre ce caractères) nombre de caractères<br />retourne la partie gauche de la chaîne coupée au nombre de caractères indiqués dans le premier paramètre.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.123 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: MID(chaîne à traiter, position , nombre de caractères) }}</span><span style="font-size:9pt"> <br />retourne une partie de chaîne débutant à la position (comptée à partir de zéro) indiquée par le premier paramètre coupée au nombre de caractères indiqués dans le deuxième paramètre.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (position) position à partir de laaquelle il faut couper la chaîne<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (nombre ce caractères) nombre de caractères à retenir à partir de la position indiquée dans le premier paramètre. <br />ce paramètre est facultatif, si il est omis alors tous les caractères à partir de la position indiquée dans le premier paramètre seront retenus.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.124 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RIGHT(chaîne à traiter, nombre de caractères ) }}<br /></span><span style="font-size:9pt">retourne la partie droite de la chaîne coupée au nombre de caractères indiqués dans le premier paramètre.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (nombre ce caractères) nombre de caractères<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.125 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: REMOVE( chaîne à traiter , élément à retirer ) }}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RM( chaîne à traiter , élément à retirer ) }}<br /></span><span style="font-size:9pt">retire toutes les occurrences d'une chaîne de caractères d'une autre chaîne.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (facultatif élément à retirer) chaîne de caractères à retirer, si non précisé par défaut espace.<br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemple</span><span style="font-style:italic;font-size:9pt"> : {{:: REMOVE(tralala itou, a ) }} deviendra trllt itou</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.126 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: CLEAR_SPACES(chaîne à traiter) }}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: CS(chaîne à traiter) }}<br /></span><span style="font-size:9pt">retire tous les espaces, tabulations de début et de fin d'une chaîne de caractères.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemple</span><span style="font-style:italic;font-size:9pt"> : {{:: CS( texte ) }} deviendra 'texte'</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.127 </span><span style="font-size:9pt">|==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: T0_NUM( chaîne à traiter , mode) }}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: TN( chaîne à traiter , mode ) }}<br /></span><span style="font-size:9pt">Tente de transformer en nombre une chaîne de caractères.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne de caractères à traiter) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (mode de conversion) facultatif et par défaut positionné à </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$stopIfNotNum</span><span style="font-size:9pt"><br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$stopIfNotNum</span><span style="font-size:9pt"> la conversion s'arrête au premier caractère non numérique.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$allString</span><span style="font-size:9pt"> tous les caractères numériques de la chaîne seront retenus.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$toInt</span><span style="font-size:9pt"> la conversion ne conservera que la partie entière.<br /> SI    toute autre valeur, la conversion s'arrêtera à la première occurrence de cette valeur.<br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">exemples</span><span style="font-style:italic;font-size:9pt"> : <br /></span><span style="font-size:9pt"> </span><span style="font-size:9pt;color:#aa0000">     </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{:: TN</span><span style="font-style:italic;font-size:9pt;font-weight:600"> </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">1234.34 </span><span style="font-style:italic;font-size:9pt">ce texte suit la valeur et ne sera pas évalué car par défaut le mode est </span><span style="font-size:9pt">stopIfNotNum</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">) }} </span><span style="font-style:italic;font-size:9pt">deviendra '</span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">1234,34 '</span><span style="font-style:italic;font-size:9pt"><br /></span><span style="font-size:9pt">      </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{:: TN ( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">1234.34 </span><span style="font-style:italic;font-size:9pt">ce qui suit </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">56</span><span style="font-style:italic;font-size:9pt"> sera retenu car le mode est : allString </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">, $allString) }} </span><span style="font-style:italic;font-size:9pt">deviendra </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">'1234,3456 '<br /></span><span style="font-size:9pt">      </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">{{:: TN ( </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">1234.34 </span><span style="font-style:italic;font-size:9pt">ce qui suit </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">56</span><span style="font-style:italic;font-size:9pt"> sera retenu jusqu'à </span><span style="font-style:italic;font-size:9pt;font-weight:600">fin de la partie numérique </span><span style="font-style:italic;font-size:9pt">car indiqué en </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">2</span><span style="font-style:italic;font-size:9pt"> ème paramètre comme occurrence de fin </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">, fin de la partie numérique) }} </span><span style="font-style:italic;font-size:9pt">deviendra </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">'1234,3456 '</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.128</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{DATE NAISSANCE ASSURE=format de la date}}</span><span style="font-size:9pt"><br />retourne la date de naissance de l'assuré selon le format spécifié dans le paramètre facultatif N°1<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (format de retour pour la date : facultatif et par défaut </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy</span><span style="font-size:9pt">) voir en paragraphe </span><span style="font-weight:600">3.4.3.5</span><span style="font-size:9pt"> <br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.129</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{EXIT}}</span><span style="font-size:9pt"><br />exécute la procédure de fin de MedinTux. <br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.130</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{DDR=dd-MM-yyyy}}</span><span style="font-size:9pt"><br />retourne la date des dernières règles<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.131</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{TERME_GROSSESSE}}</span><span style="font-size:9pt"><br />retourne le nombre de semaines d'aménorrhée à la date courante.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.132</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DAYSTO( date de départ , date de fin )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DT( date de départ, date de fin ) }}</span><span style="font-size:9pt"><br />retourne le nombre de jours à partir de la date placée dans le parametre N°1 et le Paramètre N°2. Le format des dates doit être xxxx</span><span style="font-size:9pt;font-weight:600">dd</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">MM</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">yyyy</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">hh</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">mm</span><span style="font-size:9pt">xxx</span><span style="font-size:9pt;font-weight:600">ss</span><span style="font-size:9pt"> (voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">) où x peut représenter n'importe quel caractère non numérique. Les heures minutes secondes peuvent être omises et alors elles seront en interne mises sur 00:00:00<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (date de départ) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (facultatif : date de fin) si non précisé il prend la valeur de la date courante.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.133</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DATE_CALC( date de départ , valeur, operateur, valTyp, format date retour )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DTC( date de départ , valeur, operateur, valTyp, format date retour ) }}</span><span style="font-size:9pt"><br />retourne le nombre de jours à partir de la date placée dans le parametre N°1 et le Paramètre N°2. Le format des dates doit être xxxx</span><span style="font-size:9pt;font-weight:600">dd</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">MM</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">yyyy</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">hh</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">mm</span><span style="font-size:9pt">xxx</span><span style="font-size:9pt;font-weight:600">ss</span><span style="font-size:9pt"> (voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">) où x peut représenter n'importe quel caractère non numérique. Les heures minutes secondes peuvent être omises et alors elles seront en interne mises sur 00:00:00.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (date de départ) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (valeur à ajouter ou soustraire) valeur à ajouter ou soustraire<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (facultatif : opérateur) </span><span style="font-size:9pt;font-weight:600">+ -</span><span style="font-size:9pt"> par défaut (si omis) sur </span><span style="font-size:9pt;font-weight:600">+</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (facultatif : type de valeur à ajouter ou soustraire) si non précisé il prend la valeur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">J</span><span style="font-size:9pt"> (jours).<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">S           </span><span style="font-size:9pt">la valeur numérique à ajouter  est en secondes.<br /> SI   contient   </span><span style="font-size:9pt;font-weight:600;color:#0000ff">J</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">D</span><span style="font-size:9pt">  la valeur numérique à ajouter  est en jours.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">M         </span><span style="font-size:9pt"> la valeur numérique à ajouter  est en mois.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">A</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Y  </span><span style="font-size:9pt"> la valeur numérique à ajouter  est en années.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt"> (facultatif : format du type de date à retourner) Le format des dates. si non précisé </span><span style="font-size:9pt;font-weight:600">dd</span><span style="font-size:9pt">-</span><span style="font-size:9pt;font-weight:600">MM-yyyy </span><span style="font-size:9pt">(voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">) .<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.134</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DATE_TONUM( date de fin , valTyp, date de départ)}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DTN( date de fin , valTyp , date de départ) }}</span><span style="font-size:9pt"><br />retourne une valeur numerique entière (nombre de secondes) à partir de la date placée dans le parametre N°1 et le paramètre N°3. Le format des dates doit être xxxx</span><span style="font-size:9pt;font-weight:600">dd</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">MM</span><span style="font-size:9pt">xxxxxx</span><span style="font-size:9pt;font-weight:600">yyyy</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">hh</span><span style="font-size:9pt">xxxx</span><span style="font-size:9pt;font-weight:600">mm</span><span style="font-size:9pt">xxx</span><span style="font-size:9pt;font-weight:600">ss</span><span style="font-size:9pt">(voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">) où x peut représenter n'importe quel caractère non numérique. Les heures minutes secondes peuvent êtres omises et alors elle seront en interne mises sur 00:00:00.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (date de fin) chaîne de caractères à traiter.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (facultatif : type de valeur numérique à retourner) si non précisé il prend la valeur S (secondes).<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">S           </span><span style="font-size:9pt">la valeur numérique à retourner est en secondes.<br /> SI   contient  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">J</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">D</span><span style="font-size:9pt">   la valeur numérique à retourner est en jours.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">M         </span><span style="font-size:9pt"> la valeur numérique à retourner est en mois.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">A</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Y  </span><span style="font-size:9pt"> la valeur numérique à retourner est en années.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (facultatif : date de depart) si non précisé la valeur de depart est le </span><span style="font-size:9pt;font-weight:600">01 Janvier 1970</span><span style="font-size:9pt">.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.135</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DATE_FROMNUM( num, valTyp, format date retour, date de départ )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: DTFN( num , valTyp, format date retour, date de départ ) }}</span><span style="font-size:9pt"><br />retourne la date et temps depuis le nombre de secondes écoulées depuis le 01 Janvier 1970 (voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nombre de secondes) chaîne de caractères à traiter soit le nombre de secondes depuis le 01 Janvier 1970.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (facultatif : type de valeur numérique à retourner) si non précisé il prend la valeur S (secondes).<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">S           </span><span style="font-size:9pt">la valeur numérique est en secondes.<br /> SI   contient   </span><span style="font-size:9pt;font-weight:600;color:#0000ff">J</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">D</span><span style="font-size:9pt">  la valeur numérique est en jours.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">M         </span><span style="font-size:9pt"> la valeur numérique est en mois.<br /> SI   contient </span><span style="font-size:9pt;font-weight:600;color:#0000ff">A</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Y  </span><span style="font-size:9pt"> la valeur numérique est en années.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (facultatif : format du type de date à retourner) Le format des dates. si non précisé </span><span style="font-size:9pt;font-weight:600">dd</span><span style="font-size:9pt">-</span><span style="font-size:9pt;font-weight:600">MM-yyyy </span><span style="font-size:9pt">(voir : </span><a href="DrTux.html#Format_des_dates"><span style="font-size:9pt">Format des dates</span></a><span style="font-size:9pt">) .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (facultatif : date de depart) si non précisé la valeur de depart est le </span><span style="font-size:9pt;font-weight:600">01 Janvier 1970</span><span style="font-size:9pt">.<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.136</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: ABS_PATH( chemin de fichier exprimé en relatif)}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variantes</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: AP( chemin de fichier exprimé en relatif ) }} {{AP = chemin de fichier exprimé en relatif }} {{ABS_PATH = chemin de fichier exprimé en relatif }} </span><span style="font-size:9pt"><br />Converti le chemin donné dans le paramètre N°1 en chemin absolu.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chemin à convertir) chemin exprimé en relatif exemple : </span><span style="font-size:9pt;font-weight:600">../../Doc/index.html<br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600">{{AP = ../../Doc}}</span><span style="font-size:9pt"> devient </span><span style="font-size:9pt;font-weight:600">/home/ro/MedinTux-V2.14-Synth-src/Programmes/Doc/index.html</span><span style="font-size:9pt"><br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.137</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FILE_EXISTS( chemin de fichier à tester exprimé en relatif)}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt">s : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: FE( chemin de fichier à tester exprimé en relatif ) }} {{FE = chemin de fichier exprimé en relatif }} {{FILE_EXISTS = chemin de fichier à tester exprimé en relatif }} </span><span style="font-size:9pt"><br />Converti le chemin donné dans le paramètre N°1 en chemin absolu, et teste si il existe: <br />Si le fichier existe existe la valeur de retour est le resultat de la conversion.<br />Si le fichier n'existe pas la valeur de retour est une chaîne vide.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chemin à convertir) chemin exprimé en relatif exemple : </span><span style="font-size:9pt;font-weight:600">../../Doc/index.html<br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;text-decoration:underline">Exemples</span><span style="font-size:9pt"> : <br /></span><span style="font-size:9pt;font-weight:600">{{FE = ../../Doc/index.html}}</span><span style="font-size:9pt"> devient </span><span style="font-size:9pt;font-weight:600">/home/ro/MedinTux-V2.14-Synth-src/Programmes/Doc/index.html</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">{{FE = ../../Doc/truc_inexistant.html}}</span><span style="font-size:9pt"> devient une chaîne vide .<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.138</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: REPLACE_BY( chaîne à évaluer, élément à trouver, élément de remplacement )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RB( chaîne à évaluer, élément à trouver, élément de remplacement ) }}</span><span style="font-size:9pt"><br />remplace les occurrences d'un motif de caractères par un autre motif de caractères.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne à évaluer) chaîne de caractères à traiter .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (occurrence à remplacer) occurrence à remplacer.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (motif de caractères de remplacement) motif de caractères de remplacement</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">.<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.139</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: INDEX_OF( chaîne à évaluer, motif a rechercher )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: IO( chaîne à évaluer, motif a rechercher ) }}</span><span style="font-size:9pt"><br />retourne la position d'un motif de caractères dans une chaîne de caractères (-1 si pas trouvée).<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne à évaluer) chaîne de caractères à traiter .<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (motif à rechercher) motif à rechercher.<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.140</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: LENGTH( chaîne à évaluer )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: LEN( chaîne à évaluer ) }}</span><span style="font-size:9pt"><br />retourne le nombre de caractères d'une chaîne.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (chaîne à évaluer) chaîne de caractères à traiter .<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.141</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: EXPORT_TABLES( date de début, date de fin, definition des tables à exporter, separateur de table, largeur cellule par defaut, hauteur cellule par defaut, largeur du tracé, largeur totale du tableau, format d'affichage des dates, largeur de la colonne des dates )}}<br /></span><span style="font-size:9pt">Cette instruction a pour objectif de mettre en forme des données provenant de tables ou tableaux de variables du terrain de façon à les inclure dans vos documents .<br /><br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (première date à partir de laquelle afficher les données) :<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> soit la date est exprimée sous la forme : </span><span style="font-size:9pt;font-weight:600">YYYY-MM-DD</span><span style="font-size:9pt"> où YYYY est l'année, MM est le mois de l'année (entre 01 et 12), et DD est le jour du mois (entre 01 et 31). <br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> soit la date est exprimée sous la forme des formules préétablies suivantes :<br />                    TOUTE DATE        pas de limite inférieure.<br />                    DATE VISITE         date de l'observation en cours.<br />                    DATE ACTUELLE    date du jour en cours.<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> si absent alors il prendra la valeur de &quot;01-01-1900&quot;<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(date de fin pour afficher les données) :<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> soit la date est exprimée sous la forme : YYYY-MM-DD où YYYY est l'année, MM est le mois de l'année (entre 01 et 12), et DD est le jour du mois (entre 01 et 31). <br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> soit la date est exprimée sous les formes suivantes :<br />                    </span><span style="font-size:9pt;font-weight:600">+</span><span style="font-size:9pt"> suivi d'une valeur correspondant au nombre d'heures à rajouter à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : +24</span><span style="font-size:9pt"><br />                    </span><span style="font-size:9pt;font-weight:600">+-</span><span style="font-size:9pt"> ou </span><span style="font-size:9pt;font-weight:600">-+</span><span style="font-size:9pt">   suivi d'une valeur correspondant au nombre d'heures à enlever à la date de début et à rajouter à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : +-24</span><span style="font-size:9pt"><br />                    </span><span style="font-size:9pt;font-weight:600">-</span><span style="font-size:9pt"> suivi d'une valeur correspondant au nombre d'heures à enlever à la date de début pour faire la date de fin. </span><span style="font-style:italic;font-size:9pt">Expl : -24</span><span style="font-size:9pt"><br />                    chiffre 0 ou vide, alors la date de fin est la date de début à laquelle est ajouté 24 heures.<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> soit la date est exprimée sous la forme des formules préétablies suivantes : <br />                    TOUTE DATE        pas de limite inférieure.<br />                    DATE VISITE         date de l'observation en cours.<br />                    DATE ACTUELLE    date du jour en cours.<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> si absent alors il prendra la valeur de &quot;01-01-3000&quot;<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (liste de définition des tables à exporter) :<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> Ce paramètre doit comporter une série de chaines de définition de table, déterminant quelles tables exporter, et quelles colonnes à exporter de ces tables.<br /></span><span style="font-size:9pt;text-decoration:underline">Syntaxe d'une définition de table</span><span style="font-size:9pt"> :<br /><br />VAR nomDeLaTable [nomDelaColonne = largeur octroyée pour l'affichage de la colonne; nomDelaColonneSuivante = largeur octroyée pour l'affichage de la colonne] <br /><br />Exemple :</span><span style="font-size:9pt;font-weight:600;color:#0000ff"> VAR</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Constantes de Base </span><span style="font-size:9pt;font-weight:600;color:#0000ff">[ </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Pouls</span><span style="font-size:9pt;font-weight:600;color:#00aa00">=</span><span style="font-size:9pt">50; </span><span style="font-size:9pt;font-weight:600;color:#ff0000">SAO2</span><span style="font-size:9pt;font-weight:600;color:#00aa00">=</span><span style="font-size:9pt">80; </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Temp</span><span style="font-size:9pt;font-weight:600;color:#00aa00">=</span><span style="font-size:9pt">100</span><span style="font-size:9pt;font-weight:600;color:#0000ff">] VAR</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Poids </span><span style="font-size:9pt;font-weight:600;color:#0000ff">[</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Poids</span><span style="font-size:9pt">=50; </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Taille</span><span style="font-size:9pt">=80 </span><span style="font-size:9pt;font-weight:600;color:#0000ff">]</span><span style="font-size:9pt"> <br />Nom du tableau ou de la table tel qu'indiqué dans le modèle du tableau après la mention </span><span style="font-size:9pt;font-weight:600;color:#0000ff">VAR</span><span style="font-size:9pt"><br />exemple :   </span><span style="font-style:italic;font-size:9pt;font-weight:600">Constantes de Base</span><span style="font-size:9pt">   dans le modèle ci-dessous<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple de modèle</span><span style="font-size:9pt"> :<br /><br />[VAR </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Constantes de Base</span><span style="font-size:9pt">]     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Pouls</span><span style="font-size:9pt">, 31536000, 130, 40, pps, Tachycardie, Bradycardie     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">SAO2</span><span style="font-size:9pt">, 31536000, 0, 92, %, , Hypoxie     <br />   Modèle = Date, </span><span style="font-size:9pt;font-weight:600;color:#0000ff">Temp</span><span style="font-size:9pt">, 31536000, 40.5, 35, ?, Hypothermie, Hyperthermie     <br />[VAR </span><span style="font-size:9pt;font-weight:600;color:#ff0000">Poids</span><span style="font-size:9pt">]     <br />   Modèle = Date, Poids,  31536000, 100, 50, Kg(s), Obésité, Amaigrissement     <br />   Modèle = Date, Taille, 31536000, 0, 0, cm(s), ,      <br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt"> (séparateur entre les tables) :<br />Ce paramètre facultatif indique un motif de séparation de tables.<br />Si cette valeur commence par le modificateur </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt">  alors ce qui suit la suite de </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-size:9pt"> sera considéré comme le chemin d'un fichier à charger et alors le nom de ce fichier peut contenir les mentions suivantes :<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br />          </span><span style="font-size:9pt;font-weight:600">° </span><span style="font-size:9pt"> si absent alors il prendra la valeur de &quot;</span><span style="font-size:9pt;font-weight:600;color:#ff0000">&lt;br&gt;</span><span style="font-size:9pt">&quot;<br /><br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur par défaut de la cellule si non exprimée avec la mention </span><span style="font-size:9pt;font-weight:600">=</span><span style="font-size:9pt"> ) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Hauteur de la cellule) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur de la ligne de séparation par défaut 1) :<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 8</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(Largeur totale du tableau par défaut 100%) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale de la page.<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 9</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(format d'affichage des dates par défaut </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">dd-MM-yyyy hh</span><span style="font-size:9pt">) :<br />          exprimé selon la règle suivante : </span><a href="DrTux.html#format_des_dates"><span style="font-size:9pt">format des dates</span></a><span style="font-size:9pt"><br />          ce paramètre peut être suivi (séparé par le signe = ) du titre de la colonne des dates.<br /> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 10</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(largeur de la colonne des dates par défaut 50 ) :<br />          si exprimé en pourcentage se sera le pourcentage de la largeur totale.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Quelques exemples</span><span style="font-size:9pt"> :<br /></span><span style="font-family:Fixed;font-size:9pt">{{:: </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">EXPORT_TABLES( </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">2010-01-01</span><span style="font-family:Fixed;font-size:9pt"> , </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#00aa00">2010-31-12</span><span style="font-family:Fixed;font-size:9pt"> , </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa5500">VAR Constantes de Base[Pouls=50; SAO2=80; Temp=100] VAR Poids[Poids=50; Taille=80]</span><span style="font-family:Fixed;font-size:9pt"> , </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">30%</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">20</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">1</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa00ff">100%</span><span style="font-family:Fixed;font-size:9pt"> ,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#55aa7f">dd-MM-yyyy hh</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#55007f">50</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">)</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#5555ff">}}<br /></span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.142</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: EXPORT( nom du fichier, source des données, ..... autres paramètres selon source de données ...... )}}<br /></span><span style="font-size:9pt">Cette instruction polymorphe très puissante a pour objectif de mettre en forme des données provenant de différentes sources de MedinTux et de les écrire sur le disque.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (fichier de destination) : fichier de destination dans lequel seront placées les données.<br />          <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(source des données) :<br /></span><span style="font-family:Fixed;font-size:9pt">                  </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">T</span><span style="font-family:Fixed;font-size:9pt"> pour string enrichie    </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">A</span><span style="font-family:Fixed;font-size:9pt"> pour ASCII      </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">D</span><span style="font-family:Fixed;font-size:9pt"> pour dossier               </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff0000">S</span><span style="font-family:Fixed;font-size:9pt"> pour selection<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt">        string a exporter                      string a exporter       liste des rubriques séparées par |   String a exporter a laquelle sera ajoutée la sélection</span> <span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-family:Fixed;font-size:9pt">     mode conversion ascii     mode conv. ascii  date debut                   mode conversion ascii<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 5</span><span style="font-family:Fixed;font-size:9pt">     A/alwaysWrite F/fullOnly  A ou F            date fin                     A ou F (A/alwaysWrite F/fullOnly)</span></p>
<p><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 6</span><span style="font-family:Fixed;font-size:9pt">                                                </span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">séparation des fiches</span><span style="font-family:Fixed;font-size:9pt"> avec les<br />                                                              mentions possibles ci-dessous.<br />                                                               $NomPatient $PrenomPatient <br />                                                               $DateDeb $DateFin <br />                                                               $DateDebFiche $DateFinFiche <br />                                                               $HeureDeb $HeureFin $NomRub <br />                                                               $TitreRub $User $SignUser <br />                                                               $NumFicheRub $GUIDPat $PkPat <br />                                                               $pkFiche $Duree $NumFicheTot <br />                                                             si commence par la mention : </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-family:Fixed;font-size:9pt"> alors c'est le fichier <br />                                                            mentionné qui sera utilisé comme séparateur de fiches.</span></p>
<p><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 7</span><span style="font-family:Fixed;font-size:9pt"> </span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">en-tête du fichier d'exportation</span><span style="font-family:Fixed;font-size:9pt"><br />                                                             peut être un fichier html avec les macros de votre choix.<br />                                                             si il commence par la mention : </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-family:Fixed;font-size:9pt"> alors c'est le fichier <br />                                                            mentionné qui sera utilisé comme </span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">en-tête</span><span style="font-family:Fixed;font-size:9pt">.</span></p>
<p><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 8</span><span style="font-family:Fixed;font-size:9pt"> </span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">filtre sql where</span><span style="font-family:Fixed;font-size:9pt"> si mentionne, alors la chaîne sera utilisée en<br />                                                            complément du filtrage SQL habituel sur les dates.<br />                                                            si il commence par la mention : </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-family:Fixed;font-size:9pt"> alors c'est le fichier <br />                                                            mentionné qui sera utilisé comme </span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">filtre sql where</span><span style="font-family:Fixed;font-size:9pt">.</span></p>
<p><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANT</span><span style="font-size:9pt;font-weight:600"> : Dans le mode exportation de dossier (</span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> (source des données) : avec la valeur </span><span style="font-size:9pt;font-weight:600;color:#ff0000">D</span><span style="font-size:9pt;font-weight:600">) , un répertoire du nom du fichier est créé, et c'est à l'intérieur de ce répertoire que se trouvent : le fichier html correspondant à l'exportation, et les images nécessaires à ce fichier.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> </span><span style="font-size:9pt">  <br /> </span><span style="font-style:italic;font-size:9pt"> </span></p>
<p><span style="font-size:9pt;text-decoration:underline">Un exemple sous Linux qui exporte le dossier patient en entier, le transforme en PDF et l'envoie par kmail</span><span style="font-size:9pt"> :<br /></span><span style="font-family:Fixed;font-size:9pt">{{\<br />{{:: SET_VAR(FName,{{NOM PRENOM PATIENT}}-{{GUID}})}}\</span><span style="font-family:Fixed;font-style:italic;font-size:9pt;color:#aaaa7f"><br />{{REM=--------------------- exportation du dossier complet -------------------------------}}\<br /></span><span style="font-family:Fixed;font-size:9pt">{{:: </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">EXPORT</span><span style="font-family:Fixed;font-size:9pt">(</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">../../tmp/{{VAR=FName}}.html</span><span style="font-family:Fixed;font-size:9pt"> , </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">D</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">Terrain|Observation|Prescription|Documents|Vigie</span><span style="font-family:Fixed;font-size:9pt">, </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#00aa00">1900-01-01T00:00:00</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#00aa7f"> 2200-01-01T00:00:00</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa00ff">../../pdf/SeparateurEntete.html</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#0000ff">$File</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#ff5500">../../pdf/ObservEntete.html</span><span style="font-family:Fixed;font-size:9pt">) }}\<br /></span><span style="font-family:Fixed;font-style:italic;font-size:9pt;color:#aaaa7f">{{REM=--------------------- impression en PDF --------------------------------------------}}\<br /></span><span style="font-family:Fixed;font-size:9pt">{{:: exe_process (WaitEnd ,../../APropos/bin/APropos,ToPDF,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.html)}}\<br /></span><span style="font-family:Fixed;font-style:italic;font-size:9pt;color:#aaaa7f">{{REM=---------------------- envoi par mail-----------------------------------------------}}\<br /></span><span style="font-family:Fixed;font-size:9pt">{{:: exe_process (NoWaitEnd ,/usr/bin/kmail,-c,roland-sevin@medintux.org,-s,Dossier de {{TITRE PATIENT}} {{NOM PRENOM PATIENT}},--msg,$ToAbsPath../../pdf/TestEnvoiMail.txt,--attach,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.pdf)}}\<br />}}<br /><br /></span><span style="font-family:Fixed;font-size:9pt;text-decoration:underline">Un </span><span style="font-size:9pt;text-decoration:underline">exemple de conversion d'un dossier complet en pdf pour Linux, Windows, Mac</span><span style="font-size:9pt"> :<br /></span><span style="font-size:9pt;text-decoration:underline">Préalables</span><span style="font-size:9pt"> :<br />    sous Mac : suppose que l'imprimante </span><a href="./APropos/index.html#3.1_Installer_CUPS-PDF_à_télécharger">CUPS-PDF-MedinTux</a><span style="font-size:9pt"> soit installée<br />    sous Windows : suppose que </span><a href="http://www.commentcamarche.net/download/start/telecharger-34055166-htmldoc"><span style="font-size:9pt">C:/Program Files/HTMLDoc/htmldoc.exe</span></a><span style="font-size:9pt"> soit installé<br /><br /></span><span style="font-family:Fixed;font-style:italic;font-size:9pt">{{\<br />{{:: SET_VAR(FName,{{NOM PRENOM PATIENT}}@{{GUID}})}}\<br />{{:: RB($FName, ,-)&gt;FName}}\<br />{{REM=--------------------- exportation du dossier complet -------------------------------}}\<br />{{:: SET_VAR(exportS,{{:: EXPORT(../../tmp/{{VAR=FName}}.html , D, Terrain|Observation|Prescription|Documents|Vigie, 1900-01-01T00:00:00, 2200-01-01T00:00:00,$File../../pdf/SeparateurEntete.html,$File../../pdf/ObservEntete.html) }}) }}\<br />{{REM=--------------------- conversion en PDF si non vide --------------------------------}}\<br />{{:: SET_VAR(toDo,{{:: SI(s,{{VAR=exportS}},=,,NOP,exe_process)}})}}\<br />{{REM=--------------------- conversion en PDF selon Linux Mac Windows ---------------------}}\<br />{{:: SI (S,{{OS}},=,L,{{VAR=toDo}},NO_LIN)&gt;toDoL}}\<br />{{:: SI (S,{{OS}},=,W,{{VAR=toDo}},NO_WIN)&gt;toDoW}}\<br />{{:: SI (S,{{OS}},=,M,{{VAR=toDo}},NO_MAC)&gt;toDoM}}\<br />{{:: {{VAR=toDoM}}(WaitEnd ,../../APropos/bin/APropos,ToPDF=CUPS-PDF-MedinTux;delay=10,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.html)}}\<br />{{:: {{VAR=toDoL}}(WaitEnd ,../../APropos/bin/APropos,ToPDF,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.html)}}\<br />{{:: {{VAR=toDoW}}(WaitEnd ,C:/Program Files/HTMLDoc/htmldoc,--webpage,-f,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.pdf,$ToAbsPath../../tmp/{{VAR=FName}}/{{VAR=FName}}.html)}}\<br />}}</span><span style="font-size:9pt"><br /></span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#5555ff"><br /></span><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.143</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: REPLACE_IN_FILE( nom du fichier source, nom du fichier destination, nom de la variable N°1, nom de la variable N°2, ... nom de la variable N°n )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Variante</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RF( nom du fichier source, nom du fichier destination, nom de la variable N°1, nom de la variable N°2, ... nom de la variable N°n ) }}<br /></span><span style="font-size:9pt"><br />Cette instruction permet de remplacer dans un fichier, des </span><span style="font-family:Fixed;font-size:9pt">occurrences d'un motif du type </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable N°1}}</span><span style="font-size:9pt"><br />par le contenu de cette variable.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (fichier source) : fichier d'origine, où se trouvent les motifs de type </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable}}</span><span style="font-size:9pt"> <br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt"> (fichier de destination) : fichier de destination créé avec les motifs de type </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable}}</span><span style="font-size:9pt"> remplacés par les contenus des variables correspondantes.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Glossaire</span><span style="font-size:9pt">         qui sera remplacée par le chemin du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br />                  </span><span style="font-size:9pt;font-weight:600;color:#0000ff">$Vigie  </span><span style="font-size:9pt">             qui sera remplacée par le chemin de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt">.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt">  (nom de la première variable) : dont il faudra remplacer le motif </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable}}</span><span style="font-size:9pt"> par son contenu.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-family:Fixed;font-size:9pt"> </span><span style="font-size:9pt">(nom de la deuxième variable) : dont il faudra remplacer le motif </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable}}</span><span style="font-size:9pt"> par son contenu.</span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° n</span><span style="font-family:Fixed;font-size:9pt"> </span><span style="font-size:9pt">(nom de la nième variable) : </span><span style="font-family:Fixed;font-size:9pt"> </span><span style="font-size:9pt">dont il faudra remplacer le motif </span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{</span><span style="font-size:9pt;font-weight:600;color:#aa0000">nom de la variable}}</span><span style="font-size:9pt"> par son contenu.</span><span style="font-family:Fixed;font-size:9pt">  <br /><br /></span><span style="font-family:Fixed;font-style:italic;font-size:9pt;text-decoration:underline">Exemple</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> : remplir des formulaires pdf avec pdftk.<br /><br />Exemple de fichier XFDF déjà rempli avec des données du formulaire<br />à envoyer avec pdftk pour qu'il remplisse le formulaire pdf<br />avec la commande suivante :<br /><br />pdftk document.pdf fill_form données.xfdf output document-rempli.pdf<br />Créer un fichier modèle avec les tags </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">{{nom de la variable}}</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"><br /><br /></span><span style="font-family:Fixed;font-style:italic;font-size:9pt;text-decoration:underline">Exemple</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> : <br /><br />° </span><span style="font-family:Fixed;font-style:italic;font-size:9pt;text-decoration:underline">fichier de référence</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> : </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">modeleXFDF.xml</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> (placé dans notre exemple dans le répertoire </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">pdf</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> de MedinTux)<br /><br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;xfdf xmlns=&quot;http://ns.adobe.com/xfdf/&quot; xml:space=&quot;preserve&quot;&gt;<br />&lt;fields&gt;<br />&lt;field name=&quot;Nom Patient&quot;&gt;<br />&lt;value&gt;{{</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#005500">NomPatient</span><span style="font-family:Fixed;font-style:italic;font-size:9pt">}}&lt;/value&gt;<br />&lt;/field&gt;<br />&lt;field name=&quot;Prenom Patient&quot;&gt;<br />&lt;value&gt;{{</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa55ff">PrenomPatient</span><span style="font-family:Fixed;font-style:italic;font-size:9pt">}}&lt;/value&gt;<br />&lt;/field&gt;<br />&lt;/fields&gt;<br />&lt;f href=&quot;fichier.pdf&quot; /&gt;<br />&lt;/xfdf&gt;<br /><br />° </span><span style="font-family:Fixed;font-style:italic;font-size:9pt;text-decoration:underline">Macro exploitant ce fichier</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> en le remplissant avec les données du patient en cours, par des valeurs collectées au préalable dans les variables idoines.<br /><br /></span><span style="font-family:Fixed;font-size:9pt">{{\<br />{{:: REM ----------- collecte des données dans les variables idoines --------------}}\<br />{{:: SET_VAR(</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#005500">NomPatient</span><span style="font-family:Fixed;font-size:9pt">,{{NOM PATIENT}})}}\<br />{{:: SET_VAR(</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa00ff">PrenomPatient</span><span style="font-family:Fixed;font-size:9pt">,{{PRENOM PATIENT}})}}\<br />{{REM=--------------------- remplacement des tags dans le fichier de réference -------------------------------}}\<br />{{REM= par les valeurs des variables }}\<br /></span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">{{:: REPLACE_IN_FILE</span><span style="font-family:Fixed;font-size:9pt">(</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#00007f">../../pdf/modeleXFDF.xml</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#00aa00">../../pdf/replacedXFDF.xml</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#005500">NomPatient</span><span style="font-family:Fixed;font-size:9pt">,</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa00ff">PrenomPatient</span><span style="font-family:Fixed;font-size:9pt">)</span><span style="font-family:Fixed;font-size:9pt;font-weight:600;color:#aa0000">}}</span><span style="font-family:Fixed;font-size:9pt">\<br />}}</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"><br /><br />° </span><span style="font-family:Fixed;font-style:italic;font-size:9pt;text-decoration:underline">fichier résultat</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> : </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">replacedXFDF.xml</span><span style="font-family:Fixed;font-style:italic;font-size:9pt"> où l'on voit les variables remplacées par les valeurs du patient.<br /></span><span style="font-family:Fixed;font-size:9pt"><br />&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;xfdf xmlns=&quot;http://ns.adobe.com/xfdf/&quot; xml:space=&quot;preserve&quot;&gt;<br />&lt;fields&gt;<br />&lt;field name=&quot;Nom Patient&quot;&gt;<br />&lt;value&gt;TARTEMPION&lt;/value&gt;<br />&lt;/field&gt;<br />&lt;field name=&quot;Prenom Patient&quot;&gt;<br />&lt;value&gt;MARCEL&lt;/value&gt;<br />&lt;/field&gt;<br />&lt;/fields&gt;<br />&lt;f href=&quot;fichier.pdf&quot; /&gt;<br />&lt;/xfdf&gt;</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.144</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RUBRIQUE_SHOW( nom de la rubrique, valeur )}}<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (nom de la rubrique) : Nom de la rubrique à afficher ou cacher.          <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(valeur) : </span><span style="font-size:9pt;font-weight:600">TRUE</span><span style="font-size:9pt"> valeur par defaut, affiche la rubrique,</span><span style="font-size:9pt;font-weight:600"> FALSE</span><span style="font-size:9pt"> cache la rubrique.</span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.145</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{DefinirATCD_Cisp}}<br /></span><span style="font-size:9pt">Lance le gestionnaire des antécédents postionné sur l'onglet </span><span style="font-size:9pt;font-weight:600">Cisp</span><span style="font-size:9pt">. et insère le contenu des antécédents à l'emplacement du curseur texte.</span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.146</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: INSERT_CISP () }}<br /></span><span style="font-size:9pt">Lance le gestionnaire des antécédents postionné sur l'onglet </span><span style="font-size:9pt;font-weight:600">Cisp</span><span style="font-size:9pt">. et insère le contenu de la sélection à l'emplacement du curseur texte.<br />Le gestionnaire peut être paramétré de façon à n'afficher que les chapitres et sous chapitres (ou rubriques) de la Cisp.<br /></span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (filtre d'affichage des chapitres Cisp) : ce filtre facultatif (alors par défaut il est égal à </span><span style="font-style:italic;font-size:9pt;font-weight:600">-FDABHKLNPRSTUWXYZ</span><span style="font-size:9pt"> ) est une suite de caractères pouvant être les suivants selon les chapitres que l'on désire afficher :<br />F pour le chapitre oeil ;</span></p>
<p><span style="font-size:9pt">D pour le chapitre système digestif ;<br />A pour le chapitre général et non spécifié ;<br />- pour le chapitre procédures ;<br />B pour le chapitre sang système hématopoïétique ou immunologique ;<br />H pour le chapitre oreille ;<br />K pour le chapitre cardio-vasculaire ;<br />L pour le chapitre ostéo-articulaire ;<br />N pour le chapitre neurologique ;<br />P pour le chapitre psychologique ;<br />R pour le chapitre respiratoire ;<br />S pour le chapitre peau ;<br />T pour le chapitre métabolisme nutrition endocrinien ;<br />U pour le chapitre systèmeme urinaire ;<br />W pour le chapitre grossesse, accouchement et planning familial ;<br />X pour le chapitre système génital féminin et sein ;<br />Y pour le chapitre système génital masculin et sein ;<br />Z pour le chapitre social ;<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt"> (filtre d'affichage des rubriques de la Cisp) : ce filtre facultatif (alors par défaut il est égal à </span><span style="font-style:italic;font-size:9pt;font-weight:600">SINTCD</span><span style="font-size:9pt"> ) est une suite de caractères pouvant être les suivants selon les rubriques que l'on désire afficher :<br />S pour la rubrique SYMPTÔMES ET PLAINTES ;<br />I pour la rubrique INFECTIONS ;<br />N pour la rubrique NÉOPLASIES ;<br />T pour la rubrique TRAUMATISMES ;<br />C pour la rubrique ANOMALIES CONGÉNITALES ;<br />D pour la rubrique AUTRES DIAGNOSTICS ;<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(template d'affichage d'une ligne de Cisp) : <br />ce paramètre est facultatif (alors par défaut il est égal à </span><span style="font-style:italic;font-size:9pt;font-weight:600">&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_CHAPITRE::</span><span style="font-style:italic;font-size:9pt;font-weight:600"> </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_LIBELLE::</span><span style="font-style:italic;font-size:9pt;font-weight:600"> </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_COMMENT::</span><span style="font-style:italic;font-size:9pt;font-weight:600"> code Cisp = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_CODE:: </span><span style="font-style:italic;font-size:9pt;font-weight:600">;</span><span style="font-size:9pt"> )<br />La mention </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_LIBELLE::</span><span style="font-size:9pt"> sera remplacée par le libellé Cisp, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_CODE::</span><span style="font-size:9pt"> par le code Cisp, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_CHAPITRE::</span><span style="font-size:9pt"> par le chapitre Cisp ce ce code, </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_COMMENT::</span><span style="font-style:italic;font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">par le commentaire.<br /></span><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANT</span><span style="font-size:9pt;font-weight:600"> : Dans le cas d'un code composé CISP-CIMX </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_LIBELLE::</span><span style="font-size:9pt;font-weight:600"> sera celui du code Cim10 associé et séléctionné </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#00007f">::CISP_COMMENT::</span><span style="font-size:9pt;font-weight:600"> sera celui du code Cisp correspondant.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> </span><span style="font-size:9pt">  <br /></span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(masquage et affichage des comboBox des choix de rubriques et chapitres) : <br />ce paramètre est facultatif et alors il est égal à : </span><span style="font-size:9pt;font-weight:600">CU</span><span style="font-size:9pt"> <br />Si le caractère </span><span style="font-size:9pt;font-weight:600">C</span><span style="font-size:9pt"> est présent alors la comboBox de choix des chapitres est affichée.</span><span style="font-family:Fixed;font-size:9pt"><br /></span><span style="font-size:9pt">Si le caractère </span><span style="font-size:9pt;font-weight:600">U</span><span style="font-size:9pt"> est présent alors la comboBox de choix des rubriques est affichée.<br /><br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">Exemple 1</span><span style="font-size:9pt"> : <br /><br />{{::#INSERT_CISP(K,S,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::CISP_LIBELLE:: </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">::CISP_CODE::</span><span style="font-size:9pt">, no)}}<br /><br />(notez le caractère # permettant de conserver les attributs html du texte) affichera la boîte de dialogue suivante :<br /><br /></span><img src=CispMacroExemple-1.png ><span style="font-size:9pt"><br /><br />et après confirmation insèrera à la position du curseur texte les éléments suivants : <br /><br /></span><span style="font-style:italic;font-size:9pt">      </span><span style="font-size:9pt">autre battement cardiaque irrégulier </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">K05 </span><span style="font-style:italic;font-size:9pt"><br />      </span><span style="font-size:9pt">douleur cardiaque </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> </span><span style="font-style:italic;font-size:9pt">= </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">K01 </span><span style="font-style:italic;font-size:9pt"><br />      </span><span style="font-size:9pt">limitation de la fonction ou incapacité (k) </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-style:italic;font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">K28 </span><br /><br /><span style="font-style:italic;font-size:9pt;text-decoration:underline">Exemple 2</span><span style="font-size:9pt"> : <br /></span><br /><span style="font-size:9pt">{{::#INSERT_CISP(K,S,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::CISP_LIBELLE:: </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">::CISP_CODE::</span><span style="font-size:9pt">)}}<br />{{::#INSERT_CISP(K,S,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; ::CISP_LIBELLE:: </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">::CISP_CODE::</span><span style="font-size:9pt"> , </span><span style="font-size:9pt;font-weight:600;color:#00007f">CU</span><span style="font-size:9pt;color:#00aa00">)</span><span style="font-size:9pt">}}<br /><br />afficheront la boîte de dialogue suivante :<br /><br /></span><img src=CispMacroExemple-2.png ><br /><span style="font-size:9pt"><br /></span><span style="font-style:italic;font-size:9pt;text-decoration:underline">Exemple 3</span><span style="font-size:9pt"> : <br />{{::#INSERT_CISP(K,INTCD,&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;::CISP_CHAPITRE:: ::CISP_LIBELLE:: ::CISP_COMMENT:: </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">::CISP_CODE::</span><span style="font-size:9pt">)}}</span><br /><span style="font-size:9pt"><br />affichera la boîte de dialogue suivante :<br /></span><img src=CispMacroExemple-3.png ><br /><br /><span style="font-size:9pt">et après confirmation insèrera à la position du curseur texte les éléments suivants :<br /><br />     cardio-vasculaire CIMX : bradycardie SAI CISP : arythmie cardiaque non classé ailleurs </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">K80 =I49</span><span style="font-size:9pt"><br />     cardio-vasculaire CIMX : séquelles d'infarctus cérébral CISP : accident vasculaire cérébral </span><span style="font-size:9pt;font-weight:600">code Cisp</span><span style="font-size:9pt"> = </span><span style="font-style:italic;font-size:9pt;font-weight:600;color:#aa0000">K90 =I63</span><span style="font-size:9pt"><br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.147</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: RESOLVE (valeur, operateur, valeur , operateur, valeur, ........ ) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variantes pour le nom de la macro </span><span style="font-size:9pt;font-weight:600;color:#aa0000">: <br /></span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">VAR_CALC<br /></span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">RESULT<br /></span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">RES<br /></span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">RS<br /></span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">VC<br /></span><span style="font-size:9pt">Cette macro que nous attendions tous, permet de faire du calcul entre plusieurs arguments.<br /><br />Exemple : </span><span style="font-family:Fixed;font-style:italic;font-size:8pt">{{:: Resolve( $Wells_1, + ,$Wells_2, + ,$Wells_3, + ,$Wells_4, + ,$Wells_5 )}}</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt">Exemple équivalent au précédent : </span><span style="font-family:Fixed;font-style:italic;font-size:8pt">{{:: Resolve( {{VAR=Wells_1}}, + ,{{VAR=Wells_2}}, + ,{{VAR=Wells_3}}, + ,{{VAR=Wells_4}}, + ,{{VAR=Wells_5}} )}}<br /></span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (valeur) : première valeur du calcul.<br /></span><span style="font-family:Fixed;font-size:9pt">                      </span><span style="font-size:9pt">si le nom de l'argument commence par </span><span style="font-size:9pt;font-weight:600">$</span><span style="font-size:9pt"> alors <br /></span><span style="font-family:Fixed;font-size:9pt">                      </span><span style="font-size:9pt">il sera pris le contenu de la variable dont le nom succède au </span><span style="font-size:9pt;font-weight:600">$</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt;font-weight:600"> </span><span style="font-size:9pt">(opérateur) : </span><span style="font-family:Fixed;font-size:9pt">opérateur à appliquer entre deux valeurs<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">+</span><span style="font-family:Fixed;font-size:9pt">   addition</span> <br /><span style="font-family:Fixed;font-size:9pt">           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">-</span><span style="font-family:Fixed;font-size:9pt">   soustraction<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">*</span><span style="font-family:Fixed;font-size:9pt">   multiplication<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">/</span><span style="font-family:Fixed;font-size:9pt">   division flottante<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">:</span><span style="font-family:Fixed;font-size:9pt">   division entière<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">%</span><span style="font-family:Fixed;font-size:9pt">   pourcentage<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">?</span><span style="font-family:Fixed;font-size:9pt">   modulo<br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">x</span><span style="font-family:Fixed;font-size:9pt">   multiplication entière <br />           </span><span style="font-family:Fixed;font-size:9pt;font-weight:600">X</span><span style="font-family:Fixed;font-size:9pt">   multiplication entière <br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> (valeur) : deuxième valeur du calcul. première valeur du calcul.<br /></span><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">ASTUCE BENIE DES DIEUX</span><span style="font-size:9pt;font-weight:600"> :</span><span style="font-family:Fixed;font-size:9pt">   </span><span style="font-size:9pt">si le nom de l'argument commence par </span><span style="font-size:9pt;font-weight:600">$</span><span style="font-size:9pt"> alors <br /></span><span style="font-family:Fixed;font-size:9pt">                      </span><span style="font-size:9pt">il sera pris le </span><span style="font-size:9pt;font-weight:600">contenu de la variable</span><span style="font-size:9pt"> dont le nom succède au </span><span style="font-size:9pt;font-weight:600">$</span><span style="font-size:9pt"><br /></span><img src=gnome-warning.png ><span style="font-size:9pt;font-weight:600;text-decoration:underline">IMPORTANT</span><span style="font-size:9pt;font-weight:600"> :</span><span style="font-family:Fixed;font-size:9pt">   </span><span style="font-size:9pt">Il n'y a pas de limite au nombre d'arguments séparés par un opérateur.<br /><br /></span><span style="font-family:Fixed;font-style:italic;font-size:8pt;text-decoration:underline">Exemple</span><span style="font-family:Fixed;font-style:italic;font-size:8pt"> : <br />{{\<br />{{:: SET_VAR(Wells_1, {{:: Extract(*,Cancer dans le score de Wells :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_2, {{:: Extract(*,Paralysie ou immobilisation plâtrée récente :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_3, {{:: Extract(*,Alitement supérieur à trois jours ou chirugie inférieure à 4 semaines :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_4, {{:: Extract(*,Douleur à la palpation du trajet des veines profondes :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_5, {{:: Extract(*,Tuméfaction de la cuisse et ou du mollet :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_6, {{:: Extract(*,Tuméfaction du mollet sup à 3 cm de différence entre les deux côtés :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_7, {{:: Extract(*,Oedème prenant le godet :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_8, {{:: Extract(*,Veines superficielles dilatées :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(Wells_9, {{:: Extract(*,Autres diagnostics alternatifs au moins aussi probables :,EOL,,,N)}} )}}\<br />{{:: SET_VAR(resultat_W1,{{:: Resolve( $Wells_1, + ,$Wells_2, + ,$Wells_3, + ,$Wells_4, + ,$Wells_5, + , $Wells_6, + , $Wells_7, + , $Wells_8, + , $Wells_9 )}} )}}\<br />}} </span><span style="font-family:Fixed;font-style:italic;font-size:8pt;font-weight:600">Résultat du score de Wells : {{VAR=resultat_W1}}</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.148</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{VALIDER_DOSSIER }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro </span><span style="font-size:9pt;font-weight:600;color:#aa0000">: </span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">ZAB<br /></span><span style="font-size:9pt">Cette macro met à jour le dossier en cours dans la base de données et recharge toutes les rubriques du dossier.<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.149</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: WAIT_CURSOR (RESTORE) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro </span><span style="font-size:9pt;font-weight:600;color:#aa0000">: </span><span style="font-size:9pt">     </span><span style="font-size:9pt;font-weight:600;color:#aa0000">WC<br /></span><span style="font-size:9pt">Cette macro permet de placer le curseur souris en mode attente ou normal afin de signaler une action longue.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (mode) : RESTORE ou NORMAL pour remettre le curseur en mode normal.<br /></span><span style="font-family:Fixed;font-size:9pt">                     WAIT  </span><span style="font-size:9pt"> pour mettre le curseur en mode attente.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.150</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_RPPS}}<br /></span><span style="font-size:9pt">retourne le numéro de RPPS.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.151</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{USER_CLEF_RPPS}}<br /></span><span style="font-size:9pt">retourne le numéro de clef RPPS.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.152</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: SET_DOC_DATE_DEB ( </span><span style="font-size:8pt;font-weight:600;color:#aa0000">12-12-1990 08:30:45</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> ) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">SET_DATE_DOC<br /></span><span style="font-size:9pt">Cette macro positionne la date du document.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> date à positionner le format doit être </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy hh:mm:ss</span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.153</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: SET_DOC_DATE_FIN ( </span><span style="font-size:8pt;font-weight:600;color:#aa0000">12-12-1990 08:30:45</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> ) }}<br /></span><span style="font-size:9pt">Cette macro positionne la date de fin du document.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> date à positionner le format doit être </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy hh:mm:ss<br /></span><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.154</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: GET_DOC_DATE_FIN ( dd-MM-yyyy hh:mm:ss ) }}<br /></span><span style="font-size:9pt">Cette macro retourne la date de fin du document.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> (facultatif) le format avec lequel la date doit être retournée exemple : </span><span style="font-size:9pt;font-weight:600">dd-MM-yyyy hh:mm:ss<br /></span><span style="font-size:9pt">Si absent se sera le format </span><span style="font-size:9pt;font-weight:600">ISO</span><span style="font-size:9pt"> qui sera utilisé : </span><span style="font-size:9pt;font-weight:600">yyyy-MM-dd hh:mm:ss<br /></span><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.155</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: IS_DATE_VALID ( </span><span style="font-size:8pt;font-weight:600;color:#aa0000">12-12-1990 08:30:45</span><span style="font-size:9pt;font-weight:600;color:#aa0000"> ) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">ISDV<br /></span><span style="font-size:9pt">Cette macro retourne si une date est valide 1 sinon 0.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt"> date à tester.</span><span style="font-size:9pt;font-weight:600;color:#aa0000"><br /></span><span style="font-size:9pt">Le format de la date devra être </span><span style="font-size:9pt;font-weight:600">ISO</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600">yyyy-MM-dd hh:mm:ss<br /></span><span style="font-size:9pt"><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.156</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: KEY_VALUE ( texte_a_analyser , SECTION , CLEF , 3 ) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">KV READ_KEY<br /></span><span style="font-size:9pt">Cette macro retourne les valeurs ou la valeur d'une clef située dans un texte de la forme :<br /><br /></span><span style="font-family:Courier New;font-size:8pt">[SECTION]<br />    clef = value<br /><br />[AUTRE SECTION]<br />    clef = value1 , value2 , value3</span><span style="font-size:9pt"><br /><br />Ces types d'organisation de texte sont en général ceux des fichiers de configuration de MedinTux.<br />Ils sont en général dans des fichiers ayant pour extension </span><span style="font-size:9pt;font-weight:600">.ini</span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt">  texte dans lequel retrouver la valeur de la clef. <br />Si ce paramètre commence par </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$</span><span style="font-size:9pt"> alors c'est le contenu de la variable dont le nom suit </span><span style="font-size:9pt;font-weight:600;color:#aa0000">$</span><span style="font-size:9pt"> qui sera utilisé.<br />Si ce paramètre  est égal à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">::param </span><span style="font-size:9pt">alors c'est le contenu du fichier de configuration en cours qui est utilisé.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt">  nom de la section, sans les [] <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt">  nom de la clef <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt">  (facultatif et auquel cas mis à 1) nombre de valeurs à retrouver<br />    </span><span style="font-size:9pt;font-weight:600">- si</span><span style="font-size:9pt"> un seul argument alors la valeur de la clef est retournée comme valeur de retour<br />    </span><span style="font-size:9pt;font-weight:600">- si</span><span style="font-size:9pt"> plusieurs arguments alors ils seront retournés dans des variables ayant pour nom :<br />      </span><span style="font-size:9pt;font-weight:600">le_nom_de_la_clef_</span><span style="font-size:9pt;font-weight:600;color:#aa0000">0</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">le_nom_de_la_clef_</span><span style="font-size:9pt;font-weight:600;color:#aa0000">1</span><span style="font-size:9pt">  ..... </span><span style="font-size:9pt;font-weight:600">le_nom_de_la_clef_</span><span style="font-size:9pt;font-weight:600;color:#aa0000">n<br /></span><span style="font-size:9pt">      La valeur de retour est alors 1 si tout s'est bien passé sinon un message d'erreur.<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.157</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: SQL_WRITE ( tableName  ,  primary_key = '123'  ,  field_name_1 , value_for_field_name_1 ,  field_name_2 , value_for_field_name_2 , ......... , field_name_n , value_for_field_name_n ) }}<br /></span><span style="font-size:9pt">Fonction qui permet de mettre à jour ou insérer des données dans une table SQL.<br />Si l'enregistrement existe déjà il est mis à jour sinon il est inséré.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt">  nom de la table à mettre à jour<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt">  condition WHERE (la mention WHERE </span><span style="font-size:9pt;text-decoration:underline">ne doit pas être fournie</span><span style="font-size:9pt">) pour sélectionner les enregistrements à mettre à jour.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 3</span><span style="font-size:9pt"> nom du premier champ à mettre à jour doit être suivi de la<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 4</span><span style="font-size:9pt">  valeur à mettre à jour dans ce champ.<br /></span><span style="font-family:Courier New;font-size:8pt">    </span><span style="font-size:9pt;font-weight:600">.<br /></span><span style="font-family:Courier New;font-size:8pt">    </span><span style="font-size:9pt;font-weight:600">.<br /></span><span style="font-family:Courier New;font-size:8pt">    </span><span style="font-size:9pt;font-weight:600">.</span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° n</span><span style="font-size:9pt"> nom du nième champ à mettre à jour doit être suivi de la <br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° n+1</span><span style="font-size:9pt">  valeur à mettre à jour dans ce champ.<br /><br /></span><span style="font-style:italic;font-size:9pt;font-weight:600">Exemple</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#00557f">{{:: SQL_WRITE (</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#0000ff">het_encours</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">,</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#005500">( het_encours_id_dossier = '123' AND het_encours_id_patient = '456' )</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">,</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa5500">het_encours_dt_sortie , 12-12-2014</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">,</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;color:#aa0000">het_encours_motif_recours , douleur abdominale </span><span style="font-size:9pt;font-weight:600;color:#00557f">) }}<br /></span><span style="font-size:9pt"><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.158</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: NOUVEAU_DOCUMENT (Observation  ,  données à insérer  ) }}<br /></span><span style="font-size:9pt">Fonction qui permet d'ajouter un document à une rubrique spécifiée dans le premier paramètre. Si </span><span style="font-size:9pt;font-weight:600;color:#aa0000">*</span><span style="font-size:9pt"> alors c'est la rubrique en cours à laquelle sera rajouté le document.<br />Si l'enregistrement existe déjà il est mis à jour sinon il est inséré.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt">  nom de la la rubrique en cours à laquelle sera rajouté le document<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt">  données à insérer dans ce document, si ce paramètre est non précisé alors un document vide sera créé, si précisé et vide la création avortera<br /><br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.159</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: CURRENT_EDITOR ( date = dd-MM-yyyy hh:mm  ) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">CE<br /></span><span style="font-size:9pt">Fonction qui permet d'obtenir des informations sur la rubrique en cours d'édition.<br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt">  type d'information souhaitée : <br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">type</span><span style="font-size:9pt"> alors il sera retourné le type numérique de la rubrique.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">name</span><span style="font-size:9pt"> alors il sera retourné le nom de la rubrique.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">default mask dir</span><span style="font-size:9pt"> alors il sera retourné le chemin par défaut des documents types.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">default mask file</span><span style="font-size:9pt"> alors il sera retourné le fichier par défaut à insérer lors de la première création de la rubrique.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">title</span><span style="font-size:9pt"> alors il sera retourné le titre affiché dans la liste des documents de la rubrique.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">date = dd-MM-yyyy hh:mm</span><span style="font-size:9pt"> alors il sera retourné la date de création du document dans la rubrique. Ce qui suit le signe égal est le format souhaité de la date à retourner.<br /></span><span style="font-style:italic;font-size:9pt;font-weight:600">Exemples</span><span style="font-size:9pt"> : <br />{{:: CURRENT_EDITOR ( date = dd-MM-yyyy hh:mm) }}<br />{{:: CURRENT_EDITOR ( name ) }}<br />{{:: CURRENT_EDITOR ( default mask file ) }}<br /><br /><hr></span><span style="font-size:9pt;font-weight:600">4.5.3.160</span><span style="font-size:9pt"> |==&gt; </span><span style="font-size:9pt;font-weight:600;color:#aa0000">{{:: MOVE_CURSOR( Observation, QTextEdit::MoveEnd) }}<br /></span><span style="font-size:9pt;text-decoration:underline">Variante pour le nom de la macro</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600;color:#aa0000">MC<br /></span><span style="font-size:9pt">Fonction qui positionne le curseur texte.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 1</span><span style="font-size:9pt">  type de rubrique souhaitée (Observation, Prescription etc...)<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">*</span><span style="font-size:9pt"> alors la rubrique courante sera utilisée.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Observation </span><span style="font-size:9pt">alors la rubrique Observation sera utilisée.<br />    Si positionné à </span><span style="font-size:9pt;font-weight:600;color:#aa0000">Prescription </span><span style="font-size:9pt">alors la rubrique Prescription sera utilisée, etc.<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramètre N° 2</span><span style="font-size:9pt">  position du curseur, peut prendre les valeur suivantes : <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveBackward</span><span style="font-size:9pt"> - Moves the cursor one character backward <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveWordBackward</span><span style="font-size:9pt"> - Moves the cursor one word backward <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveForward</span><span style="font-size:9pt"> - Moves the cursor one character forward <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveWordForward</span><span style="font-size:9pt"> - Moves the cursor one word forward <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveUp</span><span style="font-size:9pt"> - Moves the cursor up one line <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveDown</span><span style="font-size:9pt"> - Moves the cursor down one line <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveLineStart</span><span style="font-size:9pt"> - Moves the cursor to the beginning of the line <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveLineEnd</span><span style="font-size:9pt"> - Moves the cursor to the end of the line <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveHome</span><span style="font-size:9pt"> - Moves the cursor to the beginning of the document <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MoveEnd</span><span style="font-size:9pt"> - Moves the cursor to the end of the document <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MovePgUp</span><span style="font-size:9pt"> - Moves the cursor one viewport page up <br />    </span><span style="font-size:9pt;font-weight:600;color:#aa0000">QTextEdit::MovePgDown</span><span style="font-size:9pt"> - Moves the cursor one viewport page down<br /><br /></span><span style="font-style:italic;font-size:9pt;font-weight:600">Exemple</span><span style="font-size:9pt"> : <br />{{:: MOVE_CURSOR( (Observation, QTextEdit::MoveEnd) }}<br /><br /><br /><hr><a name="5_Un_système_de_classement_intelligent_,_LA_VIGIE_,"></a></span><span style="font-weight:600;text-decoration:underline">5 Un système de classement intelligent : LA VIGIE </span>:<br /><img src=zix-arrow-right.png ><a href="index.html#Retour au menu principal">Retour au menu principal</a><span style="font-size:9pt"><br /><br /><br /></span><span style="font-size:9pt;text-decoration:underline">La vigie est un système très puissant de classeurs</span><span style="font-size:9pt"> : <br />dans lesquels il vous sera possible de classer tous les documents de MedinTux afin d'avoir une vision transversale du dossier patient ou de l'ensemble des dossiers.<br /><br /><a name="5.1_Une_règle_très_simple_pour_beaucoup_de_puissance_,"></a></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">5.1 Une règle très simple pour beaucoup de puissance</span><span style="font-size:9pt"> : </span></p>
<ul type="disc"><div><img src=bulletcyan01.png ><span style="font-size:9pt">Tout document MedinTux (Observation, prescription etc..) peut se placer dans la Vigie,<br />comme fils d'un autre document, et comme père d'un autre document (et il est alors classeur).<br /><br /></span><img src=Vigie-FilsEtPere-00.png ><span style="font-size:9pt"><br /><br />ci-dessus nous voyons que </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Photo à l'âge de 67 ans</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> est le fils de '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Fiche Administrative</span><span style="font-style:italic;font-size:9pt">'<br /></span><span style="font-size:9pt"><br /></span><img src=bulletcyan01.png ><span style="font-size:9pt">Dès qu'un document est père d'un fils, il devient </span><span style="font-size:9pt;font-weight:600">classeur</span><span style="font-size:9pt">, car il en contient d'autres.<br />Ci-dessus nous voyons que </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Fiche Administrative</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> est un classeur contenant : </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Photo à l'âge de 67 ans</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt">.<br /><br /><img src=bulletcyan01.png >Un fils peut avoir plusieurs pères (et être classé dans deux classeurs différents).<br /><br /><img src=Vigie-DoubleFils.png ><br />Nous voyons dans l'exemple ci-dessus que </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Photo à l'âge de 67 ans</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> est classé et présent dans, <br />le </span><span style="font-size:9pt;font-weight:600">classeur</span><span style="font-size:9pt"> : </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Administratif_Social/Fiche Administrative</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> et <br />le </span><span style="font-size:9pt;font-weight:600">classeur</span><span style="font-size:9pt"> : '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Dermatologie</span><span style="font-size:9pt">' car il est intéressant d'avoir la photo du patient dans la fiche administrative<br />d'ailleurs la voici :</span><img src=Vigie-PhotoDuPatient.png ><span style="font-size:9pt"><br />et du fait de cette curieuse lésion cutanée</span><img src=Vigie-PhotoDuPatient-Inside.png ><span style="font-size:9pt">que présente ce patient sur l'abdomen, il est impératif qu'elle soit aussi dans le classeur : '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Dermatologie</span><span style="font-size:9pt">'<br /><br /><img src=bulletcyan01.png >Enfin ! Un fils ne peut pas être parent de son père (on n'a jamais vu ça).</span></div></ul>
<p><span style="font-size:9pt;font-weight:600"><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">5.2 Vue générale et description</span><span style="font-size:9pt"> : <br /><br /><a name="5.2.1_Placement_et_dispositon_de_la_vigie_,"></a></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">5.2.1 Placement et disposition de la vigie</span><span style="font-size:9pt;text-decoration:underline"> </span><span style="font-size:9pt">:<br />° Il est possible de la faire </span><span style="font-size:9pt;font-weight:600">apparaître et disparaître</span><span style="font-size:9pt"> à tout moment à l'aide de la touche </span><span style="font-size:9pt;font-weight:600">F4</span><span style="font-size:9pt"> ou de l'appui et clic sur le bouton : </span><img src=Vigie-Activer-F4-00.png ><br /><br /><span style="font-size:9pt">° La Vigie est un composant pouvant se placer n'importe où dans l'interface de MedinTux, dans les espaces de stockages latéraux, supérieurs, inférieurs de MedinTux, les mêmes espaces que le Glossaire, la Vue Rapide, les barre d'outils divers, etc.<br /><br />° Il vous est possible de la déplacer où vous le souhaitez, et d'enregistrer la disposition de votre espace de travail ainsi que toute la configuration de la Vigie (filtres etc..) ,dans le profil vous concernant, en cliquant sur l'option de menu </span><span style="font-size:9pt;font-weight:600">Fichier-&gt;Enregistrer les profils</span><span style="font-size:9pt">.<br /><br /></span><img src=Vigie-EnregistrerPofils.png >Vaccinations<br /><span style="font-size:9pt"><br />(voir organisation de l'espace de travail) afin de toujours retrouver cette organisation.<br /><br /><a name="5.2.2_La_vigie_se_divise_en_deux_parties"></a></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">5.2.2 La vigie se divise en deux parties</span><span style="font-size:9pt"> : <br />° La partie haute </span><span style="font-size:9pt;font-weight:600">le</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">filtrage</span><span style="font-size:9pt"> (encadrée en rouge) comportant tous les éléments permettant de la piloter, de la paramétrer et la commander.<br />° La partie basse avec </span><span style="font-size:9pt;font-weight:600">la</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">liste hiérarchique des classeurs et documents</span><span style="font-size:9pt"> la composant.</span></p>
<p><img src=Vigie-VueGénérale-02.png ></p>
<p><span style="font-size:9pt;font-weight:600;text-decoration:underline">5.2.2.1 La liste hiérarchique se présente comme suit</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.1 </span><img src=bulletcyan01.png ><span style="font-size:9pt">Une ligne avec le nom du patient auquel appartient la liste des classeurs et documents sous-jacents.<br /></span><img src=Vigie-NomPatient.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.2 </span><span style="font-size:9pt"><img src=bulletcyan01.png >Les lignes des classeurs et documents correspondants à ce patient<br /><br /><img src=Vigie-VueListe.png ><br /><br />À chacune des lignes de la vigie correspond un document de MedinTux. Si vous cliquez sur une des lignes, le document lié à cette ligne est activé dans l'affichage des rubriques de MedinTux comme le montre la figure ci-dessous : la sélection de la ligne '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Fiche Administrative</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> affiche et active bien le document correspondant dans la rubrique '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Observation</span><span style="font-size:9pt">'.<br /><br /></span><img src=Vigie-SelectionDocument-01.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.3 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Ouvrir et fermer un classeur</span><span style="font-size:9pt"> :<br /><br />Nous pouvons voir des </span><span style="font-size:9pt;text-decoration:underline">classeurs ouverts</span><span style="font-size:9pt">, </span><span style="font-style:italic;font-size:9pt">'</span><span style="font-style:italic;font-size:9pt;color:#00007f">Administratif_Social/Fiche Administrative</span><span style="font-style:italic;font-size:9pt">'</span><span style="font-size:9pt"> et dont le contenu est visible. Notons le petit symbole </span><img src=Vigie-SymbOuvert.png ><span style="font-size:9pt">situé à gauche d'un classeur indiquant que celui-ci est ouvert, pour le fermer il suffit de cliquer dessus.<br /><img src=Vigie-VueClasseurOuvert.png ><br /><br />Nous pouvons voir </span><span style="font-size:9pt;text-decoration:underline">un classeur fermé</span><span style="font-size:9pt"> '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Dermatologie</span><span style="font-size:9pt">' dont le contenu est non visible. Notons le petit symbole </span><img src=Vigie-SymbFerme.png ><span style="font-size:9pt">situé à gauche d'un classeur indiquant que celui-ci est fermé, pour l'ouvrir il suffit de cliquer dessus, ce qui donne l'affichage suivant :<br /><img src=Vigie-ClasseurOuvert.png ><br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.4 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Déplacer un classeur ou document d'un classeur à l'autre</span><span style="font-size:9pt"> :<br />Dans le classeur '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Non classés</span><span style="font-size:9pt">' se trouve le document '</span><span style="font-style:italic;font-size:9pt;color:#00007f">OBSERV_STANDARD</span><span style="font-size:9pt">' que vous souhaiteriez déplacer dans le classeur '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Neurologie</span><span style="font-size:9pt">'. <br /></span><img src=Vigie-DeplacementClasseur.png ><br /><span style="font-size:9pt"><br />Pour cela, cliquez avec le bouton gauche de la souris sur la ligne '</span><span style="font-style:italic;font-size:9pt;color:#00007f">OBSERV_STANDARD</span><span style="font-size:9pt">' et tout en maintenant le bouton gauche de la souris appuyé, déplacez la souris au-dessus du classeur '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Neurologie</span><span style="font-size:9pt">' et, lorsque la souris est bien au-dessus de ce classeur, relâchez le bouton gauche de la souris. Vous devriez avoir l'affichage suivant :<br /></span><img src=Vigie-DeplacementClasseurResultat.png ><span style="font-size:9pt"><br />Lorsque le déplacement s'opère sur un classeur avec toute une hiérarchie déjà constituée, tous les descendants sont aussi déplacés et reclassés.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.5 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Placer et classer un document déjà existant d'une rubrique dans un classeur</span><span style="font-size:9pt"> :<br />Pour cela, cliquez sur le bouton indiquant le nombre de documents d'une rubrique et, tout en maintenant le bouton gauche de la souris appuyé, déplacez la souris au-dessus du classeur de destination dans lequel vous désirez classer le document, et, lorsque la souris est bien au-dessus de ce classeur, relâchez le bouton gauche de la souris.<br /><br /></span><img src=Vigie-DragDocOnVigie.png ><br /><span style="font-size:9pt"><br />Dans l'exemple de la figure ci-dessus, nous classons le document déjà existant '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Photo à l'âge de 67 ans</span><span style="font-size:9pt">' dans le classeur '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Digestive</span><span style="font-size:9pt">' comme montré dans la figure ci-dessous, le résultat après l'opération.<br /><br /></span><img src=Vigie-DragDocOnVigieResultat.png ><br /><br /><span style="font-size:9pt;font-weight:600">5.2.2.1.6 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Créer et classer un document du </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Glossaire</span><span style="font-size:9pt;text-decoration:underline"> dans un classeur</span><span style="font-size:9pt"> :<br />Cette opération permet d'ajouter et de créer dans le dossier un document à partir d'un modèle du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">, tout en le classant. Pour cela, cliquez avec le bouton gauche de la souris sur le modèle du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt"> avec lequel vous désirez créer un nouveau document dans le dossier ici '</span><span style="font-style:italic;font-size:9pt;color:#00007f">compterendu.html</span><span style="font-size:9pt">' et tout en maintenant le bouton gauche de la souris appuyé, déplacez la souris au-dessus du classeur de destination ici '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Non classés</span><span style="font-size:9pt">' et, lorsque la souris est bien au-dessus de ce classeur, relâchez le bouton gauche de la souris. <br /><br /><img src=Vigie-CreateFromGlossaire.png ><br /><br />un nouveau document '</span><span style="font-style:italic;font-size:9pt;color:#00007f">compterendu.html</span><span style="font-size:9pt">' sera créé dans le dossier du patient, et il sera en même temps classé dans le classeur '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Non classés</span><span style="font-size:9pt">'.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.7 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Ne permettre qu'une seule instance d'un classeur</span><span style="font-size:9pt"> :<br />Dans notre système de classement, nous souhaitons avoir des classeurs uniques ne pouvant pas être présents plusieurs fois dans la vigie. En effet, un classeur tel que '</span><span style="font-style:italic;font-size:9pt;color:#00007f">Administratif_Social</span><span style="font-size:9pt">' destiné à recevoir tous les documents administratif et sociaux, n'a pas être multiple mais unique au système de classement. Pour le rendre unique, </span><span style="font-size:9pt;font-weight:600">sélectionnez-le à l'aide du bouton droit de la souris.</span><span style="font-size:9pt"> Cela fera apparaître le menu suivant : <br /><br /><img src=Vigie-PopMenuUnique.png ><br />dans lequel vous sélectionnerez l'option '</span><span style="font-size:9pt;font-weight:600">Cet élément doit être le seul de la fratrie</span><span style="font-size:9pt">', une icône :</span><img src=Vigie-PopMenuUniqueIcone.png ><span style="font-size:9pt"> indiquera que ce classeur ne peut être qu'unique et présent qu'une fois.<br />Pour annuler cette propriété et permettre à un classeur d'être de nouveau en plusieurs exemplaires, sélectionnez l'option '</span><span style="font-size:9pt;font-weight:600">Cet élément peut être multiple dans la fratrie</span><span style="font-size:9pt">'.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.8 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Placer un classeur en mode ouvert par défaut</span><span style="font-size:9pt"> :<br />Il est possible de déterminer pour un classeur si il doit être ouvert ou fermé, afin que son contenu soit affiché ou non lors de l'affichage de la vigie.<br />Pour qu'il soit ouvert, </span><span style="font-size:9pt;font-weight:600">sélectionnez à l'aide du bouton droit de la souris</span><span style="font-size:9pt"> le classeur pour lequel vous désirez que cette propriété soit activée, et cliquez sur l'option : '</span><span style="font-size:9pt;font-weight:600">Cet élément doit être ouvert par défaut</span><span style="font-size:9pt">'.<br />Pour annuler cette propriété et permettre à un classeur d'être de nouveau fermé par défaut, sélectionnez l'option '</span><span style="font-size:9pt;font-weight:600">Cet élément doit être fermé par défaut</span><span style="font-size:9pt">'.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.9 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Choisir une icône pour un classeur</span><span style="font-size:9pt"> :<br />Il est possible de choisir pour un classeur donné une icône le représentant.<br />Pour cela </span><span style="font-size:9pt;font-weight:600">sélectionnez à l'aide du bouton droit de la souris</span><span style="font-size:9pt"> le classeur pour lequel vous désirez que cette propriété soit activée, et cliquez sur l'option : '</span><span style="font-size:9pt;font-weight:600">Choisir une icône pour cet élément</span><span style="font-size:9pt">' et, à l'aide du sélecteur de fichiers, sélectionnez en une de votre choix.<br />Pour annuler cette propriété et permettre à un classeur d'être de nouveau sans icône, sélectionnez l'option '</span><span style="font-size:9pt;font-weight:600">Retirez l'icône pour cet élément</span><span style="font-size:9pt">'.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.10 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Retirer un document du système de classement de la vigie </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">sans l'effacer</span><span style="font-size:9pt;text-decoration:underline"> du dossier</span><span style="font-size:9pt"> :<br />Il est possible de retirer un classeur ou document du système de classement.<br />Pour cela </span><span style="font-size:9pt;font-weight:600">sélectionnez le à l'aide du bouton droit de la souris</span><span style="font-size:9pt"> le classeur ou le document que vous désirez retirer de la vigie, et cliquez sur l'option : '</span><span style="font-size:9pt;font-weight:600">Positionnez cet élément sur effacement</span><span style="font-size:9pt">' cela fera apparaître en face de l'élément sélectionné et de toute sa descendance l'icône suivante </span><img src=Vigie-ToRemove.png ><span style="font-size:9pt">. <br /><br /></span><img src=Vigie-ToRemoveClass.png ><br /><span style="text-decoration:underline">IMPORTANT</span> :<span style="font-size:9pt"> lors de cette opération, </span><span style="font-size:9pt;font-weight:600">les documents ne sont pas effacés du dossier</span><span style="font-size:9pt">, ils sont seulement retirés du système de classement. Pour les effacer du dossier, il faut une autre option du menu que nous allons voir ci-dessous.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.1.11</span><span style="font-size:9pt">° </span><span style="font-size:9pt;text-decoration:underline">Retirer </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">et effacer</span><span style="font-size:9pt;text-decoration:underline"> un document du dossier à partir du système de classement</span><span style="font-size:9pt"> :<br />Il est possible de retirer un classeur et sa descendance ou document du système de classement et en même temps effacer ceux-ci du dossier patient.<br />Pour cela, </span><span style="font-size:9pt;font-weight:600">sélectionnez à l'aide du bouton droit de la souris</span><span style="font-size:9pt"> le classeur ou le document que vous désirez retirer de la vigie, et cliquez sur l'option : '</span><span style="font-size:9pt;font-weight:600">Positionnez cet élément et les fiches allant avec, sur effacement</span><span style="font-size:9pt">' cela fera apparaître en face de l'élément sélectionné et de toute sa descendance l'icône suivante </span><img src=Vigie-ToDelete.png ><span style="font-size:9pt">. <br /><br /></span><img src=Vigie-ToDeleteClass.png ><br /><img src=alaune.png ><span style="font-weight:600;text-decoration:underline;color:#ff0000">IMPORTANT</span> :<span style="font-size:9pt"> lors de cette opération, les documents ne sont </span><span style="font-size:9pt;font-weight:600;text-decoration:underline;color:#ff0000">considérés comme à effacer du dossier</span><span style="font-size:9pt">, qu'en même temps qu'ils sont retirés du système de classement. <br />Tant que le dossier du patient n'est pas enregistré, cette opération est réversible en cliquant sur l'option '</span><span style="font-size:9pt;font-weight:600">Retirez cet élément et les fiches allant avec, de ceux à effacer</span><span style="font-size:9pt">'<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Les commandes de filtrage</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.1 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Activer désactiver le filtrage :<br /></span><span style="font-size:9pt"><br />Lors de certaines manipulations, il vous sera utile de désactiver ou activer les filtres.<br />Pour cela cochez ou décochez la case suivante : </span><img src=Vigie-Filtre-CaseActiver.png ><br /><span style="font-size:9pt"><br />Ci-dessous, l'interface de commande de la Vigie.<br /></span><img src=Vigie-Filtre-gui.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.2 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Le filtre des dates ou fenêtre de dates de la Vigie</span><span style="font-size:9pt"><br /><br />Chaque classeur ou document de la vigie, possède une date de début et une date de fin.<br />Tant que la date de fin n'est pas positionnée ou renseignée, un classeur est considéré comme en cours ; dès qu'elle est renseignée, il est considéré comme plus en cours ou archivé.<br /><br /><img src=Vigie-Filtre-DateClasseurs.png ><br /><br />dans la figure ci dessus nous pouvons voir que le </span><span style="font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt"> est archivé car il comporte une date et heure de fin :</span><span style="font-style:italic;font-size:9pt"> </span><span style="font-style:italic;font-size:9pt;font-weight:600">03-05-2009 à 08h51</span><span style="font-size:9pt"><br />il est encore visible dans la vigie, car le filtre de date ou fenêtre de date de la vigie le permet. <br />En effet, les dates de début et de fin du classeur : </span><span style="font-style:italic;font-size:9pt;font-weight:600">12-03-2009 à 15h30</span><span style="font-size:9pt"> et </span><span style="font-style:italic;font-size:9pt;font-weight:600">03-05-2009 à 08h51</span><span style="font-size:9pt"> sont situées dans la fenêtre de dates de la vigie, comprise entre </span><span style="font-style:italic;font-size:9pt;font-weight:600">01-01-2000 à 00h00</span><span style="font-size:9pt"> et de fin : </span><span style="font-style:italic;font-size:9pt;font-weight:600">28-03-2009 à 23h59<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.3 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Modifier le filtre des dates ou fenêtre de dates de la Vigie</span><span style="font-size:9pt"><br />Il est possible de modifier la fenêtre de dates de la vigie en cliquant sur l'icône </span><img src=Vigie-Filtre-DateModIconeDeb.png ><span style="font-size:9pt">pour modifier la date de début, et l'icône </span><img src=Vigie-Filtre-DateModIconeFin.png ><span style="font-size:9pt">pour la date de fin, ces icônes sont situées dans le bandeau des dates de la vigie :<br /><br /></span><img src=Vigie-Filtre-DateBandeau.png ><span style="font-size:9pt"><br /><br />Ci-dessous, nous voyons que la modification de la fenêtre de dates de la vigie : </span><span style="font-style:italic;font-size:9pt;font-weight:600">03-05-2009 à 10h30</span><span style="font-size:9pt"> et de fin : </span><span style="font-style:italic;font-size:9pt;font-weight:600">06-05-2009 à 23h59</span><span style="font-size:9pt"> ne permet plus l'affichage du classeur </span><span style="font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt"> mais seulement celui de </span><span style="font-size:9pt;color:#ff0000">Historique du dossier</span><span style="font-size:9pt"> qui ne possède pas de date de fin et est donc encore ouvert ou actif .<br /><br /></span><img src=Vigie-Filtre-DateClasseursArchiveHistoVisible.png ><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.4 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Qu'est un filtre de classeurs et à quoi sert-il</span><span style="font-size:9pt;font-weight:600"> ?</span><span style="font-size:9pt"><br /><br />Lors de votre travail vous souhaiterez parfois ne voir que certains classeurs. Par exemple vous et plus particulièrement votre secrétaire désirera ne voir que le contenu du</span><span style="font-size:8pt"> </span><span style="font-size:8pt;font-weight:600">classeur</span><span style="font-size:8pt"> </span><span style="font-size:8pt;color:#ff0000">Administratif_Social</span><span style="font-size:9pt">. Cela est possible à l'aide des filtres de classeurs. Un filtre de classeurs est tout simplement une liste de classeurs qui seront ceux et seulement ceux affichés lors de la sélection de ce filtre. <br /><br />Chaque filtre possède un nom et peut être activé dans la liste déroulante de choix des filtres. <br />Ci-dessous la liste déroulante des filtres montrant le filtre </span><span style="font-size:9pt;font-weight:600">Médecin</span><span style="font-size:9pt"> en cours de sélection.<br /><br /></span><img src=Vigie-Filtre-ComboListe.png ><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.5 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Créer un filtre de classeurs par l'exemple</span><span style="font-size:9pt"><br />Dans l'exemple ci-dessus nous avons vu qu'il était peut être utile de créer pour notre secrétaire, un filtre de classeurs ne permettant de rendre visible que le classeur </span><span style="font-size:8pt;color:#ff0000">Administratif_Social</span><span style="font-size:9pt">.<br />Nous nommerons ce filtre </span><span style="font-size:9pt;color:#ff0000">Secrétaire</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.5.1 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Ajouter un filtre de classeurs</span><span style="font-size:9pt"><br />° Désactivez le filtre de classeurs en décochant la case : </span><img src=Vigie-Filtre-CaseActiver.png ><span style="font-size:9pt">afin de rendre tous les classeurs visibles.<br />° Cliquez sur l'icône </span><img src=FiltrePlus.png ><span style="font-size:9pt">cela fera apparaître la boîte de dialogue suivante :<br /><br /></span><img src=Vigie-Filtre-Ajouter.png ><span style="font-size:9pt"><br />° saisissez y le nom du filtre : </span><span style="font-size:9pt;color:#ff0000">Secrétaire </span><span style="font-size:9pt">et confirmez. Pour l'instant, ce filtre </span><span style="font-size:9pt;color:#ff0000">Secrétaire </span><span style="font-size:9pt">a une liste répertoires vides, donc ne sert à rien.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.5.2 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Ajouter un classeur au filtre de classeurs<br /></span><span style="font-size:9pt"><br />° Sélectionnez le filtre nouvellement créé </span><span style="font-size:9pt;color:#ff0000">Secrétaire</span><span style="font-size:9pt"> dans la combobox de sélection des filtres de classeurs.<br /></span><img src=Vigie-Filtre-SelectSecretaire.png ><span style="font-size:9pt"><br />° puis dans la liste des classeurs de la Vigie, positionnez vous à l'aide de la souris au dessus du classeur : </span><span style="font-size:8pt;color:#ff0000">Administratif_Social </span><span style="font-size:9pt">et cliquez à l'aide du bouton droit de la souris pour faire apparaître le menu contextuel dans lequel vous sélectionnerez avec le bouton gauche de la souris l'option : </span><span style="font-size:9pt;font-weight:600">Ajouter ce classeur à la liste du filtre en cours</span><span style="font-size:9pt"><br />Il est possible de rajouter d'autres classeurs au filtre de classeurs avec la même méthode.<br /><br /></span><img src=Vigie-Filtre-SelectOption.png ><br /><span style="font-size:9pt">° Activez le filtre de classeurs en cochant la case : </span><img src=Vigie-Filtre-CaseActiver.png ><span style="font-size:9pt">afin de rendre les filtres actifs.</span><br /><span style="font-size:9pt">° Sélectionnez le filtre nouvellement créé </span><span style="font-size:9pt;color:#ff0000">Secrétaire</span><span style="font-size:9pt"> dans la combobox de sélection des filtres de classeurs.<br /><br /></span><img src=Vigie-Filtre-SelectSecretaire.png ><br /><span style="font-size:9pt"><br />vous devriez avoir l'affichage suivant, ne montrant que les classeurs </span><span style="font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt">/</span><span style="font-size:8pt;color:#ff0000">Administratif_Social </span><span style="font-size:9pt">avec leurs contenus. Ici nous avons activé l'option </span><span style="font-size:9pt;font-weight:600">Tous les patients</span><span style="font-size:9pt"> pour mieux voir l'effet du filtre sur plusieurs patients.<br /><br /></span><img src=Vigie-Filtre-SecretaireActif.png ><br /><br /><span style="font-size:9pt;font-weight:600">5.2.2.2.6 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Modifier le filtre de classeurs</span><span style="font-size:9pt"><br />Restons dans l'exemple ci-dessus avec le filtre de classeurs </span><span style="font-size:9pt;color:#ff0000">Secrétaire</span><span style="font-size:9pt"> activé et cliquons sur l'icône </span><img src=Filtre.png ><span style="font-size:9pt">cela fera apparaître la boîte de dialogue suivante :<br /><br /></span><img src=Vigie-Filtre-SecretaireResultat.png ><span style="font-size:9pt"><br /><br />où nous voyons bien que le </span><span style="font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt">/</span><span style="font-size:8pt;color:#ff0000">Administratif_Social </span><span style="font-size:9pt">est bien présent dans la liste, cette liste peut être modifiée à la main, chaque classeur du filtre doit être sur une ligne séparée. Lisez le petit texte d'aide de ce dialogue. <br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.7 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Effacer un filtre de classeurs</span><span style="font-size:9pt"><br />° Sélectionnez le filtre à effacer dans la combobox de sélection des filtres de classeurs et cliquez sur l'icône </span><img src=FiltreMoins.png ><span style="font-size:9pt">cela effacera après confirmation le filtre de classeur en cours.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.2.8 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Voir tous les dossiers ou le dossier en cours :</span><span style="font-size:9pt"><br />La vigie permet de visualiser l'ensemble des classeurs en cours ou seulement ceux du patient en cours.<br />Ci-dessous une vue avec l'option : </span><span style="font-size:9pt;font-weight:600">Tous les patients</span><span style="font-size:9pt"> <br /><br /></span><img src=Vigie-Filtre-TousDossiers.png ><br /><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">5.2.2.3 </span><span style="font-size:9pt">° </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Les cinq cases de propriétés d'un document (classeur ou document) de la Vigie</span><span style="font-size:9pt"> :<br /><br />Nous remarquerons que chaque ligne de la Vigie comporte cinq cases entourées d'un rectangle gris. <br />Ces cases sont appelées </span><span style="font-size:9pt;font-weight:600">cases de propriétés</span><span style="font-size:9pt"> elles servent à placer des indications de votre choix que vous jugez utiles d'indiquer. Cela est laissé libre à votre imagination.<br /><br />À chacune de ces cases, il est possible d'affecter une liste déroulante de votre choix permettant d'offrir des options prédéterminées pour remplir ces cases.<br />Les valeurs de chacune de ces cases, peuvent faire l'objet de requêtes SQL .<br /><br /><br /></span><img src=Vigie-CasesPropr-00.png ><br /><br /><a name="5.3_La_Vigie_par_l'exemple_,_réalisation_d'un_classeur_de_Vaccinations"></a><span style="font-size:9pt;font-weight:600">5.3</span> <span style="font-size:9pt;font-weight:600;text-decoration:underline">La Vigie par l'exemple : réalisation d'un classeur de Vaccinations</span><br /><br /><span style="font-size:9pt">Cet exemple va nous permettre de réaliser un </span><span style="font-size:9pt;font-weight:600">Classeur de suivi des vaccinations.</span><span style="font-size:9pt"> <br /><br /><a name="5.3.1_-_Élaboration_et_édition_du_document_insérant_automatiquement_le_classeur_Vaccinations"></a></span><span style="font-size:9pt;font-weight:600">5.3.1</span><span style="font-size:9pt"> - </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Élaboration et édition du document insérant automatiquement le classeur Vaccinations</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.1 </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramétrage du document par défaut de définition des classeurs</span><span style="font-size:9pt;font-weight:600"> :</span><span style="font-size:9pt"><br />Lors de la création d'un dossier patient, la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt"> charge un document type qui est chargé de créer tous les classeurs par défaut que vous souhaitez voir installés lors de la création d'un nouveau dossier patient. <br />Le chemin de ce document type est indiqué dans le fichier </span><span style="font-size:9pt;font-weight:600">Manager.ini</span><span style="font-size:9pt"> dans la section</span><span style="font-size:9pt;font-weight:600"> [Vigie]</span><span style="font-size:9pt"> au niveau de la variable </span><span style="font-size:9pt;font-weight:600">Defaut</span><span style="font-size:9pt"> comme indiqué ci-après.</span></p>
<ul type="disc"><div><span style="font-size:9pt;font-weight:600">[Vigie]<br /></span><span style="font-size:9pt;color:#aa0000">Defaut</span><span style="font-size:9pt"> </span><span style="font-size:9pt;color:#0000ff">=</span><span style="font-size:9pt"> </span><span style="font-size:9pt;color:#ff0000">$Glossaire/Vigie/Classeur_Médecine_Générale.html</span></div></ul>
<p><span style="font-size:9pt;text-decoration:underline">Note</span><span style="font-size:9pt"> : </span><span style="font-size:9pt;font-weight:600">$Glossaire</span><span style="font-size:9pt"> sera remplacé par le chemin réel de l'emplacement du </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;text-decoration:underline">Désactivation de l'automatisme</span><span style="font-size:9pt"> : si vous placez un signe étoile en premier caractère </span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> *</span><span style="font-size:9pt;font-weight:600">$Glossaire/truc/bidule </span><span style="font-size:9pt">le système de classeur par défaut sera désactivé et les messages d'erreurs concernant la non validité éventuelle du fichier seront aussi invalidés. <br /><br /></span><span style="font-size:9pt;text-decoration:underline">Mode silencieux de l'automatisme</span><span style="font-size:9pt"> : si vous placez un signe deux points en premier caractère </span><span style="font-size:9pt;text-decoration:underline">exemple</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600">:/home/toto/truc/bidule </span><span style="font-size:9pt">le système de classeur par défaut sera silencieux et les messages d'erreurs concernant la non validité éventuelle d'un fichier seront invalidés. <br /><br /></span><span style="font-size:9pt;text-decoration:underline">Rappel</span><span style="font-size:9pt"> : le fichier </span><span style="font-size:9pt;font-weight:600">Manager.ini</span><span style="font-size:9pt"> se trouve au niveau du répertoire : </span><span style="font-size:9pt;font-weight:600">MedinTux/Manager/bin </span><span style="font-size:9pt">dans notre exemple ce fichier est : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale.html</span><span style="font-size:9pt"><br />Pour modifier et éditer ce fichier, placez la souris au-dessus de la </span><span style="font-size:9pt;font-weight:600">Vigie</span><span style="font-size:9pt"> afin d'activer le </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt"> sur le répertoire qui lui est affecté, puis positionnez la souris au-dessus du fichier : </span><span style="font-style:italic;font-size:9pt">Classeur_Médecine_Générale.html </span><span style="font-size:9pt">et cliquez avec le bouton droit de la souris afin de faire apparaître le menu contextuel, et cliquez avec le bouton gauche sur l'option menu </span><span style="font-style:italic;font-size:9pt">Modifier et éditer ce modèle</span><span style="font-size:9pt">.<br /><br /></span><img src=Vigie-TutoVaccins_EditerModele.png ><span style="font-size:9pt"><br /><br />Cela lancera le logiciel </span><span style="font-size:9pt;font-weight:600">QLightPad</span><span style="font-size:9pt"> avec en édition le fichier : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale.html</span><span style="font-size:9pt"><br />comme nous pouvons le voir ci-dessous :<br /><br /></span><img src=Vigie-TutoVaccins_EditerModeleQLP.png ><span style="font-size:9pt"><br /><br />Nous pouvons voir dans ce fichier une grande macro de plusieurs lignes encadrée par {{ }}<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.2 </span><span style="font-size:9pt;text-decoration:underline">La première ligne comporte une macro de création de classeur à partir du document où elle est présente</span><span style="font-size:9pt"> : <br /></span><span style="font-size:9pt;font-weight:600">{{::Append_doc_in_classeur ()}}\</span><span style="font-size:9pt"> <br />Cette instruction ordonne à la Vigie de MedinTux de placer le document en cours au niveau de la hiérarchie indiquée entre parenthèses (ici en racine du système de classeurs car vide). Cela créera le classeur : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt"> (nom du fichier où est présente la macro) en racine du système de classeurs.<br />Une macro </span><span style="font-size:9pt;font-weight:600">Append_doc_in_classeur ()</span><span style="font-size:9pt"> avec une hiérarchie vide est une macro de création de </span><span style="font-size:9pt;font-weight:600">classeur racine</span><span style="font-size:9pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.3</span><span style="font-size:9pt"> </span><span style="font-size:9pt;text-decoration:underline">La deuxième ligne comporte une macro d'importation de document</span><span style="font-size:9pt"> : <br /></span><span style="font-size:8pt;font-weight:600">{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.html , new noInquire, Documents)}}\<br /></span><span style="font-size:9pt">Cette instruction ordonne simplement à MedinTux d'importer et charger le document suivant : </span><span style="font-style:italic;font-size:8pt;color:#ff0000">$Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.htm</span><span style="font-size:8pt;color:#ff0000">l</span><span style="font-size:9pt">.<br /><br />Le paramètre </span><span style="font-size:8pt;font-weight:600">new </span><span style="font-size:9pt">indique de créer un nouveau document.<br />Le paramètre </span><span style="font-size:8pt;font-weight:600">noInquire</span><span style="font-size:9pt"> indique de ne pas demander de confirmer au cas où il y aurait déjà un document créé à cette date.<br />Le paramètre </span><span style="font-size:8pt;font-weight:600">Documents</span><span style="font-size:9pt"> indique que le document doit être placé dans la rubrique Documents.<br /><br />Toujours à l'aide de </span><span style="font-size:9pt;font-weight:600">QLightPad</span><span style="font-size:9pt"> éditons ce document : <br /><br /></span><img src=Vigie-TutoVaccins_EditerModeleCardioVasc.png ><br /><span style="font-size:9pt"><br />nous y voyons également une macro ou instruction de création de classeur.<br /><br /></span><span style="font-size:8pt;font-weight:600">{{\<br />{{::Append_doc_in_classeur (Classeur_Médecine_Générale)}}\<br />}}</span><span style="font-size:9pt"><br /><br />Mais cette fois, la hierarchie indiquée entre parenthèses n'est pas vide et indique : </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt"><br />ordonnant à la Vigie de MedinTux de créer le classeur : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">CardioVasculaire</span><span style="font-size:9pt"> comme classeur fils du classeur </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt">.<br />cela donnera au niveau de la Vigie la structure de classeurs suivante :<br /><br /></span><img src=Vigie-TutoVaccins_AjouterModeleCardioVasc.png ><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.4 </span><span style="font-size:9pt;text-decoration:underline">En résumé avec seulement les deux instructions suivantes</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:8pt;font-weight:600">{{::Append_doc_in_classeur ()}}\</span><span style="font-size:8pt"> <br /></span><span style="font-size:8pt;font-weight:600">{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.html , new noInquire, Documents)}}</span><span style="font-size:8pt"><br /><br />il est possible d'organiser et paramètrer n'importe quel système de classeur.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.5 </span><span style="font-size:9pt;text-decoration:underline">Rajouter la macro important le document du classeur Vaccinations </span><span style="font-size:9pt">: dans le document de paramétrage du système de classeur par défaut.<br /><br />- Reprenons le document qui paramètre le système de classeurs par défaut de la Vigie : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale.html</span><span style="font-style:italic;font-size:9pt"><br /><br /></span><span style="font-size:8pt">{{\<br />{{::Append_doc_in_classeur ()}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Respiratoire_ORL.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Locomoteur_Traumatismes.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Digestive.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Troubles_Mentaux.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Endocrino_Métabolisme_Nutrition.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Prévention.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Génital_Urinaire.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Infectieuse.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Dermatologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Neurologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Tumeurs.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Ophtalmologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Affections_rares.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Patho_en_cours_non_résolue.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Administratif_Social.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Non classés.html , new noInquire, Documents)}}\<br />}}<br /></span><span style="font-size:9pt"><br />- Rajoutons la ligne suivante <br /><br /></span><span style="font-size:7pt">{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Vaccinations.html , new noInquire, Documents)}}\</span><span style="font-size:9pt"><br /><br />juste après </span><span style="font-size:7pt">{{::Append_doc_in_classeur ()}}\</span><span style="font-size:9pt"> nous devrions avoir : <br /></span><span style="font-style:italic;font-size:9pt"><br /></span><span style="font-size:8pt">{{\<br />{{::Append_doc_in_classeur ()}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Vaccinations.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Respiratoire_ORL.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Locomoteur_Traumatismes.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Digestive.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Troubles_Mentaux.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Endocrino_Métabolisme_Nutrition.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Prévention.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Génital_Urinaire.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Infectieuse.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Dermatologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Neurologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Tumeurs.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Ophtalmologie.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Affections_rares.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Patho_en_cours_non_résolue.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Administratif_Social.html , new noInquire, Documents)}}\<br />{{::import ($Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/Non classés.html , new noInquire, Documents)}}\<br />}}</span><span style="font-size:7pt"><br /><br /></span><span style="font-size:9pt">- Enregistrons le résultat.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.6 </span><span style="font-size:9pt;text-decoration:underline">Créer le document du classeur Vaccinations </span><span style="font-size:9pt">:<br /><br />Pour nous faciliter la vie, vous allez partir d'un classeur déjà existant exemple </span><span style="font-style:italic;font-size:8pt;color:#ff0000">CardioVasculaire.htm</span><span style="font-size:8pt;color:#ff0000">l</span><span style="font-size:9pt"> et le modifier pour en faire le classeur Vaccinations.<br />Toujours à l'aide de </span><span style="font-size:9pt;font-weight:600">QLightPad</span><span style="font-size:9pt"> ouvrez le document : </span><span style="font-style:italic;font-size:8pt;color:#ff0000">$Glossaire/Vigie/Classeur_Médecine_Générale/Classeurs/CardioVasculaire.htm</span><span style="font-size:8pt;color:#ff0000">l</span><span style="font-size:9pt"><br />Son contenu est le suivant :<br /><br /></span><span style="font-size:8pt">{{\<br />{{::Append_doc_in_classeur (Classeur_Médecine_Générale)}}\<br />}}</span><span style="font-size:7pt"><br /></span><span style="font-size:8pt"><br /></span><span style="font-size:8pt;font-weight:600">Ne modifiez pas le texte</span><span style="font-size:8pt"> de ce document mais enregistrez le simplement avec l'option menu </span><span style="font-size:8pt;font-weight:600">Enregistrer sous</span><span style="font-size:8pt"> en changeant le nom par </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Vaccinations.html.</span><span style="font-size:8pt"><br />cela a pour effet de créer un nouveau document et fichier : </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Vaccinations.html</span><span style="font-size:8pt"> qui lors du chargement dans MedinTux créera le classeur </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Vaccinations.</span><span style="font-size:8pt"> (nom du ficher) fils du classeur </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt"> comme indiqué par la macro : <br /><br /></span><span style="font-size:8pt">Append_doc_in_classeur (Classeur_Médecine_Générale)</span><span style="font-size:9pt"> </span><span style="font-size:8pt">.<br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.7 </span><span style="font-size:9pt;text-decoration:underline">Créer le répertoire Vaccinations </span><span style="font-size:9pt">: dans lequel seront placés tous les modèles et documents types relatifs aux vaccinations (ordonnances, certificats etc...)<br />Lorsque la Vigie retrouve dans le </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt"> un système de répertoires reproduisant sa hiérarchie de classeurs, lors de l'activation d'un classeur elle place le </span><span style="font-size:9pt;font-weight:600">Glossaire</span><span style="font-size:9pt"> sur le répertoir</span><span style="font-size:8pt">e correspondant. <br /><br /></span><img src=Vigie-RepertoiresClasseurs.png ><img src=Vigie-RepertoiresClasseurs1.png ><span style="font-size:8pt"><br />comme vous pouvez le voir dans les figures ci-dessus, la hiérarchie de répertoires du système de fichiers de la Vigie est superposable à la hiérarchie des classeurs. Cette disposition (facultative) permet que lors d'un clic par exemple sur le </span><span style="font-size:8pt;font-weight:600">classeur</span><span style="font-size:8pt"> </span><span style="font-size:8pt;color:#ff0000">Administratif_Social</span><span style="font-size:8pt"> le Glossaire se positionne sur le </span><span style="font-size:8pt;font-weight:600">répertoire</span><span style="font-size:8pt"> </span><span style="font-size:8pt;font-weight:600">Administratif_Social</span><span style="font-size:8pt"> correspondant.<br />Pour respecter cette disposition créez simplement un répertoire </span><span style="font-style:italic;font-size:8pt;color:#ff0000">Vaccinations</span><span style="font-size:8pt"> dans le répertoire </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:8pt"> de la Vigie.<br /><br /></span><img src=Vigie-RepertoiresClasseurs2.png ><span style="font-size:8pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">5.3.1.8 </span><span style="font-size:9pt;text-decoration:underline">Créer un document type de prescription de vaccins dans le répertoire Vaccinations </span><span style="font-size:9pt">:<br /><br />Placez enfin dans le répertoire : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Classeur_Médecine_Générale</span><span style="font-size:9pt">/</span><span style="font-style:italic;font-size:8pt;color:#ff0000">Vaccinations</span><span style="font-size:9pt">/<br />le document suivant : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Vaccination tétanos.html</span><span style="font-size:9pt"><br /></span><span style="font-size:8pt"><br /><br />{{DOC_TYPE=Prescription}}</span><br /><span style="font-size:8pt">{{\<br />{{::Append_doc_in_classeur (Classeur_Médecine_Générale/Vaccinations)}}\<br />}}<br /></span><br />1) Anatoxine tétanique, 1 dose de 0,5 ml<br /><span style="font-size:8pt"><br /></span><span style="font-size:9pt;font-weight:600">5.3.2</span><span style="font-size:9pt"> - </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramétrage d'un classeur automatique par défaut </span><span style="font-size:9pt">:<br /></span><span style="font-size:8pt"><br /></span><span style="font-size:9pt">Tout ce qui précédait nécessitait la mise en place dans chaque document type du </span><span style="font-size:9pt;font-weight:600">Glossaire </span><span style="font-size:9pt">d&quot;une macro précisant dans quel classeur devait être placé le document.<br />Les prescriptions faites avec la base thérapeutique n'avaient pas non plus de possibilité de classement automatique.<br />Pour faire face à ces situations il existe une possibilité qui est la suivante :<br /><br /> </span><span style="font-size:9pt;font-weight:600">5.3.2.1</span><span style="font-size:9pt">   </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Création des documents Classeurs par défaut</span><span style="font-size:9pt"> :<br />    Créez dans le répertoire : '</span><span style="font-style:italic;font-size:9pt;font-weight:600">Ressources/Documents par defaut' </span><span style="font-size:9pt">de </span><span style="font-size:9pt;font-weight:600">drtux </span><span style="font-size:9pt">les documents suivants que vous nommez :<br />                                        </span><span style="font-style:italic;font-size:9pt;color:#ff0000">/Ressources/Documents par defaut/Historique des nouveaux documents.html</span><span style="font-size:9pt"><br />                                        </span><span style="font-style:italic;font-size:9pt;color:#ff0000">/Ressources/Documents par defaut/Historique des ordonnances du codex .html</span><span style="font-size:9pt"><br /><br />          Le contenu de ces documents pourra être par exemple le suivant :<br /><br />..................... (début de l'exemple </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Historique des nouveaux documents.html</span><span style="font-size:9pt"> à la suite de cette ligne) ..............................<br /></span><span style="font-family:Sans;font-size:9pt">{{\<br />{{::Append_doc_in_classeur ()}}\<br />}}<br /></span><span style="font-family:Sans"><br /></span><span style="font-family:Sans;font-size:11pt"><br /><hr></span><span style="font-family:Sans;font-size:9pt;font-weight:600;text-decoration:underline">Classeur contenant l'historique du dossier médical de</span><span style="font-family:Sans;font-size:9pt"> : </span><span style="font-family:Sans;font-size:11pt"><br /></span><span style="font-family:Sans;font-size:8pt;font-weight:600;color:#aa0000">{{TITRE PATIENT}} {{NOM PRENOM PATIENT}}</span><span style="font-family:Sans;font-size:8pt"> </span><span style="font-family:Sans"><br /></span><span style="font-family:Sans;font-size:9pt;font-weight:600;text-decoration:underline">Date de création</span><span style="font-family:Sans;font-size:9pt"> : {{DT=dd-MM-yyyy}} </span><span style="font-family:Sans"><br /><br /><hr></span><span style="font-family:Sans;font-size:9pt">...................... (fin de l'exemple)..................................<br /><br /><br /></span><span style="font-size:9pt">..................... (début de l'exemple </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Historique des ordonnances du codex .html</span><span style="font-size:9pt"> à la suite de cette ligne) ..............................<br /></span><span style="font-family:Sans;font-size:9pt">{{\<br />{{::Append_doc_in_classeur ()}}\<br />}}<br /></span><span style="font-family:Sans"><br /></span><span style="font-family:Sans;font-size:11pt"><br /><hr></span><span style="font-family:Sans;font-size:9pt;font-weight:600;text-decoration:underline">Classeur contenant l'historique des ordonnances élaborées avec le codex Vidal Datasemp pour</span><span style="font-family:Sans;font-size:9pt"> : </span><span style="font-family:Sans;font-size:11pt"><br /></span><span style="font-family:Sans;font-size:8pt;font-weight:600;color:#aa0000">{{TITRE PATIENT}} {{NOM PRENOM PATIENT}}</span><span style="font-family:Sans;font-size:8pt"> </span><span style="font-family:Sans"><br /></span><span style="font-family:Sans;font-size:9pt;font-weight:600;text-decoration:underline">Date de création</span><span style="font-family:Sans;font-size:9pt"> : {{DT=dd-MM-yyyy}} </span><span style="font-family:Sans"><br /><br /><hr></span><span style="font-family:Sans;font-size:9pt">...................... (fin de l'exemple)..................................<br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;text-decoration:underline">ce qui est important dans ces documents sont les macros</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-family:Sans;font-size:9pt">{{\<br />{{::Append_doc_in_classeur ()}}\<br />}}</span><span style="font-family:Sans"><br /></span><span style="font-size:9pt"><br />qui permettent de faire en sorte que les classeurs : </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Historique des nouveaux documents </span><span style="font-size:9pt">et</span><span style="font-size:9pt;color:#ff0000"> </span><span style="font-style:italic;font-size:9pt;color:#ff0000">Historique des ordonnances du codex</span><span style="font-size:9pt;color:#ff0000"> </span><span style="font-size:9pt">soient créés automatiquement.<br /></span><span style="font-family:Sans;font-size:9pt"><br /></span><span style="font-size:9pt"><br /></span><span style="font-size:9pt;font-weight:600">5.3.2.2</span><span style="font-size:9pt">   </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Création des paramètres des fichiers Manager.ini et drtux.ini</span><span style="font-size:9pt">  :<br /><br />Rajoutez dans la section </span><span style="font-size:9pt;font-weight:600">[Vigie] </span><span style="font-size:9pt">de vos fichiers </span><span style="font-size:9pt;font-weight:600">Manager.ini</span><span style="font-size:9pt"> et </span><span style="font-size:9pt;font-weight:600">drtux.ini</span><span style="font-size:9pt"> les lignes suivantes :<br /><br />                      </span><span style="font-size:9pt;font-weight:600">Classement par defaut = Historique des nouveaux documents<br />                Classement Ordonnances par defaut = Historique des ordonnances du codex </span><span style="font-size:9pt"><br /><br />pour indiquer le nom des fichiers définissant les répertoires de destination par défaut.<br /></span><hr></p>
<p><span style="font-size:9pt"><br /><a name="6__Définir_et_créer_des_rubriques_supplémentaires"></a></span><span style="font-size:12pt;font-weight:600">6  <a name="Définir_et_créer_des_rubriques_supplémentaires"></a></span><span style="font-size:12pt;font-weight:600;text-decoration:underline">Définir et créer des rubriques supplémentaires</span><span style="font-size:9pt"><br /><br />Si vous êtes trop à l'étroit avec les rubriques habituelles, Observation, Prescription, Terrain, Classeurs etc. proposées par défaut, il vous est possible d'en rajouter autant que vous le désirez.<br /><br /></span><span style="font-size:9pt;font-weight:600">6.1</span><span style="font-size:9pt">  </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Création de la rubrique</span><span style="font-size:9pt">  :<br />Nous allons, dans l'exemple suivant, rajouter une rubrique : </span><span style="font-size:9pt;font-weight:600">Imagerie</span><span style="font-size:9pt"> dans laquelle nous placerons toute l'imagerie du patient.<br />Pour cela, activez l'assistant de configuration de DrTux, en cliquant sur l'option </span><span style="font-size:9pt;font-weight:600">Préférences</span><span style="font-size:9pt"> du Menu </span><span style="font-size:9pt;font-weight:600">Fichier</span><span style="font-size:9pt"> :<br /><br /></span><img src=DrTuxNewRubrique_AccesMenu.png ><span style="font-size:9pt"><br /><br />cela affiche le dialogue des </span><span style="font-size:9pt;font-weight:600">Préférences</span><span style="font-size:9pt"> dans lequel il vous faut sélectionner l'icône </span><span style="font-size:9pt;font-weight:600">Rubriques</span><span style="font-size:9pt"> de façon à avoir le gestionnaire de rubriques comme ci-dessous, que vous renseignerez avec les indications données ci-dessous, puis validerez en cliquant sur le bouton '</span><span style="font-size:9pt;font-weight:600">Sauvegarder les Modifications</span><span style="font-size:9pt">'.<br /><br /></span><img src=DrTuxNewRubrique_Assistant_00.png ><span style="font-size:9pt"><br /><br />puis cliquez sur le bouton '</span><span style="font-size:9pt;font-weight:600">Ajouter une rubrique</span><span style="font-size:9pt">' , il vous sera demandé le nom de la rubrique,<br /><br /></span><img src=DrTuxNewRubrique_defname.png ><span style="font-size:9pt"><br /><br />saisissez-le et confirmez. Vous obtenez alors une nouvelle rubrique dans la liste des rubriques.<br />Par la suite, il vous sera possible de modifier le nom en double cliquant sur </span><span style="font-size:9pt;font-weight:600">7-Nom de la rubrique</span><span style="font-size:9pt">. <br />Les autres paramètres de la rubrique se modifient aussi en cliquant sur une des lignes numérotées 1 à 7.<br /><br /></span><img src=DrTuxNewRubrique_Assistant_afterNew.png ><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">6.1</span><span style="font-size:9pt">  </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramétrage de l'Identificateur de de type de rubrique</span><span style="font-size:9pt">  :<br /><br />Cliquez sur la ligne '</span><span style="font-size:9pt;font-weight:600">4- Identificateur de de type de rubrique</span><span style="font-size:9pt">' pour définir l'identificateur de de type de rubrique, et saisissez le nombre </span><span style="font-size:9pt;font-weight:600">90040000</span><span style="font-size:9pt"> .<br />Désormais, tous les documents créés avec la rubrique </span><span style="font-size:9pt;font-weight:600">Imagerie </span><span style="font-size:9pt">le seront avec cet identificateur qui doit être unique car c'est en quelque sorte la signature du document de la rubrique, MedinTux s'en sert pour orienter l'affichage des documents dans la rubrique qui lui est affectée.<br />Cliquez sur la ligne '</span><span style="font-size:9pt;font-weight:600">2- Document par défaut lors première création</span><span style="font-size:9pt">' p<br /><br /></span><img src=DrTuxNewRubrique_Assistant_typeRub.png ><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;font-weight:600">6.2</span><span style="font-size:9pt">  </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Paramétrage du préfixe du droit</span><span style="font-size:9pt">  :<br /><br />Pour toute rubrique il existe un droit déterminant les modalités d'accès des utilisateurs à cette rubrique. <br /></span><span style="font-size:9pt;font-weight:600">Le préfixe du droit</span><span style="font-size:9pt"> d'une rubrique est une chaîne de </span><span style="font-size:9pt;font-weight:600">deux caractères</span><span style="font-size:9pt"> définissant le préfixe du droit affecté à cette rubrique.</span></p>
<p><span style="font-size:9pt">Ce préfixe associé aux lettres suivantes c,v,p détermine les droits suivants :</span></p>
<ul type="disc"><li><span style="font-size:9pt">'</span><span style="font-size:9pt;font-weight:600">c</span><span style="font-size:9pt">' détermine et forme le droit '</span><span style="font-size:9pt;font-weight:600">peut créer ou modifier la rubrique</span><span style="font-size:9pt">'.</span> </li>
<li><span style="font-size:9pt">'</span><span style="font-size:9pt;font-weight:600">v</span><span style="font-size:9pt">' détermine et forme le droit '</span><span style="font-size:9pt;font-weight:600">peut voir la rubrique</span><span style="font-size:9pt">'.</span> </li>
<li><span style="font-size:9pt">'</span><span style="font-size:9pt;font-weight:600">p</span><span style="font-size:9pt">' détermine et ' détermine et forme le droit '</span><span style="font-size:9pt;font-weight:600">peut imprimer la rubrique</span><span style="font-size:9pt">'.</span></li></ul>
<p><span style="font-size:9pt">Modifier le préfixe du droit d'une rubrique peut entraîner des comportements inadaptés et rendre certains documents non visibles ou non modifiables par les utilisateurs ne possédant pas le droit correspondant à ce préfixe.</span></p>
<p><span style="font-size:9pt">Cela est réversible si le préfixe du droit correspond de nouveau à un droit possédé par cet utilisateur.</span></p>
<p><span style="font-size:9pt">Cliquez sur la ligne '</span><span style="font-size:9pt;font-weight:600">5- Préfixe du droit</span><span style="font-size:9pt">' et saisissez par exemple '</span><span style="font-size:9pt;font-weight:600">im</span><span style="font-size:9pt">' (les deux premières lettres de imagerie)<br />puis validez.<br /><br /></span><img src=DrTuxNewRubrique_Assistant_PrefixRub.png ><br /><span style="font-size:9pt"><br /><br />Les autres paramètres de la rubrique se modifient aussi en cliquant sur une des lignes numérotées 1 à 7.<br />Après définition d'une nouvelle rubrique ou modification des paramètres des autres rubriques n'oubliez pas de valider en cliquant sur le bouton '</span><span style="font-size:9pt;font-weight:600">Sauvegarder les Modifications</span><span style="font-size:9pt">'.<br /></span><span style="font-size:8pt"><br /></span><span style="font-size:9pt;font-weight:600">6.3</span><span style="font-size:9pt">  </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Document par défaut lors de la première création d'une rubrique</span><span style="font-size:9pt">  :<br /><br />Pour toute rubrique il est possible et conseillé de définir un document par défaut se mettant en place lors de la première création d'un dossier patient.<br />Par exemple, pour la rubrique '</span><span style="font-size:9pt;font-weight:600">Observation</span><span style="font-size:9pt">' il est utile de définir une maquette et formulaire par défaut à remplir lors du premier accès au dossier patient.<br />Pour cela, cliquez sur la ligne '</span><span style="font-size:9pt;font-weight:600">2- Document par défaut lors première création</span><span style="font-size:9pt">' et à l'aide du sélecteur de fichiers, sélectionnez le document à placer comme document ou formulaire par défaut à installer lors du premier accès au patient.<br /><br /></span><span style="font-size:9pt;font-weight:600">6.3.1</span><span style="font-size:9pt"> </span><span style="font-size:9pt;font-weight:600;text-decoration:underline">Le paramètre de ce document par défaut est indiqué dans les fichiers suivants</span><span style="font-size:9pt"> : <br />(que vous pouvez éditer avec n'importe quel éditeur de texte ascii).<br /><br />'</span><span style="font-size:9pt;font-weight:600">MedinTux/Programmes/Manager.ini</span><span style="font-size:9pt">'<br />'</span><span style="font-size:9pt;font-weight:600">MedinTux/Programmes/drtux.ini</span><span style="font-size:9pt">'<br /><br />section : </span><span style="font-size:9pt;font-weight:600">[NOM DE LA RUBRIQUE] </span><span style="font-size:9pt"><br />entree : </span><span style="font-size:9pt;font-weight:600">Defaut</span><span style="font-size:9pt"> = </span><span style="font-size:9pt;font-weight:600">chemin du document par défaut</span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;text-decoration:underline">Exemple pour la rubrique Identification</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600">[Identification] <br />     Defaut = $Glossaire/Identification/Fiche Administrative.html</span><span style="font-size:9pt"><br /><br /></span><span style="font-size:9pt;text-decoration:underline">exemple pour la rubrique Observation</span><span style="font-size:9pt"> :<br /><br /></span><span style="font-size:9pt;font-weight:600">[Observation] <br />     Defaut = $Glossaire/Observation/OBSERV_STANDARD.htm</span><span style="font-size:9pt">l<br /><br /></span><span style="font-size:9pt;font-weight:600;text-decoration:underline">6.3.2 Mentions particulières</span><span style="font-size:9pt"> :</span></p>
<ul type="disc"><div><img src=n_ball.gif ><span style="font-size:9pt">Vous remarquerez que la mention </span><span style="font-size:9pt;font-weight:600">$Glossaire</span><span style="font-size:9pt"> sera remplacée par le chemin réel du Glossaire en cours d'utilisation. Cette facilité permet de d'indiquer un document relatif au Glossaire en cours, quel que soit sa localisation.<br /><br /></span><img src=n_ball.gif ><span style="font-size:9pt">Si vous faites précéder le chemin par le signe </span><span style="font-size:9pt;font-weight:600">*</span><span style="font-size:9pt">, cela déactivera le document par défaut. C'est utile, par exemple, pour les rubriques (exemple 'Prescription' ) où il n'est pas utile de créer un document lors du premier accès.<br /><br /></span><span style="font-size:9pt;font-weight:600">[Prescription]<br />Defaut = *</span><span style="font-size:9pt"><br /><br /></span><img src=n_ball.gif ><span style="font-size:9pt">De même, si vous placez le signe deux points (mode bavard) en début de chemin, un menu surgissant signalera l'éventuelle erreur de chargement du document.</span></div></ul>
</body></html>
